/*! For license information please see gltf-model-plus.min.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("THREE"));else if("function"==typeof define&&define.amd)define(["THREE"],t);else{var i="object"==typeof exports?t(require("THREE")):t(e.THREE);for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}(self,(e=>(()=>{var t={30:()=>{AFRAME.registerComponent("billboard",{schema:{onlyY:{type:"boolean",default:!0}},init(){this.targetPos=new THREE.Vector3,this.worldPos=new THREE.Vector3},tick(){const e=this.el.object3D;if(!e.visible)return;const t=this.el.sceneEl.systems.camera.activeCameraEl.object3D;this.targetPos.setFromMatrixPosition(t.matrixWorld),this.data.onlyY&&(e.getWorldPosition(this.worldPos),this.targetPos.y=this.worldPos.y),e.lookAt(this.targetPos)}})},238:()=>{AFRAME.registerComponent("open-link",{schema:{on:{type:"string",default:"click"},href:{type:"string",default:""}},init(){this.move=this.move.bind(this)},play(){this.el.addEventListener(this.data.on,this.move)},pause(){this.el.removeEventListener(this.data.on,this.move)},move(){if(this.data.href.startsWith("#")){const e=document.querySelector(this.data.href);e?e.emit("click"):console.warn(`No waypoint found with the id ${this.data.href}`)}else this.el.sceneEl.is("vr-mode")&&this.el.sceneEl.exitVR(),window.open(this.data.href)}})},527:()=>{AFRAME.registerComponent("reflection-probe",{schema:{size:{default:1},envMapTexture:{type:"map"}},init:function(){this.el.object3D.updateWorldMatrix(!0,!1);const e=(new THREE.Box3).setFromCenterAndSize(new THREE.Vector3,(new THREE.Vector3).setScalar(2*this.data.size)).applyMatrix4(this.el.object3D.matrixWorld);this.el.setObject3D("probe",new THREE.ReflectionProbe(e,this.data.envMapTexture))}})},114:()=>{const e=new Map,t=[];AFRAME.registerSystem("uv-scroll",{tick(i,n){for(let i=0;i<t.length;i++){const s=t[i],{offset:r,instances:o}=e.get(s),{component:a}=o[0];r.addScaledVector(a.data.speed,n/1e3),r.x=r.x%1,r.y=r.y%1;const l=a.data.increment;s.offset.x=l.x?r.x-r.x%l.x:r.x,s.offset.y=l.y?r.y-r.y%l.y:r.y}}}),AFRAME.registerComponent("uv-scroll",{schema:{speed:{type:"vec2",default:{x:0,y:0}},increment:{type:"vec2",default:{x:0,y:0}}},play(){const i=this.el.getObject3D("mesh")||this.el.getObject3D("skinnedmesh"),n=i&&i.material;if(n){const s={component:this,mesh:i};this.instance=s,this.map=n.map||n.emissiveMap,this.map&&!e.has(this.map)?(e.set(this.map,{offset:new THREE.Vector2,instances:[s]}),t.push(this.map)):this.map?(console.warn("Multiple uv-scroll instances added to objects sharing a texture, only the speed/increment from the first one will have any effect"),e.get(this.map).instances.push(s)):this.el.components.material?this.el.addEventListener("materialtextureloaded",(()=>{this.map=n.map||n.emissiveMap,e.has(this.map)||(e.set(this.map,{offset:new THREE.Vector2,instances:[s]}),t.push(this.map))})):console.warn("Ignoring uv-scroll added to mesh with no scrollable texture.")}},pause(){if(this.map){const i=e.get(this.map).instances;i.splice(i.indexOf(this.instance),1),i.length||(e.delete(this.map),t.splice(t.indexOf(this.map),1))}}})},612:t=>{"use strict";t.exports=e}},i={};function n(e){var s=i[e];if(void 0!==s)return s.exports;var r=i[e]={exports:{}};return t[e](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var s=i.length-1;s>-1&&(!e||!/^http(s?):/.test(e));)e=i[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})();var s={};return(()=>{"use strict";n.r(s);var e={};n.r(e),n.d(e,{backIn:()=>Q,backInOut:()=>ee,backOut:()=>J,bounceIn:()=>te,bounceInOut:()=>ne,bounceOut:()=>ie,circularIn:()=>Y,circularInOut:()=>G,circularOut:()=>$,cubicIn:()=>D,cubicInOut:()=>H,cubicOut:()=>L,elasticIn:()=>X,elasticInOut:()=>K,elasticOut:()=>Z,exponentialIn:()=>q,exponentialInOut:()=>W,exponentialOut:()=>B,linear:()=>R,quadraticIn:()=>F,quadraticInOut:()=>O,quadraticOut:()=>A,quarticIn:()=>P,quarticInOut:()=>j,quarticOut:()=>k,quinticIn:()=>z,quinticInOut:()=>_,quinticOut:()=>U,sinusoidalIn:()=>I,sinusoidalInOut:()=>V,sinusoidalOut:()=>N}),n(30);var t=n(612);class i extends t.DataTextureLoader{constructor(e){super(e),this.type=t.HalfFloatType}parse(e){const i=function(e,t){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(t||""))}},n=function(e,t,i){t=t||1024;let n=e.pos,s=-1,r=0,o="",a=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));for(;0>(s=a.indexOf("\n"))&&r<t&&n<e.byteLength;)o+=a,r+=a.length,n+=128,a+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));return-1<s&&(!1!==i&&(e.pos+=r+s+1),o+a.slice(0,s))},s=function(e,t,i,n){const s=e[t+3],r=Math.pow(2,s-128)/255;i[n+0]=e[t+0]*r,i[n+1]=e[t+1]*r,i[n+2]=e[t+2]*r,i[n+3]=1},r=function(e,i,n,s){const r=e[i+3],o=Math.pow(2,r-128)/255;n[s+0]=t.DataUtils.toHalfFloat(Math.min(e[i+0]*o,65504)),n[s+1]=t.DataUtils.toHalfFloat(Math.min(e[i+1]*o,65504)),n[s+2]=t.DataUtils.toHalfFloat(Math.min(e[i+2]*o,65504)),n[s+3]=t.DataUtils.toHalfFloat(1)},o=new Uint8Array(e);o.pos=0;const a=function(e){const t=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,r=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,a={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;for((e.pos>=e.byteLength||!(l=n(e)))&&i(1,"no header found"),(c=l.match(/^#\?(\S+)/))||i(3,"bad initial token"),a.valid|=1,a.programtype=c[1],a.string+=l+"\n";l=n(e),!1!==l;)if(a.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(t))&&(a.gamma=parseFloat(c[1])),(c=l.match(s))&&(a.exposure=parseFloat(c[1])),(c=l.match(r))&&(a.valid|=2,a.format=c[1]),(c=l.match(o))&&(a.valid|=4,a.height=parseInt(c[1],10),a.width=parseInt(c[2],10)),2&a.valid&&4&a.valid)break}else a.comments+=l+"\n";return 2&a.valid||i(3,"missing format specifier"),4&a.valid||i(3,"missing image size specifier"),a}(o),l=a.width,c=a.height,p=function(e,t,n){const s=t;if(s<8||s>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);s!==(e[2]<<8|e[3])&&i(3,"wrong scanline width");const r=new Uint8Array(4*t*n);r.length||i(4,"unable to allocate buffer space");let o=0,a=0;const l=4*s,c=new Uint8Array(4),p=new Uint8Array(l);let d=n;for(;d>0&&a<e.byteLength;){a+4>e.byteLength&&i(1),c[0]=e[a++],c[1]=e[a++],c[2]=e[a++],c[3]=e[a++],2==c[0]&&2==c[1]&&(c[2]<<8|c[3])==s||i(3,"bad rgbe scanline format");let t,n=0;for(;n<l&&a<e.byteLength;){t=e[a++];const s=t>128;if(s&&(t-=128),(0===t||n+t>l)&&i(3,"bad scanline data"),s){const i=e[a++];for(let e=0;e<t;e++)p[n++]=i}else p.set(e.subarray(a,a+t),n),n+=t,a+=t}const h=s;for(let e=0;e<h;e++){let t=0;r[o]=p[e+t],t+=s,r[o+1]=p[e+t],t+=s,r[o+2]=p[e+t],t+=s,r[o+3]=p[e+t],o+=4}d--}return r}(o.subarray(o.pos),l,c);let d,h,u;switch(this.type){case t.FloatType:u=p.length/4;const e=new Float32Array(4*u);for(let t=0;t<u;t++)s(p,4*t,e,4*t);d=e,h=t.FloatType;break;case t.HalfFloatType:u=p.length/4;const i=new Uint16Array(4*u);for(let e=0;e<u;e++)r(p,4*e,i,4*e);d=i,h=t.HalfFloatType;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:l,height:c,data:d,header:a.string,gamma:a.gamma,exposure:a.exposure,type:h}}setDataType(e){return this.type=e,this}load(e,i,n,s){return super.load(e,(function(e,n){switch(e.type){case t.FloatType:case t.HalfFloatType:e.colorSpace=t.LinearSRGBColorSpace,e.minFilter=t.LinearFilter,e.magFilter=t.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}i&&i(e,n)}),n,s)}}class r{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const i=this._listeners[e];if(void 0!==i){const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){const i=t.slice(0);for(let t=0,n=i.length;t<n;t++)i[t].call(this,e)}}}const o={},a={},l={removeChild:()=>{}};class c extends r{constructor(e){super(),this.components={},this.initializingComponents={},this.object3D=e,this.sceneEl=e.el.sceneEl,this.object3D.el=this,this.isEntity=!0,this.isPlaying=!0,this.object3DMap={},this.rotationObj={},this.states=[],this.parentElement=this.sceneEl,this.parentNode=l,this.hasLoaded=!0,this.mixinEls=[],this.tagName="FAKE_ENTITY",this.isFakeEntity=!0}get children(){throw Error("FakeEntity el.children not implemented, try another way, maybe el.object3D.children")}addState(e){this.is(e)||(this.states.push(e),this.emit("stateadded",e))}removeState(e){const t=this.states.indexOf(e);-1!==t&&(this.states.splice(t,1),this.emit("stateremoved",e))}is(e){return-1!==this.states.indexOf(e)}getAttribute(e){if("position"===e)return this.object3D.position;if("rotation"===e)return function(e){const t=THREE.MathUtils.radToDeg,i=e.object3D.rotation,n=e.rotationObj;return n.x=t(i.x),n.y=t(i.y),n.z=t(i.z),n}(this);if("scale"===e)return this.object3D.scale;if("visible"===e)return this.object3D.visible;if("class"===e||"mixin"===e)return console.warn(`FakeEntity el.getAttribute('${e}') called`,this.object3D),"";const t=this.components[e];if(t)return t.data;throw Error(`FakeEntity el.getAttribute('${e}') not implemented`)}getDOMAttribute(e){return console.warn(`FakeEntity el.getDOMAttribute('${e}') called`,this.object3D),""}flushToDOM(){}removeAttribute(){throw Error("FakeEntity el.removeAttribute not implemented")}setAttribute(e,t,i){if(e.indexOf("__")>-1)throw Error(`FakeEntity setAttribute("${e}", ...) using multiple components of the same type is not supported`);if(!AFRAME.components[e]){if("id"===e)return void(this.id=t);throw Error(`FakeEntity setAttribute("${e}", ...) not supported, this is not a registered component`)}let n,s;if(void 0!==i&&"string"==typeof t&&t.length>0&&"string"==typeof AFRAME.utils.styleParser.parse(t)){for(const e in a)delete a[e];n=a,n[t]=i,s=!1}else n=t,s=!0===i;this.updateComponent(e,n,s)}updateComponent(e,t,i){const n=this.components[e];if(n)return null===t?void this.removeComponent(e,!0):void n.updateProperties(t,i);this.initComponent(e,t,!1)}initComponent(e,t,i){p(this.object3D,e,t)}removeComponent(e,t){const i=this.components[e];i&&(i.initialized?(i.pause(),i.remove(),t&&(i.destroy(),delete this.components[e]),this.emit("componentremoved",i.evtDetail,!1)):this.addEventListener("componentinitialized",(function i(n){n.detail.name===e&&(this.removeComponent(e,t),this.removeEventListener("componentinitialized",i))})))}getObject3D(e){return this.object3DMap[e]}setObject3D(e,t){const i=this.getObject3D(e);i&&this.object3D.remove(i),t.el=this;const n=this;t.children.length&&t.traverse((function(e){e.el=n})),t!==this.object3D&&this.object3D.add(t),this.object3DMap[e]=t,this.emit("object3dset",{object:t,type:e})}removeObject3D(e){const t=this.getObject3D(e);t?(this.object3D.remove(t),delete this.object3DMap[e],this.emit("object3dremove",{type:e})):console.warn("Tried to remove `Object3D` of type:",e,"which was not defined.")}emit(e,t,i,n){void 0===i&&(i=!0);let s=o;s.bubbles=!!i,s.detail=t,n&&(s=AFRAME.utils.extend({},n,s)),s.target=this,this.dispatchEvent(new CustomEvent(e,s)),s.target=null}destroy(){for(const e in this.components)this.removeComponent(e,!0);this.object3D.el=null,this.object3D=null,this.sceneEl=null,this.parentElement=null,this.parentNode=null}}const p=(e,t,i)=>{if(!AFRAME.components[t])return void console.error(`Component ${t} not registered`);e.fakeEl||(e.fakeEl=new c(e));const n=new AFRAME.components[t].Component(e.fakeEl,i,void 0);return n.play(),n},d=(e,t=void 0)=>{const i=e.el.sceneEl,n=document.createElement("a-entity");return t&&n.classList.add(t),i.appendChild(n),n.object3D.removeFromParent(),n.object3D=e,n.object3D.el=n,i.object3D.attach(e),n},h=window.absoluteURLForAsset||(e=>e);class u extends t.Loader{constructor(e){super(e),this.type=t.UnsignedByteType}setType(e){if(e!==t.UnsignedByteType&&e!==t.FloatType)throw new Error("LUTCubeLoader: Unsupported type");return this.type=e,this}load(e,i,n,s){const r=new t.FileLoader(this.manager);r.setPath(this.path),r.setResponseType("text"),r.load(e,(t=>{try{i(this.parse(t))}catch(t){s?s(t):console.error(t),this.manager.itemError(e)}}),n,s)}parse(e){const i=/^([\d.e+-]+) +([\d.e+-]+) +([\d.e+-]+) *$/gm;let n=/TITLE +"([^"]*)"/.exec(e);const s=null!==n?n[1]:null;if(n=/LUT_3D_SIZE +(\d+)/.exec(e),null===n)throw new Error("LUTCubeLoader: Missing LUT_3D_SIZE information");const r=Number(n[1]),o=r**3*4,a=this.type===t.UnsignedByteType?new Uint8Array(o):new Float32Array(o),l=new t.Vector3(0,0,0),c=new t.Vector3(1,1,1);if(n=/DOMAIN_MIN +([\d.]+) +([\d.]+) +([\d.]+)/.exec(e),null!==n&&l.set(Number(n[1]),Number(n[2]),Number(n[3])),n=/DOMAIN_MAX +([\d.]+) +([\d.]+) +([\d.]+)/.exec(e),null!==n&&c.set(Number(n[1]),Number(n[2]),Number(n[3])),l.x>c.x||l.y>c.y||l.z>c.z)throw new Error("LUTCubeLoader: Invalid input domain");const p=this.type===t.UnsignedByteType?255:1;let d=0;for(;null!==(n=i.exec(e));)a[d++]=Number(n[1])*p,a[d++]=Number(n[2])*p,a[d++]=Number(n[3])*p,a[d++]=p;const h=new t.DataTexture;h.image.data=a,h.image.width=r,h.image.height=r*r,h.type=this.type,h.magFilter=t.LinearFilter,h.minFilter=t.LinearFilter,h.wrapS=t.ClampToEdgeWrapping,h.wrapT=t.ClampToEdgeWrapping,h.generateMipmaps=!1,h.needsUpdate=!0;const u=new t.Data3DTexture;return u.image.data=a,u.image.width=r,u.image.height=r,u.image.depth=r,u.type=this.type,u.magFilter=t.LinearFilter,u.minFilter=t.LinearFilter,u.wrapS=t.ClampToEdgeWrapping,u.wrapT=t.ClampToEdgeWrapping,u.wrapR=t.ClampToEdgeWrapping,u.generateMipmaps=!1,u.needsUpdate=!0,{title:s,size:r,domainMin:l,domainMax:c,texture:h,texture3D:u}}}const m=n.p+"assets/e6acb8ca8505336d09c6.cube",f={toneMapping:THREE.LUTToneMapping?"LUTToneMapping":"NoToneMapping",toneMappingExposure:1,backgroundColor:"skyblue",backgroundTexture:null,envMapTexture:null};let g;const y=e=>{e.traverse((e=>{e.material&&(e.material.needsUpdate=!0)}))};function v(e,t,i){const n=i?.networked?.id??e.id??"";t.canBeOccupied&&e.setAttribute("networked",{template:"#waypoint-template",attachTemplateToLocal:!1,networkId:n,persistent:!0,owner:"scene"}),e.setAttribute("waypoint",t)}const b=new Map;b.set("audio",(function(e,t,i){const n=void 0!==i["audio-params"],s=i["audio-params"]||t,r={autoplay:t.autoPlay,distanceModel:s.distanceModel,loop:t.loop,maxDistance:s.maxDistance,positional:"stereo"!==s.audioType,refDistance:s.refDistance,rolloffFactor:s.rolloffFactor,src:h(t.src),volume:n?s.gain:3*s.volume};p(e,"sound",r)})),b.set("audio-params",(function(e,t,i){})),b.set("billboard",(function(e,t,i){p(e,"billboard",t)})),b.set("environment-settings",(function(e,t){const i=e.object3D,n=e.renderer;let s=!1,r=THREE[t.toneMapping];void 0===r&&(console.warn("You need an aframe build with the tonemappingLUT patch to make LUTToneMapping work. Falling back to NoToneMapping"),r=THREE.NoToneMapping),n.toneMapping!==r&&(n.toneMapping=r,r===THREE.LUTToneMapping?(g||(g=new Promise((function(e,t){(new u).load(m,(({texture3D:t})=>e(t)),null,t)}))),g.then((e=>{n.tonemappingLUT=e,y(i)})).catch((function(e){console.error("Error loading Blender LUT",e),g=null}))):(n.tonemappingLUT=null,s=!0)),n.toneMappingExposure=t.toneMappingExposure,t.backgroundTexture?(t.backgroundTexture.mapping=THREE.EquirectangularReflectionMapping,t.backgroundTexture.flipY=!0,i.background=t.backgroundTexture):i.background=new THREE.Color(t.backgroundColor),t.envMapTexture?(t.envMapTexture.flipY=!0,t.envMapTexture.mapping=THREE.EquirectangularReflectionMapping,i.environment=t.envMapTexture):i.environment=null,s&&y(i)})),b.set("link",(function(e,t,i){const n=e.el.sceneEl;let s=e;for(;!s.isMesh;)s=e.parent;const r=document.createElement("a-entity");return n.appendChild(r),r.setObject3D("mesh",s),r.classList.add(s.name),r.classList.add("clickable"),r.setAttribute("open-link",t),r})),b.set("media-frame",(function(e,t,i){const n=d(e);return n.classList.add("mediaframe"),n.classList.add(e.name),n.setAttribute("networked",{template:"#media-template",attachTemplateToLocal:!1,networkId:i.networked.id,persistent:!0,owner:"scene"}),n.setAttribute("video-texture-target",{}),n.setAttribute("media-frame",t),n})),b.set("nav-mesh",(function(e,t,i){const n=e.el.sceneEl,s=document.createElement("a-entity");s.classList.add("navmesh"),s.setAttribute("nav-mesh",""),n.appendChild(s),s.setObject3D("mesh",e);const r=document.querySelector("#rig,#cameraRig");return r&&(r.removeAttribute("simple-navmesh-constraint"),r.setAttribute("simple-navmesh-constraint","navmesh:.navmesh;fall:0.5;height:0;exclude:.navmesh-hole;")),s})),b.set("particle-emitter",(function(e,t,i){t.src=h(t.src),p(e,"particle-emitter",t)})),b.set("reflection-probe",(function(e,t,i){void 0!==THREE.ReflectionProbe?(t.envMapTexture.flipY=!0,t.envMapTexture.mapping=THREE.EquirectangularReflectionMapping,p(e,"reflection-probe",t)):console.error("You need an aframe build with the ReflectionProbe patch to make reflection probes work.")})),b.set("spawn-point",(function(e,t,i){const n=d(e);return n.setAttribute("waypoint",{canBeSpawnPoint:!0}),n})),b.set("simple-water",(function(e,t,i){const n=e.el.sceneEl,s=document.createElement("a-entity");return s.classList.add(e.name),s.setAttribute("simple-water",t),s.object3D.position.copy(e.position),s.object3D.quaternion.copy(e.quaternion),s.object3D.scale.copy(e.scale),n.appendChild(s),e.isMesh&&(e.geometry.dispose(),e.material.dispose()),e.removeFromParent(),s})),b.set("text",(function(e,t,i){const n="troika-text";if(!AFRAME.components[n])return void console.error(`Component ${n} not registered`);const s=d(e);switch(s.classList.add(e.name),t.anchorY){case"middle":t.anchorY="center";break;case"bottom":case"bottom-baseline":t.anchorY="bottom";break;case"top":case"top-baseline":t.anchorY="top"}const r={align:t.textAlign,anchor:t.anchorX,baseline:t.anchorY,...t};delete r.textAlign,delete r.anchorX,delete r.anchorY,delete r.anchorY,delete r.opacity,delete r.side,s.setAttribute("troika-text",r);let o="";return 1!==t.opacity&&(o="opacity: "+t.opacity+"; transparent: true;"),s.setAttribute("troika-text-material","side: "+t.side+"; "+o),s})),b.set("uv-scroll",(function(e,t,i){e.fakeEl=new c(e),e.fakeEl.setObject3D("mesh",e),p(e,"uv-scroll",t)})),b.set("waypoint",(function(e,t,i){const n=d(e);return n.id=e.name,v(n,t,i),n})),(new Map).set("waypoint",v);const w=/\.hdr$/;AFRAME.registerComponent("environment-settings",{schema:{toneMapping:{type:"string",default:"LUTToneMapping",oneOf:["NoToneMapping","LinearToneMapping","ReinhardToneMapping","CineonToneMapping","ACESFilmicToneMapping","CustomToneMapping","LUTToneMapping"]},toneMappingExposure:{type:"number",default:1},backgroundTexture:{type:"string",default:""},backgroundColor:{type:"color",default:"skyblue"},envMapTexture:{type:"string",default:""}},init(){(async()=>{let e=null;if(this.data.backgroundTexture){const t=h(this.data.backgroundTexture),n=w.test(t);let s;s=n?(new i).setDataType(THREE.HalfFloatType):new THREE.TextureLoader,s.setWithCredentials(!1),e=await new Promise(((e,i)=>s.load(t,e,void 0,i))),e.minFilter===THREE.NearestMipmapNearestFilter||e.minFilter===THREE.NearestMipmapLinearFilter?e.minFilter=THREE.NearestFilter:e.minFilter!==THREE.LinearMipmapNearestFilter&&e.minFilter!==THREE.LinearMipmapLinearFilter||(e.minFilter=THREE.LinearFilter),n||(e.encoding=THREE.sRGBEncoding)}let t=null;if(this.data.envMapTexture){const e=h(this.data.envMapTexture),n=w.test(e);let s;s=n?(new i).setDataType(THREE.HalfFloatType):new THREE.TextureLoader,s.setWithCredentials(!1),t=await new Promise(((t,i)=>s.load(e,t,void 0,i))),t.minFilter===THREE.NearestMipmapNearestFilter||t.minFilter===THREE.NearestMipmapLinearFilter?t.minFilter=THREE.NearestFilter:t.minFilter!==THREE.LinearMipmapNearestFilter&&t.minFilter!==THREE.LinearMipmapLinearFilter||(t.minFilter=THREE.LinearFilter),n||(t.encoding=THREE.sRGBEncoding)}const n={toneMapping:this.data.toneMapping,toneMappingExposure:this.data.toneMappingExposure,backgroundTexture:e,backgroundColor:this.data.backgroundColor,envMapTexture:t};b.get("environment-settings")(this.el.sceneEl,n)})()}}),n(238);class E{constructor(e,t){this.parser=e,this.loader=t,this.name="MOZ_texture_rgbe"}loadTexture(e){const t=this.parser,i=t.json.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const n=i.extensions[this.name].source;return t.loadTextureImage(e,n,this.loader).then((e=>(e.minFilter===THREE.NearestMipmapNearestFilter||e.minFilter===THREE.NearestMipmapLinearFilter?e.minFilter=THREE.NearestFilter:e.minFilter!==THREE.LinearMipmapNearestFilter&&e.minFilter!==THREE.LinearMipmapLinearFilter||(e.minFilter=THREE.LinearFilter),e))).catch((e=>{console.error("issue while loading hdr texture",e)}))}}class x{constructor(e){this.parser=e,this.name="MOZ_hubs_components"}afterRoot({scenes:e,parser:t}){const i=[],n=(e,n)=>{const s=t.associations.get(n)?.[e];if(void 0===s)return;const r=t.json[e][s].extensions?.[this.name];if(r){n.userData.gltfExtensions=Object.assign(n.userData.gltfExtensions||{},{MOZ_hubs_components:r});for(const e in r){const n=r[e];for(const e in n){const s=n[e],r=s?.__mhc_link_type;r&&void 0!==s.index&&i.push(t.getDependency(r,s.index).then((i=>{if("node"!==r)return"texture"!==r||t.json.textures[s.index].extensions?.MOZ_texture_rgbe||(i.encoding=THREE.sRGBEncoding),n[e]=i,i})))}}}};for(let i=0;i<e.length;i++)t.associations.set(e[i],{scenes:i}),e[i].traverse((e=>{var t,i;n("scenes",e),n("nodes",e),t=e,i=n.bind(this,"materials"),!t.material||(Array.isArray(t.material)?t.material.map(i):i(t.material))}));return Promise.all(i)}}class M{constructor(e){this.parser=e,this.name="MOZ_lightmap"}loadMaterial(e){const t=this.parser,i=t.json.materials[e];if(!i.extensions||!i.extensions[this.name])return null;const n=i.extensions[this.name],s=[];return s.push(t.loadMaterial(e)),s.push(t.getDependency("texture",n.index)),Promise.all(s).then((e=>{const t=e[0],i=e[1];return i.channel=1,t.lightMap=i,t.lightMapIntensity=void 0!==n.intensity?n.intensity:1,t.isMeshBasicMaterial&&(t.lightMapIntensity*=Math.PI),t})).catch((e=>{console.error("issue while loading MOZ_lightmap material",e)}))}}function T(e){for(const t in e){const i=e[t];if(i instanceof THREE.Texture){const e=i.source.data;e instanceof ImageBitmap&&e.close&&e.close(),i.dispose()}}}function S(e){if(e.fakeEl&&e.fakeEl.destroy(),e instanceof THREE.Mesh){const t=e.geometry;t&&t.dispose();const i=e.material;if(i)if(Array.isArray(i))for(let e=0,t=i.length;e<t;e++){const t=i[e];T(t),t.dispose()}else T(i),i.dispose()}}const C={schema:{type:"model"},init:function(){const e=this,t=this.el.sceneEl.systems["gltf-model"].getDRACOLoader(),n=this.el.sceneEl.systems["gltf-model"].getMeshoptDecoder(),s=this.el.sceneEl.systems["gltf-model"].getKTX2Loader();this.model=null,this.removers=[],this.loader=new THREE.GLTFLoader,this.mixer=null,this.loader.register((e=>new x(e))).register((e=>new M(e))).register((e=>new E(e,(new i).setDataType(THREE.HalfFloatType)))),t&&this.loader.setDRACOLoader(t),this.ready=n?n.then((function(t){e.loader.setMeshoptDecoder(t)})):Promise.resolve(),s&&this.loader.setKTX2Loader(s)},update:function(){const e=this,t=this.el,i=this.data;this.remove(),i&&(t.sceneEl.systems.waypoint&&(t.sceneEl.systems.waypoint.glbLoading+=1,console.log("[wp] increment glbLoading",t.sceneEl.systems.waypoint.glbLoading)),this.ready.then((function(){e.el.emit("model-loading",{src:i}),e.loader.load(i,(function(n){t.emit("model-downloaded"),e.model=n.scene||n.scenes[0],e.model.animations=n.animations,t.setObject3D("mesh",e.model);const s=n.animations,r=[];let o=null;n.scene.traverse((t=>{if(t.isMesh&&(t.reflectionProbeMode="static"),t.userData.gltfExtensions&&t.userData.gltfExtensions.MOZ_hubs_components){const a=t.userData.gltfExtensions.MOZ_hubs_components,l=i.startsWith("data:")?"data:application/octet-stream;base64,...":i;console.log(l,a,t.name),Object.entries(a).forEach((([i,l])=>{if("environment-settings"===i)o=l;else if("visible"===i)t.visible=l.visible;else if("networked"===i);else if("loop-animation"===i){e.mixer||(e.mixer=new THREE.AnimationMixer(n.scene),e.tick=function(t,i){e.mixer&&!isNaN(i)&&e.mixer.update(i/1e3)},e.el.sceneEl.addBehavior(e));const i=l.activeClipIndices;let r=[];if(i&&i.length>0)r=i.map((e=>s[e]));else{const e=l.clip;if(""!==e){const t=e.split(",");for(let e=0;e<t.length;e++){const i=t[e],n=s.find((({name:e})=>e===i));n?(n.componentProps=l,r.push(n)):console.warn(`Could not find animation named '${i}'`)}}}for(const i of r){const n=e.mixer.clipAction(i,t);n.enabled=!0,void 0!==i.componentProps?.timeScale&&1!==i.componentProps?.timeScale&&(n.timeScale=i.componentProps.timeScale),void 0!==i.componentProps?.startOffset&&0!==i.componentProps?.startOffset&&(n.time=i.componentProps.startOffset),n.setLoop(THREE.LoopRepeat,1/0).play()}}else{const n=b.get(i);n?r.push((()=>{const s=n(t,l,a);s&&e.removers.push((()=>{if(s.object3D.traverse(S),s.parentNode&&s.parentNode.removeChild(s),"nav-mesh"===i){const e=document.querySelector("#rig,#cameraRig");e?.removeAttribute("simple-navmesh-constraint")}}))})):console.warn(`Unknown Hubs component '${i}'`)}}))}})),t.sceneEl.systems.waypoint&&(t.sceneEl.systems.waypoint.glbLoading-=1,console.log("[wp] decrement glbLoading",t.sceneEl.systems.waypoint.glbLoading),t.sceneEl.systems.waypoint.scheduleEmitWaypointsReady());for(let e=0;e<r.length;e++)r[e]();r.length=0,o||(o=f),t.emit("model-loaded",{format:"gltf",model:e.model,environmentSettings:o}),t.classList?.contains("environment-settings")&&(b.get("environment-settings")(t.sceneEl,o),THREE.Cache.clear()),setTimeout((()=>{t.sceneEl.renderer.shadowMap.needsUpdate=!0}),2e3)}),(function(e){t.emit("progress",{originalEvent:e})}),(function(e){t.emit("model-downloaded"),console.error(e,i);const n=e&&e.message?e.message:"Failed to load glTF model";console.warn(n),t.emit("model-error",{format:"gltf",src:i})}))})))},remove:function(){if(this.model){this.mixer&&(this.mixer.stopAllAction(),this.mixer=null,this.el.sceneEl.removeBehavior(this),this.tick=void 0);for(let e=0;e<this.removers.length;e++)this.removers[e]();this.removers.length=0,this.el.removeObject3D("mesh"),this.model.traverse(S),this.model=null}}};function R(e){return e}function F(e){return e*e}function A(e){return e*(2-e)}function O(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}function D(e){return e*e*e}function L(e){return--e*e*e+1}function H(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}function P(e){return e*e*e*e}function k(e){return 1- --e*e*e*e}function j(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}function z(e){return e*e*e*e*e}function U(e){return--e*e*e*e*e+1}function _(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}function I(e){return 1-Math.cos(e*Math.PI/2)}function N(e){return Math.sin(e*Math.PI/2)}function V(e){return.5*(1-Math.cos(Math.PI*e))}function q(e){return 0===e?0:Math.pow(1024,e-1)}function B(e){return 1===e?1:1-Math.pow(2,-10*e)}function W(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}function Y(e){return 1-Math.sqrt(1-e*e)}function $(e){return Math.sqrt(1- --e*e)}function G(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}function X(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)}function Z(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1}function K(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}function Q(e){const t=1.70158;return e*e*((t+1)*e-t)}function J(e){const t=1.70158;return--e*e*((t+1)*e+t)+1}function ee(e){const t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}function te(e){return 1-ie(1-e)}function ie(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function ne(e){return e<.5?.5*te(2*e):.5*ie(2*e-1)+.5}function se(e,t,i){return(t-e)*i+e}function re(e){const t=e.getAttribute("uv");for(let e=0;e<t.count;e++)t.setY(e,1-t.getY(e));return e}AFRAME.registerComponent("gltf-model-plus",C);class oe extends t.Mesh{constructor(e){const i=new t.PlaneBufferGeometry(1,1,1,1);e&&!e.flipY&&re(i);const n=new t.InstancedBufferGeometry;n.index=i.index,n.attributes=i.attributes,super(n,new t.ShaderMaterial({uniforms:t.UniformsUtils.merge([{map:{value:e},emitterMatrix:{value:new t.Matrix4}},t.UniformsLib.fog]),vertexShader:"\n  #include <common>\n\n  attribute vec4 particlePosition;\n  attribute vec4 particleColor;\n  attribute float particleAngle;\n\n  varying vec4 vColor;\n  varying vec2 vUV;\n\n  uniform mat4 emitterMatrix;\n\n  #include <fog_pars_vertex>\n\n  void main() {\n    vUV = uv;\n    vColor = particleColor;\n\n    float particleScale = particlePosition.w;\n    vec4 mvPosition = viewMatrix * emitterMatrix * vec4(particlePosition.xyz, 1.0);\n    \n    vec3 rotatedPosition = position;\n    rotatedPosition.x = cos( particleAngle ) * position.x - sin( particleAngle ) * position.y;\n    rotatedPosition.y = sin( particleAngle ) * position.x + cos( particleAngle ) * position.y;\n\n    mvPosition.xyz += rotatedPosition * particleScale;\n\n    gl_Position = projectionMatrix * mvPosition;\n\n    #include <fog_vertex>\n  }\n",fragmentShader:"\n  #include <common>\n  #include <fog_pars_fragment>\n\n  uniform sampler2D map;\n\n  varying vec2 vUV;\n  varying vec4 vColor;\n\n  void main() {\n    gl_FragColor = texture2D(map,  vUV) * vColor;\n    #include <fog_fragment>\n  }\n",transparent:!0,depthWrite:!1,fog:!0,blendEquation:t.AddEquation})),this.frustumCulled=!1,this.initialPositions=[],this.startSize=.25,this.endSize=.25,this.sizeRandomness=0,this.startVelocity=new t.Vector3(0,0,.5),this.endVelocity=new t.Vector3(0,0,.5),this.angularVelocity=0,this.particleCount=100,this.lifetime=5,this.lifetimes=[],this.lifetimeRandomness=5,this.particleSizeRandomness=[],this.ageRandomness=10,this.initialAges=[],this.ages=[],this.colors=[],this.endColor=new t.Color,this.middleColor=new t.Color,this.startColor=new t.Color,this.startOpacity=1,this.middleOpacity=1,this.endOpacity=1,this.colorCurve="linear",this.velocityCurve="linear",this.sizeCurve="linear",this.worldScale=new t.Vector3,this.inverseWorldScale=new t.Vector3,this.updateParticles()}updateParticles(){const e=this.material.uniforms.map.value,i=new t.PlaneBufferGeometry(1,1,1,1);e&&!e.flipY&&re(i);const n=new t.InstancedBufferGeometry;n.index=i.index,n.attributes=i.attributes;const s=[],r=[],o=[],a=[],l=[],c=[],p=[],d=[];this.getWorldScale(this.worldScale);for(let e=0;e<this.particleCount;e++)l[e]=Math.random()*this.ageRandomness-this.ageRandomness,o[e]=this.lifetime+2*Math.random()*this.lifetimeRandomness,a[e]=l[e],c[3*e]=2*Math.random()-1,c[3*e+1]=2*Math.random()-1,c[3*e+2]=0,p[e]=Math.random()*this.sizeRandomness,s.push(c[3*e]*this.worldScale.x),s.push(c[3*e+1]*this.worldScale.y),s.push(c[3*e+2]),s.push(this.startSize+p[e]),d.push(0),r.push(this.startColor.r,this.startColor.g,this.startColor.b,0);n.setAttribute("particlePosition",new t.InstancedBufferAttribute(new Float32Array(s),4).setUsage(t.DynamicDrawUsage)),n.setAttribute("particleColor",new t.InstancedBufferAttribute(new Float32Array(r),4).setUsage(t.DynamicDrawUsage)),n.setAttribute("particleAngle",new t.InstancedBufferAttribute(new Float32Array(d),1).setUsage(t.DynamicDrawUsage)),this.geometry=n,this.initialPositions=c,this.particleSizeRandomness=p,this.ages=a,this.initialAges=l,this.lifetimes=o,this.colors=r}update(i){const n=this.geometry,s=n.attributes.particlePosition.array,r=n.attributes.particleColor.array,o=n.attributes.particleAngle.array;this.getWorldScale(this.worldScale),this.inverseWorldScale.set(1/this.worldScale.x,1/this.worldScale.y,1/this.worldScale.z);const a=this.material.uniforms.emitterMatrix.value;a.copy(this.matrixWorld),a.scale(this.inverseWorldScale);for(let n=0;n<this.particleCount;n++){const a=this.ages[n],c=this.ages[n]+=i;if(c<0)continue;if(c>0&&a<=0){r[4*n+3]=this.startOpacity,s[4*n]=this.initialPositions[3*n]*this.worldScale.x,s[4*n+1]=this.initialPositions[3*n+1]*this.worldScale.y,s[4*n+2]=0,s[4*n+3]=this.startSize+this.particleSizeRandomness[n],r[4*n]=this.startColor.r,r[4*n+1]=this.startColor.g,r[4*n+2]=this.startColor.b;continue}if(c>this.lifetimes[n]){this.ages[n]=this.initialAges[n],r[4*n+3]=0;continue}const p=(0,1,(l=this.ages[n]/this.lifetimes[n])<0&&(l=0),l>1&&(l=1),l),d=e;d[this.velocityCurve]||(console.warn(`Unknown velocity curve type ${this.velocityCurve} in particle emitter. Falling back to linear.`),this.velocityCurve="linear"),d[this.sizeCurve]||(console.warn(`Unknown size curve type ${this.sizeCurve} in particle emitter. Falling back to linear.`),this.sizeCurve="linear"),d[this.colorCurve]||(console.warn(`Unknown color curve type ${this.colorCurve} in particle emitter. Falling back to linear.`),this.colorCurve="linear");const h=d[this.velocityCurve](p),u=d[this.sizeCurve](p),m=d[this.colorCurve](p);if(s[4*n]+=se(this.startVelocity.x,this.endVelocity.x,h)*i,s[4*n+1]+=se(this.startVelocity.y,this.endVelocity.y,h)*i,s[4*n+2]+=se(this.startVelocity.z,this.endVelocity.z,h)*i,s[4*n+3]=se(this.startSize+this.particleSizeRandomness[n],this.endSize+this.particleSizeRandomness[n],u),o[n]+=this.angularVelocity*t.MathUtils.DEG2RAD*i,m<=.5){const e=m/.5;r[4*n]=se(this.startColor.r,this.middleColor.r,e),r[4*n+1]=se(this.startColor.g,this.middleColor.g,e),r[4*n+2]=se(this.startColor.b,this.middleColor.b,e),r[4*n+3]=se(this.startOpacity,this.middleOpacity,e)}else if(m>.5){const e=(m-.5)/.5;r[4*n]=se(this.middleColor.r,this.endColor.r,e),r[4*n+1]=se(this.middleColor.g,this.endColor.g,e),r[4*n+2]=se(this.middleColor.b,this.endColor.b,e),r[4*n+3]=se(this.middleOpacity,this.endOpacity,e)}}var l;n.attributes.particlePosition.needsUpdate=!0,n.attributes.particleColor.needsUpdate=!0,n.attributes.particleAngle.needsUpdate=!0}copy(e,t=!0){super.copy(e,t);const i=this.material,n=e.material;return i.uniforms.map.value=n.uniforms.map.value,this.startColor.copy(e.startColor),this.middleColor.copy(e.middleColor),this.endColor.copy(e.endColor),this.startOpacity=e.startOpacity,this.middleOpacity=e.middleOpacity,this.endOpacity=e.endOpacity,this.colorCurve=e.colorCurve,this.sizeCurve=e.sizeCurve,this.startSize=e.startSize,this.endSize=e.endSize,this.sizeRandomness=e.sizeRandomness,this.ageRandomness=e.ageRandomness,this.lifetime=e.lifetime,this.lifetimeRandomness=e.lifetimeRandomness,this.particleCount=e.particleCount,this.startVelocity.copy(e.startVelocity),this.endVelocity.copy(e.endVelocity),this.velocityCurve=e.velocityCurve,this.angularVelocity=e.angularVelocity,this}}AFRAME.registerComponent("particle-emitter",{schema:{src:{type:"string",default:""},startColor:{type:"color",default:"#ffffff"},middleColor:{type:"color",default:"#ffffff"},endColor:{type:"color",default:"#ffffff"},startOpacity:{type:"number",default:1},middleOpacity:{type:"number",default:1},endOpacity:{type:"number",default:1},colorCurve:{type:"string",default:"linear"},sizeCurve:{type:"string",default:"linear"},startSize:{type:"number",default:.25},endSize:{type:"number",default:.25},sizeRandomness:{type:"number",default:0},ageRandomness:{type:"number",default:10},lifetime:{type:"number",default:5},lifetimeRandomness:{type:"number",default:10},particleCount:{type:"number",default:100},startVelocity:{type:"vec3",default:{x:0,y:0,z:.5}},endVelocity:{type:"vec3",default:{x:0,y:0,z:.5}},velocityCurve:{type:"string",default:"linear"},angularVelocity:{type:"number",default:0}},init(){this.particleEmitter=new oe(null),this.particleEmitter.visible=!1,this.el.setObject3D("particle-emitter",this.particleEmitter),this.updateParticles=!1},remove(){S(this.particleEmitter)},async setTexture(e){const i=(new t.TextureLoader).setCrossOrigin("anonymous"),n=await i.loadAsync(e);this.data.src===e&&(this.particleEmitter.material.uniforms.map.value=n,this.particleEmitter.visible=!0,this.updateParticles=!0)},update(e){const t=this.data,i=this.particleEmitter;e.src!==t.src&&this.setTexture(t.src).catch(console.error),e.startColor===t.startColor&&e.startSize===t.startSize&&e.sizeRandomness===t.sizeRandomness&&e.ageRandomness===t.ageRandomness&&e.lifetime===t.lifetime&&e.lifetimeRandomness===t.lifetimeRandomness&&e.particleCount===t.particleCount||(this.updateParticles=!0),i.startColor.set(t.startColor),i.middleColor.set(t.middleColor),i.endColor.set(t.endColor),i.startOpacity=t.startOpacity,i.middleOpacity=t.middleOpacity,i.endOpacity=t.endOpacity,i.colorCurve=t.colorCurve,i.sizeCurve=t.sizeCurve,i.startSize=t.startSize,i.endSize=t.endSize,i.sizeRandomness=t.sizeRandomness,i.ageRandomness=t.ageRandomness,i.lifetime=t.lifetime,i.lifetimeRandomness=t.lifetimeRandomness,i.particleCount=t.particleCount,i.startVelocity.copy(t.startVelocity),i.endVelocity.copy(t.endVelocity),i.velocityCurve=t.velocityCurve,i.angularVelocity=t.angularVelocity},tick(e,t){this.updateParticles&&(this.particleEmitter.updateParticles(),this.updateParticles=!1),this.particleEmitter.visible&&this.particleEmitter.update(t/1e3)}}),n(527);class ae{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let e=0;e<512;e++)this.perm[e]=this.p[255&e];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,i){return e[0]*t+e[1]*i}dot3(e,t,i,n){return e[0]*t+e[1]*i+e[2]*n}dot4(e,t,i,n,s){return e[0]*t+e[1]*i+e[2]*n+e[3]*s}noise(e,t){let i,n,s;const r=(e+t)*(.5*(Math.sqrt(3)-1)),o=Math.floor(e+r),a=Math.floor(t+r),l=(3-Math.sqrt(3))/6,c=(o+a)*l,p=e-(o-c),d=t-(a-c);let h,u;p>d?(h=1,u=0):(h=0,u=1);const m=p-h+l,f=d-u+l,g=p-1+2*l,y=d-1+2*l,v=255&o,b=255&a,w=this.perm[v+this.perm[b]]%12,E=this.perm[v+h+this.perm[b+u]]%12,x=this.perm[v+1+this.perm[b+1]]%12;let M=.5-p*p-d*d;M<0?i=0:(M*=M,i=M*M*this.dot(this.grad3[w],p,d));let T=.5-m*m-f*f;T<0?n=0:(T*=T,n=T*T*this.dot(this.grad3[E],m,f));let S=.5-g*g-y*y;return S<0?s=0:(S*=S,s=S*S*this.dot(this.grad3[x],g,y)),70*(i+n+s)}noise3d(e,t,i){let n,s,r,o;const a=(e+t+i)*(1/3),l=Math.floor(e+a),c=Math.floor(t+a),p=Math.floor(i+a),d=1/6,h=(l+c+p)*d,u=e-(l-h),m=t-(c-h),f=i-(p-h);let g,y,v,b,w,E;u>=m?m>=f?(g=1,y=0,v=0,b=1,w=1,E=0):u>=f?(g=1,y=0,v=0,b=1,w=0,E=1):(g=0,y=0,v=1,b=1,w=0,E=1):m<f?(g=0,y=0,v=1,b=0,w=1,E=1):u<f?(g=0,y=1,v=0,b=0,w=1,E=1):(g=0,y=1,v=0,b=1,w=1,E=0);const x=u-g+d,M=m-y+d,T=f-v+d,S=u-b+2*d,C=m-w+2*d,R=f-E+2*d,F=u-1+.5,A=m-1+.5,O=f-1+.5,D=255&l,L=255&c,H=255&p,P=this.perm[D+this.perm[L+this.perm[H]]]%12,k=this.perm[D+g+this.perm[L+y+this.perm[H+v]]]%12,j=this.perm[D+b+this.perm[L+w+this.perm[H+E]]]%12,z=this.perm[D+1+this.perm[L+1+this.perm[H+1]]]%12;let U=.6-u*u-m*m-f*f;U<0?n=0:(U*=U,n=U*U*this.dot3(this.grad3[P],u,m,f));let _=.6-x*x-M*M-T*T;_<0?s=0:(_*=_,s=_*_*this.dot3(this.grad3[k],x,M,T));let I=.6-S*S-C*C-R*R;I<0?r=0:(I*=I,r=I*I*this.dot3(this.grad3[j],S,C,R));let N=.6-F*F-A*A-O*O;return N<0?o=0:(N*=N,o=N*N*this.dot3(this.grad3[z],F,A,O)),32*(n+s+r+o)}noise4d(e,t,i,n){const s=this.grad4,r=this.simplex,o=this.perm,a=(Math.sqrt(5)-1)/4,l=(5-Math.sqrt(5))/20;let c,p,d,h,u;const m=(e+t+i+n)*a,f=Math.floor(e+m),g=Math.floor(t+m),y=Math.floor(i+m),v=Math.floor(n+m),b=(f+g+y+v)*l,w=e-(f-b),E=t-(g-b),x=i-(y-b),M=n-(v-b),T=(w>E?32:0)+(w>x?16:0)+(E>x?8:0)+(w>M?4:0)+(E>M?2:0)+(x>M?1:0),S=r[T][0]>=3?1:0,C=r[T][1]>=3?1:0,R=r[T][2]>=3?1:0,F=r[T][3]>=3?1:0,A=r[T][0]>=2?1:0,O=r[T][1]>=2?1:0,D=r[T][2]>=2?1:0,L=r[T][3]>=2?1:0,H=r[T][0]>=1?1:0,P=r[T][1]>=1?1:0,k=r[T][2]>=1?1:0,j=r[T][3]>=1?1:0,z=w-S+l,U=E-C+l,_=x-R+l,I=M-F+l,N=w-A+2*l,V=E-O+2*l,q=x-D+2*l,B=M-L+2*l,W=w-H+3*l,Y=E-P+3*l,$=x-k+3*l,G=M-j+3*l,X=w-1+4*l,Z=E-1+4*l,K=x-1+4*l,Q=M-1+4*l,J=255&f,ee=255&g,te=255&y,ie=255&v,ne=o[J+o[ee+o[te+o[ie]]]]%32,se=o[J+S+o[ee+C+o[te+R+o[ie+F]]]]%32,re=o[J+A+o[ee+O+o[te+D+o[ie+L]]]]%32,oe=o[J+H+o[ee+P+o[te+k+o[ie+j]]]]%32,ae=o[J+1+o[ee+1+o[te+1+o[ie+1]]]]%32;let le=.6-w*w-E*E-x*x-M*M;le<0?c=0:(le*=le,c=le*le*this.dot4(s[ne],w,E,x,M));let ce=.6-z*z-U*U-_*_-I*I;ce<0?p=0:(ce*=ce,p=ce*ce*this.dot4(s[se],z,U,_,I));let pe=.6-N*N-V*V-q*q-B*B;pe<0?d=0:(pe*=pe,d=pe*pe*this.dot4(s[re],N,V,q,B));let de=.6-W*W-Y*Y-$*$-G*G;de<0?h=0:(de*=de,h=de*de*this.dot4(s[oe],W,Y,$,G));let he=.6-X*X-Z*Z-K*K-Q*Q;return he<0?u=0:(he*=he,u=he*he*this.dot4(s[ae],X,Z,K,Q)),27*(c+p+d+h+u)}}const le=n.p+"assets/537ec85b965d414829ab.jpg";class ce{constructor(e=new t.Vector2(1,1),i=new t.Vector2(1,1),n=.0025,s=!0){this.speed=e,this.scale=i,this.height=n,this.alternate=s}}class pe extends t.Mesh{constructor(e,i=24,n=!1){const s=new t.PlaneGeometry(10,10,i,i);s.rotateX(-Math.PI/2);const r={ripplesSpeed:{value:.25},ripplesScale:{value:1},time:{value:0}},o=n?t.MeshPhongMaterial:t.MeshStandardMaterial;e.wrapS=e.wrapT=t.RepeatWrapping;const a=new o({color:21727,normalMap:e,roughness:.5,metalness:.5});a.name="SimpleWaterMaterial",a.onBeforeCompile=e=>{Object.assign(e.uniforms,r),e.vertexShader=e.vertexShader.replace("#include <fog_pars_vertex>","\n        #include <fog_pars_vertex>\n        varying vec3 vWPosition;\n      "),e.vertexShader=e.vertexShader.replace("#include <fog_vertex>","\n        #include <fog_vertex>\n        vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;\n      "),e.fragmentShader=e.fragmentShader.replace("#include <normalmap_pars_fragment>","\n        #include <normalmap_pars_fragment>\n\n        uniform float time;\n        uniform float ripplesSpeed;\n        uniform float ripplesScale;\n      \n        varying vec3 vWPosition;\n      \n        vec4 getNoise(vec2 uv){\n          float timeOffset = time * ripplesSpeed;\n          uv = (uv - 0.5) * (1.0 / ripplesScale);\n          vec2 uv0 = (uv/103.0)+vec2(timeOffset/17.0, timeOffset/29.0);\n          vec2 uv1 = uv/107.0-vec2(timeOffset/-19.0, timeOffset/31.0);\n          vec2 uv2 = uv/vec2(897.0, 983.0)+vec2(timeOffset/101.0, timeOffset/97.0);\n          vec2 uv3 = uv/vec2(991.0, 877.0)-vec2(timeOffset/109.0, timeOffset/-113.0);\n          vec4 noise = (texture2D(normalMap, uv0)) +\n                       (texture2D(normalMap, uv1)) +\n                       (texture2D(normalMap, uv2)) +\n                       (texture2D(normalMap, uv3));\n          return noise / 4.0;\n        }\n      "),e.fragmentShader=e.fragmentShader.replace("#include <normal_fragment_maps>","\n          // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n          vec3 eye_pos = -vViewPosition;\n          vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n          vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n          vec2 st0 = dFdx( vUv.st );\n          vec2 st1 = dFdy( vUv.st );\n\n          float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n          vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n          vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n          vec3 N = normalize( normal );\n          mat3 tsn = mat3( S, T, N );\n\n          vec3 mapN = getNoise(vWPosition.xz).xyz * 2.0 - 1.0;\n\n          mapN.xy *= normalScale;\n          mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n          normal = normalize( tsn * mapN );\n        ")},super(s,a),this.lowQuality=n,this.waterUniforms=r,n?this.material.specular.set(16777215):this.receiveShadow=!0,this.geometry.attributes.position.dynamic=!0,this.resolution=i,this.octaves=[new ce(new t.Vector2(.5,.5),new t.Vector2(1,1),.01,!0),new ce(new t.Vector2(.05,6),new t.Vector2(1,20),.1,!1)],this.simplex=new ae}get opacity(){return this.material.opacity}set opacity(e){this.material.opacity=e,this.material.transparent=1!==e}get color(){return this.material.color}get tideHeight(){return this.octaves[0].height}set tideHeight(e){this.octaves[0].height=e}get tideScale(){return this.octaves[0].scale}get tideSpeed(){return this.octaves[0].speed}get waveHeight(){return this.octaves[1].height}set waveHeight(e){this.octaves[1].height=e}get waveScale(){return this.octaves[1].scale}get waveSpeed(){return this.octaves[1].speed}set ripplesSpeed(e){this.waterUniforms.ripplesSpeed.value=e}get ripplesSpeed(){return this.waterUniforms.ripplesSpeed.value}set ripplesScale(e){this.waterUniforms.ripplesScale.value=e}get ripplesScale(){return this.waterUniforms.ripplesScale.value}update(e){const t=this.geometry.attributes.position;for(let i=0;i<=this.resolution;i++)for(let n=0;n<=this.resolution;n++){let s=0;for(let t=0;t<this.octaves.length;t++){const r=this.octaves[t];if(r.alternate){const t=this.simplex.noise(i*r.scale.x/this.resolution,n*r.scale.y/this.resolution);s+=Math.cos(t+r.speed.length()*e)*r.height}else s+=(this.simplex.noise((i*r.scale.x+e*r.speed.x)/this.resolution,(n*r.scale.y+e*r.speed.y)/this.resolution)-.5)*r.height}t.setY(i*(this.resolution+1)+n,s)}this.geometry.computeVertexNormals(),t.needsUpdate=!0,this.waterUniforms.time.value=e}clone(e){return new pe(this.material.normalMap,this.resolution,this.lowQuality).copy(this,e)}copy(e,t=!0){return super.copy(e,t),this.opacity=e.opacity,this.color.copy(e.color),this.tideHeight=e.tideHeight,this.tideScale.copy(e.tideScale),this.tideSpeed.copy(e.tideSpeed),this.waveHeight=e.waveHeight,this.waveScale.copy(e.waveScale),this.waveSpeed.copy(e.waveSpeed),this.ripplesSpeed=e.ripplesSpeed,this.ripplesScale=e.ripplesScale,this}}function de(e,t){return e&&t&&e.x===t.x&&e.y===t.y}let he=null;AFRAME.registerComponent("simple-water",{schema:{opacity:{type:"number",default:1},color:{type:"color"},tideHeight:{type:"number",default:.01},tideScale:{type:"vec2",default:{x:1,y:1}},tideSpeed:{type:"vec2",default:{x:.5,y:.5}},waveHeight:{type:"number",default:.1},waveScale:{type:"vec2",default:{x:1,y:20}},waveSpeed:{type:"vec2",default:{x:.05,y:6}},ripplesScale:{type:"number",default:1},ripplesSpeed:{type:"number",default:.25}},init(){he||(he=(new t.TextureLoader).load(le)),this.water=new pe(he,void 0,!1),this.el.setObject3D("mesh",this.water)},update(e){this.data.opacity!==e.opacity&&(this.water.opacity=this.data.opacity),this.data.color!==e.color&&this.water.color.set(this.data.color),this.data.tideHeight!==e.tideHeight&&(this.water.tideHeight=this.data.tideHeight),de(this.data.tideScale,e.tideScale)||this.water.tideScale.copy(this.data.tideScale),de(this.data.tideSpeed,e.tideSpeed)||this.water.tideSpeed.copy(this.data.tideSpeed),this.data.waveHeight!==e.waveHeight&&(this.water.waveHeight=this.data.waveHeight),de(this.data.waveScale,e.waveScale)||this.water.waveScale.copy(this.data.waveScale),de(this.data.waveSpeed,e.waveSpeed)||this.water.waveSpeed.copy(this.data.waveSpeed),this.data.ripplesScale!==e.ripplesScale&&(this.water.ripplesScale=this.data.ripplesScale),this.data.ripplesSpeed!==e.ripplesSpeed&&(this.water.ripplesSpeed=this.data.ripplesSpeed)},tick(e){this.water.update(e/1e3)},remove(){const e=this.el.getObject3D("mesh");e.geometry.dispose(),e.material.dispose(),this.el.removeObject3D("mesh")}}),n(114)})(),s})()));
//# sourceMappingURL=gltf-model-plus.min.js.map