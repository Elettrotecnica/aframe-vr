{"version":3,"file":"gltf-model-plus.min.js","mappings":"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","sources":["webpack://@c-frame/aframe-gltf-model-plus/webpack/universalModuleDefinition","webpack://@c-frame/aframe-gltf-model-plus/./src/components/billboard.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/uv-scroll.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/waypoint.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/open-link.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/reflection-probe.js","webpack://@c-frame/aframe-gltf-model-plus/external umd \"THREE\"","webpack://@c-frame/aframe-gltf-model-plus/webpack/bootstrap","webpack://@c-frame/aframe-gltf-model-plus/webpack/runtime/define property getters","webpack://@c-frame/aframe-gltf-model-plus/webpack/runtime/global","webpack://@c-frame/aframe-gltf-model-plus/webpack/runtime/hasOwnProperty shorthand","webpack://@c-frame/aframe-gltf-model-plus/webpack/runtime/make namespace object","webpack://@c-frame/aframe-gltf-model-plus/webpack/runtime/publicPath","webpack://@c-frame/aframe-gltf-model-plus/webpack/runtime/jsonp chunk loading","webpack://@c-frame/aframe-gltf-model-plus/./node_modules/three/examples/jsm/loaders/RGBELoader.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/EventDispatcher.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/FakeEntity.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/utils.js","webpack://@c-frame/aframe-gltf-model-plus/./node_modules/three/examples/jsm/loaders/LUTCubeLoader.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/environment-settings.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/media-image.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/media-video.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/media.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/waypoint.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/index.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/audio.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/audio-params.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/billboard.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/link.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/media-frame.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/nav-mesh.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/particle-emitter.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/reflection-probe.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/spawn-point.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/simple-water.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/text.js","webpack://@c-frame/aframe-gltf-model-plus/./src/inflators/uv-scroll.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/environment-settings.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/gltf-model-plus.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/media-frame.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/media-image.js","webpack://@c-frame/aframe-gltf-model-plus/./node_modules/lib-hubs/packages/easing-functions/lib/esm/index.js","webpack://@c-frame/aframe-gltf-model-plus/./node_modules/lib-hubs/packages/three-particle-emitter/lib/esm/index.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/media-video.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/particle-emitter.js","webpack://@c-frame/aframe-gltf-model-plus/./node_modules/three/examples/jsm/math/SimplexNoise.js","webpack://@c-frame/aframe-gltf-model-plus/./src/components/simple-water.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"THREE\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"THREE\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"THREE\")) : factory(root[\"THREE\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, (__WEBPACK_EXTERNAL_MODULE__612__) => {\nreturn ","/* global AFRAME THREE */\nAFRAME.registerComponent(\"billboard\", {\n  schema: {\n    onlyY: { type: \"boolean\", default: true },\n  },\n  init() {\n    this.targetPos = new THREE.Vector3();\n    this.worldPos = new THREE.Vector3();\n  },\n  tick() {\n    const object3D = this.el.object3D;\n    if (!object3D.visible) {\n      return;\n    }\n\n    const camera = this.el.sceneEl.systems.camera.activeCameraEl.object3D;\n    // Set the camera world position as the target.\n    this.targetPos.setFromMatrixPosition(camera.matrixWorld);\n\n    if (this.data.onlyY) {\n      object3D.getWorldPosition(this.worldPos);\n      this.targetPos.y = this.worldPos.y;\n    }\n\n    object3D.lookAt(this.targetPos);\n  },\n});\n","/* global AFRAME, THREE */\n// This is a modified copy of\n// https://github.com/mozilla/hubs/blob/6c49ce303ad7e030c80b301dbc3ce100cac7d9c1/src/components/uv-scroll.js\n// to work with an aframe system and waiting for material to be loaded via the materialtextureloaded event.\n// @license MPL 2.0 https://github.com/mozilla/hubs/blob/master/LICENSE\n\nconst textureToData = new Map();\nconst registeredTextures = [];\n\nAFRAME.registerSystem(\"uv-scroll\", {\n  tick(t, dt) {\n    for (let i = 0; i < registeredTextures.length; i++) {\n      const map = registeredTextures[i];\n      const { offset, instances } = textureToData.get(map);\n      const { component } = instances[0];\n\n      offset.addScaledVector(component.data.speed, dt / 1000);\n\n      offset.x = offset.x % 1.0;\n      offset.y = offset.y % 1.0;\n\n      const increment = component.data.increment;\n      map.offset.x = increment.x ? offset.x - (offset.x % increment.x) : offset.x;\n      map.offset.y = increment.y ? offset.y - (offset.y % increment.y) : offset.y;\n    }\n  },\n});\n\n/**\n * Animate the UV offset of a mesh's material\n * @component uv-scroll\n */\nAFRAME.registerComponent(\"uv-scroll\", {\n  schema: {\n    speed: { type: \"vec2\", default: { x: 0, y: 0 } },\n    increment: { type: \"vec2\", default: { x: 0, y: 0 } },\n  },\n  play() {\n    const mesh = this.el.getObject3D(\"mesh\") || this.el.getObject3D(\"skinnedmesh\");\n    const material = mesh && mesh.material;\n    if (material) {\n      // We store mesh here instead of the material directly because we end up swapping out the material in injectCustomShaderChunks.\n      // We need material in the first place because of MobileStandardMaterial\n      const instance = { component: this, mesh };\n\n      this.instance = instance;\n      this.map = material.map || material.emissiveMap;\n\n      if (this.map && !textureToData.has(this.map)) {\n        textureToData.set(this.map, {\n          offset: new THREE.Vector2(),\n          instances: [instance],\n        });\n        registeredTextures.push(this.map);\n      } else if (!this.map) {\n        if (this.el.components.material) {\n          // when using material and uv-scroll components\n          this.el.addEventListener(\"materialtextureloaded\", () => {\n            this.map = material.map || material.emissiveMap;\n            if (!textureToData.has(this.map)) {\n              textureToData.set(this.map, {\n                offset: new THREE.Vector2(),\n                instances: [instance],\n              });\n              registeredTextures.push(this.map);\n            }\n          });\n        } else {\n          console.warn(\"Ignoring uv-scroll added to mesh with no scrollable texture.\");\n        }\n      } else {\n        console.warn(\n          \"Multiple uv-scroll instances added to objects sharing a texture, only the speed/increment from the first one will have any effect\"\n        );\n        textureToData.get(this.map).instances.push(instance);\n      }\n    }\n  },\n\n  pause() {\n    if (this.map) {\n      const instances = textureToData.get(this.map).instances;\n      instances.splice(instances.indexOf(this.instance), 1);\n      // If this was the last uv-scroll component for a given texture\n      if (!instances.length) {\n        textureToData.delete(this.map);\n        registeredTextures.splice(registeredTextures.indexOf(this.map), 1);\n      }\n    }\n  },\n});\n","/* global AFRAME, THREE, NAF */\n\nconst WITH_NAF = !!window.NAF;\n\nfunction addWaypointTemplate() {\n  const templateOuter = document.createElement(\"template\");\n  const templateInner = document.createElement(\"a-entity\");\n  templateOuter.id = `waypoint-template`;\n  templateOuter.appendChild(templateInner);\n  const refTemplateId = `#${templateOuter.id}`;\n  NAF.schemas.schemaDict[refTemplateId] = {\n    template: refTemplateId,\n    components: [\n      {\n        component: \"waypoint\",\n        property: \"isOccupied\",\n      },\n      {\n        component: \"waypoint\",\n        property: \"occupiedBy\",\n      },\n    ],\n  };\n  NAF.schemas.templateCache[refTemplateId] = templateOuter;\n}\n\nif (WITH_NAF) {\n  addWaypointTemplate();\n}\n\nfunction genClientId() {\n  return String(crypto.getRandomValues(new Uint32Array(1))[0]);\n}\n\nconst clientId = genClientId();\n\nfunction getClientId() {\n  // this.el.setAttribute(\"waypoint\", { isOccupied: true, occupiedBy: NAF.clientId });\n  // with NAF.clientId empty string didn't set empty string but kept \"scene\", we use here clientId that is not empty even if not connected\n  // so the unoccupyWaypoint function works correctly when not connected.\n  if (WITH_NAF) {\n    return NAF.clientId || clientId;\n  } else {\n    return clientId;\n  }\n}\n\nAFRAME.registerSystem(\"waypoint\", {\n  schema: {\n    hideWaypointsAfterClick: { type: \"boolean\", default: true },\n  },\n  init() {\n    this.occupyWaypoint = false;\n    this.showClickableWaypoints = false;\n    this.registeredWaypoints = [];\n    this.glbLoading = 0;\n    this.pendingEmitWaypointsReady = false;\n  },\n  scheduleEmitWaypointsReady() {\n    if (this.pendingEmitWaypointsReady) return;\n    this.pendingEmitWaypointsReady = true;\n    console.log(\"[wp] schedule emitting waypoints-ready in a microtask\");\n    setTimeout(() => {\n      if (this.glbLoading > 0) {\n        console.log(`[wp] ${this.glbLoading} glb still loading, cancel emitting waypoints-ready`);\n        this.pendingEmitWaypointsReady = false;\n        return;\n      }\n\n      console.log(\"[wp] emit waypoints-ready\");\n      setTimeout(() => {\n        this.el.emit(\"waypoints-ready\");\n      });\n      this.pendingEmitWaypointsReady = false;\n    });\n  },\n  toggleClickableWaypoints() {\n    this.showClickableWaypoints = !this.showClickableWaypoints;\n    for (const waypoint of this.registeredWaypoints) {\n      const waypointComponent = waypoint.components.waypoint;\n      if (waypointComponent.mesh) {\n        waypointComponent.mesh.material.visible = !waypointComponent.data.isOccupied && this.showClickableWaypoints;\n      }\n    }\n  },\n  teleportTo(position, rotation, withTransition = true) {\n    const quaternion = new THREE.Quaternion();\n    quaternion.setFromEuler(new THREE.Euler(0, THREE.MathUtils.degToRad(rotation.y), 0));\n    const cameraRig = document.querySelector(\"#rig,#cameraRig\");\n    const camera = cameraRig.querySelector(\"a-camera,[camera]\");\n    const cursorTeleport = cameraRig?.components[\"cursor-teleport\"];\n    withTransition = withTransition && !cameraRig.sceneEl.is(\"vr-mode\");\n    if (withTransition && cursorTeleport) {\n      cursorTeleport.teleportTo(position, quaternion);\n    } else {\n      const navMeshConstraint = document.querySelector(\"[simple-navmesh-constraint]\");\n      if (navMeshConstraint) {\n        navMeshConstraint.setAttribute(\"simple-navmesh-constraint\", { enabled: false });\n      }\n      const camForRotation = camera.object3D;\n      const destQuaternion = new THREE.Quaternion();\n      destQuaternion.setFromEuler(new THREE.Euler(0, camForRotation.rotation.y, 0));\n      destQuaternion.invert();\n      destQuaternion.multiply(quaternion);\n      cameraRig.object3D.position.copy(position);\n      cameraRig.object3D.quaternion.copy(destQuaternion);\n      if (navMeshConstraint) {\n        navMeshConstraint.setAttribute(\"simple-navmesh-constraint\", { enabled: true });\n      }\n    }\n\n    if (camera) {\n      camera.components[\"look-controls\"].pitchObject.rotation.x = THREE.MathUtils.DEG2RAD * rotation.x;\n    }\n  },\n  unoccupyWaypoint() {\n    const cameraRig = document.querySelector(\"#rig,#cameraRig\");\n    const camera = cameraRig.querySelector(\"a-camera,[camera]\");\n\n    for (const waypoint of this.registeredWaypoints) {\n      if (waypoint.components.waypoint.data.occupiedBy === getClientId()) {\n        waypoint.setAttribute(\"waypoint\", { isOccupied: false, occupiedBy: \"scene\" });\n        const waypointComponent = waypoint.components.waypoint;\n        if (waypointComponent.mesh) {\n          waypointComponent.mesh.material.visible = !waypointComponent.data.isOccupied && this.showClickableWaypoints;\n        }\n        // In case of reconnect, someone else may have the actual ownership\n        // of my seat, so be sure to take ownership.\n        if (WITH_NAF && waypoint.components.networked && NAF.connection.adapter) NAF.utils.takeOwnership(waypoint);\n      }\n    }\n\n    this.occupyWaypoint = false;\n    cameraRig.setAttribute(\"player-info\", \"avatarPose\", \"stand\");\n    camera.object3D.position.y = 1.6;\n  },\n});\n\nAFRAME.registerComponent(\"waypoint\", {\n  schema: {\n    canBeClicked: { type: \"bool\", default: false },\n    canBeOccupied: { type: \"bool\", default: false },\n    canBeSpawnPoint: { type: \"bool\", default: false },\n    snapToNavMesh: { type: \"bool\", default: false },\n    willDisableMotion: { type: \"bool\", default: false },\n    willDisableTeleporting: { type: \"bool\", default: false },\n    willMaintainInitialOrientation: { type: \"bool\", default: false },\n    isOccupied: { type: \"bool\", default: false },\n    occupiedBy: { type: \"string\", default: \"scene\" },\n  },\n  events: {\n    \"model-loaded\": function (evt) {\n      if (this.el.object3D.visible) {\n        this.el.classList.add(\"clickable\");\n      }\n      let rootNode = this.el.object3D.getObjectByName(\"RootNode\");\n      if (!rootNode.material && rootNode.children.length > 0) {\n        rootNode = rootNode.children[0];\n      }\n      if (rootNode && rootNode.material) {\n        this.mesh = rootNode;\n        if (!this.originalColor) {\n          this.originalColor = this.mesh.material.color.clone();\n        }\n        this.mesh.material.visible = !this.data.isOccupied && this.system.showClickableWaypoints;\n        this.mesh.material.side = THREE.FrontSide;\n      }\n    },\n    mouseenter: function (evt) {\n      if (this.mesh && !this.data.isOccupied) {\n        this.mesh.material.color.set(\"#0284c7\");\n        this.mesh.material.visible = true;\n      }\n    },\n    mouseleave: function (evt) {\n      if (this.mesh) {\n        this.mesh.material.color.set(this.originalColor);\n        this.mesh.material.visible = !this.data.isOccupied && this.system.showClickableWaypoints;\n      }\n    },\n    \"ownership-gained\": function (evt) {\n      // We can gain the ownership automatically when previous owner of the\n      // persistent entity disconnect. Every participant gains the ownership, so\n      // there is a race condition to set isOccupied:false here.\n      if (\n        WITH_NAF &&\n        !this.el.sceneEl.is(\"naf:reconnecting\") &&\n        this.data.isOccupied &&\n        NAF.connection.activeDataChannels[this.data.occupiedBy] === false\n      ) {\n        setTimeout(() => {\n          if (NAF.utils.isMine(this.el)) {\n            // reconnected user may have taken back ownership after the 2s so do nothing in this case\n            this.el.setAttribute(\"waypoint\", { isOccupied: false });\n            // don't set occupiedBy:scene, the disconnected user will have a chance to occupy it again\n          }\n        }, 2000);\n      }\n    },\n    click: function (evt) {\n      if (this.system.data.hideWaypointsAfterClick && this.system.showClickableWaypoints) {\n        this.system.toggleClickableWaypoints();\n      }\n      // const withTransition = evt.detail?.withTransition ?? true;\n      // Force withTransition=false for now, using cursorTeleport.teleportTo(position, quaternion) emits the navigation-start event\n      // that triggers unoccupyWaypoint because of the listener in player-info.\n      const withTransition = false;\n      this.system.unoccupyWaypoint();\n      const cameraRig = document.querySelector(\"#rig,#cameraRig\");\n      const camera = cameraRig.querySelector(\"a-camera,[camera]\");\n\n      // There is a check for occupyWaypoint in the player-info component for the moved event\n      // to call this.el.sceneEl.systems.waypoint.unoccupyWaypoint()\n      // We set isOccupied here even for waypoint canBeClicked && !canBeOccupied on purpose to not show the figure if we're on it\n      this.system.occupyWaypoint = true;\n      this.el.setAttribute(\"waypoint\", { isOccupied: true, occupiedBy: getClientId() });\n      if (WITH_NAF && this.el.components.networked && NAF.connection.adapter) NAF.utils.takeOwnership(this.el);\n\n      const spawnPoint = this.el;\n      const avatarPose = this.data.canBeOccupied && this.data.willDisableMotion ? \"sit\" : \"stand\";\n      cameraRig.setAttribute(\"player-info\", \"avatarPose\", avatarPose);\n\n      const position = new THREE.Vector3();\n      spawnPoint.object3D.getWorldPosition(position);\n      const playerInfo = cameraRig.components[\"player-info\"];\n      const avatarSitOffset = playerInfo && playerInfo.avatarSitOffset ? playerInfo.avatarSitOffset : 0.45;\n      if (avatarPose === \"sit\") {\n        position.y -= avatarSitOffset;\n        camera.object3D.position.y = 1.15;\n      }\n\n      const quaternion = new THREE.Quaternion();\n      spawnPoint.object3D.getWorldQuaternion(quaternion);\n      const euler = new THREE.Euler().setFromQuaternion(quaternion, \"YXZ\");\n      const rotation = { x: 0, y: euler.y * THREE.MathUtils.RAD2DEG + 180, z: 0 };\n      this.system.teleportTo(position, rotation, withTransition);\n      cameraRig.setAttribute(\"player-info\", { seatRotation: camera.object3D.rotation.y });\n    },\n  },\n  registerWaypoint() {\n    // be sure to not add it twice\n    const idx = this.system.registeredWaypoints.indexOf(this.el);\n    if (idx === -1) {\n      this.system.registeredWaypoints.push(this.el);\n      console.log(\"[wp] register waypoint\");\n      this.system.scheduleEmitWaypointsReady();\n    }\n  },\n  unregisterWaypoint() {\n    // it may already be removed, so be careful indexOf is not -1 otherwise it will remove the last item of the array\n    const idx = this.system.registeredWaypoints.indexOf(this.el);\n    if (idx > -1) {\n      this.system.registeredWaypoints.splice(idx, 1);\n    }\n  },\n  init() {\n    this.registerWaypoint();\n    if (this.data.canBeClicked) {\n      if (this.data.willDisableMotion) {\n        this.el.setAttribute(\"gltf-model\", new URL(\"../assets/models/waypoint_sit.glb\", import.meta.url).href);\n      } else {\n        this.el.setAttribute(\"gltf-model\", new URL(\"../assets/models/waypoint_stand.glb\", import.meta.url).href);\n      }\n    }\n    if (!this.data.canBeOccupied && this.el.hasAttribute(\"networked\")) {\n      // waypoint created from a-waypoint primitive\n      this.el.removeAttribute(\"networked\");\n    }\n  },\n  remove() {\n    this.unregisterWaypoint();\n  },\n  update(oldData) {\n    // this.data.isOccupied is false if some other participant set it to\n    // false in ownership-gained and sent me back the change when I'm reconnected\n    if (!this.data.isOccupied && this.data.occupiedBy === getClientId()) {\n      // take back my seat if I didn't choose another seat while I was reconnecting\n      const currentlyOnAnotherSeat = this.el.sceneEl.systems.waypoint.registeredWaypoints.find((waypoint) => {\n        return (\n          this.el !== waypoint &&\n          waypoint.components.networked &&\n          waypoint.components.waypoint.data.occupiedBy === getClientId()\n        );\n      });\n      if (currentlyOnAnotherSeat) {\n        this.el.setAttribute(\"waypoint\", { isOccupied: false, occupiedBy: \"scene\" });\n      } else {\n        this.el.setAttribute(\"waypoint\", { isOccupied: true });\n      }\n      if (WITH_NAF && NAF.connection.adapter) NAF.utils.takeOwnership(this.el);\n    }\n\n    if (this.data.canBeClicked && oldData.isOccupied !== this.data.isOccupied) {\n      if (this.data.isOccupied) {\n        this.el.object3D.visible = false;\n        this.el.classList.remove(\"clickable\");\n      } else {\n        this.el.object3D.visible = true;\n        this.el.classList.add(\"clickable\");\n      }\n    }\n  },\n});\n\nAFRAME.registerComponent(\"move-to-spawn-point\", {\n  init() {\n    this.move = this.move.bind(this);\n    this.locationHashChanged = this.locationHashChanged.bind(this);\n  },\n\n  locationHashChanged() {\n    const hash = window.location.hash;\n    if (hash !== \"\") {\n      const waypoint = document.querySelector(hash);\n      if (waypoint) {\n        waypoint.emit(\"click\", { withTransition: false });\n        return true;\n      }\n    }\n    return false;\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"waypoints-ready\", this.move);\n    window.addEventListener(\"hashchange\", this.locationHashChanged);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"waypoints-ready\", this.move);\n    window.removeEventListener(\"hashchange\", this.locationHashChanged);\n  },\n\n  move() {\n    // If the url has a hash and the hash is a waypoint then spawn at that waypoint.\n    if (this.locationHashChanged()) {\n      return;\n    }\n\n    // Else spawn at the first defined spawn point or the center.\n    const waypointSystem = this.el.sceneEl.systems.waypoint;\n    const spawnPoints = waypointSystem.registeredWaypoints.filter(\n      (waypoint) => waypoint.components.waypoint.data.canBeSpawnPoint\n    );\n    const firstSpawnPoint = spawnPoints.length > 0 ? spawnPoints[0] : null;\n\n    if (firstSpawnPoint) {\n      firstSpawnPoint.emit(\"click\", { withTransition: false }); // even if waypoint is not canBeClickable, this is to share the logic\n    } else {\n      const cameraRig = document.querySelector(\"#rig,#cameraRig\");\n      const camera = cameraRig.querySelector(\"a-camera,[camera]\");\n      waypointSystem.teleportTo({ x: 0, y: 0, z: 0 }, { x: 0, y: 0, z: 0 }, false);\n      cameraRig.setAttribute(\"player-info\", \"avatarPose\", \"stand\");\n      camera.object3D.position.y = 1.6;\n    }\n  },\n});\n\nAFRAME.registerComponent(\"move-to-unoccupied-waypoint\", {\n  schema: {\n    on: { type: \"string\", default: \"click\" },\n    delay: { type: \"number\", default: 0 },\n    filterRegExp: { type: \"string\", default: \"\" },\n  },\n  init() {\n    this.move = this.move.bind(this);\n    this.listenerTrigger = this.listenerTrigger.bind(this);\n    this.listenerWaypointsReady = this.listenerWaypointsReady.bind(this);\n    this.waypointsReady = false;\n    this.triggered = false;\n    this.moved = false;\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"waypoints-ready\", this.listenerWaypointsReady);\n    if (this.data.on === \"connected\") {\n      document.body.addEventListener(\"connected\", this.listenerTrigger);\n    } else {\n      this.el.addEventListener(this.data.on, this.listenerTrigger);\n    }\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"waypoints-ready\", this.listenerWaypointsReady);\n    if (this.data.on === \"connected\") {\n      document.body.removeEventListener(\"connected\", this.listenerTrigger);\n    } else {\n      this.el.removeEventListener(this.data.on, this.listenerTrigger);\n    }\n  },\n\n  listenerTrigger() {\n    if (this.data.on === \"connected\" && this.moved) return;\n    this.triggered = true;\n    // If the component is used with the connected event and the url includes a hash to spawn on a specific waypoint, then don't move.\n    if (this.data.on === \"connected\" && window.location.hash !== \"\") return;\n    if (this.triggered && this.waypointsReady) {\n      setTimeout(this.move, this.data.delay * 1000);\n    }\n  },\n\n  listenerWaypointsReady() {\n    if (this.data.on === \"connected\" && this.moved) return;\n    this.waypointsReady = true;\n    if (this.triggered && this.waypointsReady) {\n      if (this.data.delay === 0) {\n        this.move();\n      } else {\n        setTimeout(this.move, this.data.delay * 1000);\n      }\n    }\n  },\n\n  move() {\n    this.moved = true;\n    const waypointSystem = this.el.sceneEl.systems.waypoint;\n    const filterRegExp = this.data.filterRegExp ? new RegExp(this.data.filterRegExp) : null;\n    const waypoints = waypointSystem.registeredWaypoints.filter((waypoint) => {\n      let include = waypoint.components.waypoint.data.canBeOccupied && !waypoint.components.waypoint.data.isOccupied;\n      if (filterRegExp && !waypoint.id.match(filterRegExp)) {\n        include = false;\n      }\n      return include;\n    });\n    const firstUnoccupiedWaypoint = waypoints.length > 0 ? waypoints[0] : null;\n\n    if (firstUnoccupiedWaypoint) {\n      firstUnoccupiedWaypoint.emit(\"click\", { withTransition: false });\n    }\n  },\n});\n\nAFRAME.registerPrimitive(\"a-waypoint\", {\n  defaultComponents: {\n    networked: { template: \"#waypoint-template\", attachTemplateToLocal: false, persistent: true, owner: \"scene\" },\n    waypoint: {},\n    // We should really add networked component only if waypoint.canBeOccupied but I don't see how to do it from the primitive\n    // so we remove networked component in waypoint init if canBeOccupied.\n    // The order networked then waypoint in defaultComponents is important here for it to work.\n  },\n\n  mappings: {\n    id: \"networked.networkId\",\n    \"can-be-clicked\": \"waypoint.canBeClicked\",\n    \"can-be-occupied\": \"waypoint.canBeOccupied\",\n    \"can-be-spawn-point\": \"waypoint.canBeSpawnPoint\",\n    \"snap-to-nav-mesh\": \"waypoint.snapToNavMesh\",\n    \"will-disable-motion\": \"waypoint.willDisableMotion\",\n    \"will-disable-teleporting\": \"waypoint.willDisableTeleporting\",\n    \"will-maintain-initial-orientation\": \"waypoint.willMaintainInitialOrientation\",\n  },\n});\n","/* global AFRAME */\nAFRAME.registerComponent(\"open-link\", {\n  schema: {\n    on: { type: \"string\", default: \"click\" },\n    href: { type: \"string\", default: \"\" },\n  },\n\n  init() {\n    this.move = this.move.bind(this);\n  },\n\n  play() {\n    this.el.addEventListener(this.data.on, this.move);\n  },\n\n  pause() {\n    this.el.removeEventListener(this.data.on, this.move);\n  },\n\n  move() {\n    if (this.data.href.startsWith(\"#\")) {\n      const waypoint = document.querySelector(this.data.href);\n      if (!waypoint) {\n        console.warn(`No waypoint found with the id ${this.data.href}`);\n      } else {\n        waypoint.emit(\"click\");\n      }\n    } else {\n      if (this.el.sceneEl.is(\"vr-mode\")) {\n        this.el.sceneEl.exitVR();\n      }\n      window.open(this.data.href);\n    }\n  },\n});\n","/* global AFRAME THREE */\nAFRAME.registerComponent(\"reflection-probe\", {\n  schema: {\n    size: { default: 1 },\n    envMapTexture: { type: \"map\" },\n  },\n\n  init: function () {\n    this.el.object3D.updateWorldMatrix(true, false);\n\n    const box = new THREE.Box3()\n      .setFromCenterAndSize(new THREE.Vector3(), new THREE.Vector3().setScalar(this.data.size * 2))\n      .applyMatrix4(this.el.object3D.matrixWorld);\n\n    this.el.setObject3D(\"probe\", new THREE.ReflectionProbe(box, this.data.envMapTexture));\n\n    // if (this.el.sceneEl.systems[\"hubs-systems\"].environmentSystem.debugMode) {\n    //   const debugBox = new THREE.Box3().setFromCenterAndSize(\n    //     new THREE.Vector3(),\n    //     new THREE.Vector3().setScalar(this.data.size * 2)\n    //   );\n    //   this.el.setObject3D(\n    //     \"helper\",\n    //     new THREE.Box3Helper(debugBox, new THREE.Color(Math.random(), Math.random(), Math.random()))\n    //   );\n    // }\n  },\n});\n","module.exports = __WEBPACK_EXTERNAL_MODULE__612__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","import {\n\tDataTextureLoader,\n\tDataUtils,\n\tFloatType,\n\tHalfFloatType,\n\tLinearFilter,\n\tLinearSRGBColorSpace\n} from 'three';\n\n// https://github.com/mrdoob/three.js/issues/5552\n// http://en.wikipedia.org/wiki/RGBE_image_format\n\nclass RGBELoader extends DataTextureLoader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.type = HalfFloatType;\n\n\t}\n\n\t// adapted from http://www.graphics.cornell.edu/~bjw/rgbe.html\n\n\tparse( buffer ) {\n\n\t\tconst\n\t\t\t/* default error routine.  change this to change error handling */\n\t\t\trgbe_read_error = 1,\n\t\t\trgbe_write_error = 2,\n\t\t\trgbe_format_error = 3,\n\t\t\trgbe_memory_error = 4,\n\t\t\trgbe_error = function ( rgbe_error_code, msg ) {\n\n\t\t\t\tswitch ( rgbe_error_code ) {\n\n\t\t\t\t\tcase rgbe_read_error: throw new Error( 'THREE.RGBELoader: Read Error: ' + ( msg || '' ) );\n\t\t\t\t\tcase rgbe_write_error: throw new Error( 'THREE.RGBELoader: Write Error: ' + ( msg || '' ) );\n\t\t\t\t\tcase rgbe_format_error: throw new Error( 'THREE.RGBELoader: Bad File Format: ' + ( msg || '' ) );\n\t\t\t\t\tdefault:\n\t\t\t\t\tcase rgbe_memory_error: throw new Error( 'THREE.RGBELoader: Memory Error: ' + ( msg || '' ) );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t/* offsets to red, green, and blue components in a data (float) pixel */\n\t\t\t//RGBE_DATA_RED = 0,\n\t\t\t//RGBE_DATA_GREEN = 1,\n\t\t\t//RGBE_DATA_BLUE = 2,\n\n\t\t\t/* number of floats per pixel, use 4 since stored in rgba image format */\n\t\t\t//RGBE_DATA_SIZE = 4,\n\n\t\t\t/* flags indicating which fields in an rgbe_header_info are valid */\n\t\t\tRGBE_VALID_PROGRAMTYPE = 1,\n\t\t\tRGBE_VALID_FORMAT = 2,\n\t\t\tRGBE_VALID_DIMENSIONS = 4,\n\n\t\t\tNEWLINE = '\\n',\n\n\t\t\tfgets = function ( buffer, lineLimit, consume ) {\n\n\t\t\t\tconst chunkSize = 128;\n\n\t\t\t\tlineLimit = ! lineLimit ? 1024 : lineLimit;\n\t\t\t\tlet p = buffer.pos,\n\t\t\t\t\ti = - 1, len = 0, s = '',\n\t\t\t\t\tchunk = String.fromCharCode.apply( null, new Uint16Array( buffer.subarray( p, p + chunkSize ) ) );\n\n\t\t\t\twhile ( ( 0 > ( i = chunk.indexOf( NEWLINE ) ) ) && ( len < lineLimit ) && ( p < buffer.byteLength ) ) {\n\n\t\t\t\t\ts += chunk; len += chunk.length;\n\t\t\t\t\tp += chunkSize;\n\t\t\t\t\tchunk += String.fromCharCode.apply( null, new Uint16Array( buffer.subarray( p, p + chunkSize ) ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( - 1 < i ) {\n\n\t\t\t\t\t/*for (i=l-1; i>=0; i--) {\n\t\t\t\t\t\tbyteCode = m.charCodeAt(i);\n\t\t\t\t\t\tif (byteCode > 0x7f && byteCode <= 0x7ff) byteLen++;\n\t\t\t\t\t\telse if (byteCode > 0x7ff && byteCode <= 0xffff) byteLen += 2;\n\t\t\t\t\t\tif (byteCode >= 0xDC00 && byteCode <= 0xDFFF) i--; //trail surrogate\n\t\t\t\t\t}*/\n\t\t\t\t\tif ( false !== consume ) buffer.pos += len + i + 1;\n\t\t\t\t\treturn s + chunk.slice( 0, i );\n\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t},\n\n\t\t\t/* minimal header reading.  modify if you want to parse more information */\n\t\t\tRGBE_ReadHeader = function ( buffer ) {\n\n\n\t\t\t\t// regexes to parse header info fields\n\t\t\t\tconst magic_token_re = /^#\\?(\\S+)/,\n\t\t\t\t\tgamma_re = /^\\s*GAMMA\\s*=\\s*(\\d+(\\.\\d+)?)\\s*$/,\n\t\t\t\t\texposure_re = /^\\s*EXPOSURE\\s*=\\s*(\\d+(\\.\\d+)?)\\s*$/,\n\t\t\t\t\tformat_re = /^\\s*FORMAT=(\\S+)\\s*$/,\n\t\t\t\t\tdimensions_re = /^\\s*\\-Y\\s+(\\d+)\\s+\\+X\\s+(\\d+)\\s*$/,\n\n\t\t\t\t\t// RGBE format header struct\n\t\t\t\t\theader = {\n\n\t\t\t\t\t\tvalid: 0, /* indicate which fields are valid */\n\n\t\t\t\t\t\tstring: '', /* the actual header string */\n\n\t\t\t\t\t\tcomments: '', /* comments found in header */\n\n\t\t\t\t\t\tprogramtype: 'RGBE', /* listed at beginning of file to identify it after \"#?\". defaults to \"RGBE\" */\n\n\t\t\t\t\t\tformat: '', /* RGBE format, default 32-bit_rle_rgbe */\n\n\t\t\t\t\t\tgamma: 1.0, /* image has already been gamma corrected with given gamma. defaults to 1.0 (no correction) */\n\n\t\t\t\t\t\texposure: 1.0, /* a value of 1.0 in an image corresponds to <exposure> watts/steradian/m^2. defaults to 1.0 */\n\n\t\t\t\t\t\twidth: 0, height: 0 /* image dimensions, width/height */\n\n\t\t\t\t\t};\n\n\t\t\t\tlet line, match;\n\n\t\t\t\tif ( buffer.pos >= buffer.byteLength || ! ( line = fgets( buffer ) ) ) {\n\n\t\t\t\t\trgbe_error( rgbe_read_error, 'no header found' );\n\n\t\t\t\t}\n\n\t\t\t\t/* if you want to require the magic token then uncomment the next line */\n\t\t\t\tif ( ! ( match = line.match( magic_token_re ) ) ) {\n\n\t\t\t\t\trgbe_error( rgbe_format_error, 'bad initial token' );\n\n\t\t\t\t}\n\n\t\t\t\theader.valid |= RGBE_VALID_PROGRAMTYPE;\n\t\t\t\theader.programtype = match[ 1 ];\n\t\t\t\theader.string += line + '\\n';\n\n\t\t\t\twhile ( true ) {\n\n\t\t\t\t\tline = fgets( buffer );\n\t\t\t\t\tif ( false === line ) break;\n\t\t\t\t\theader.string += line + '\\n';\n\n\t\t\t\t\tif ( '#' === line.charAt( 0 ) ) {\n\n\t\t\t\t\t\theader.comments += line + '\\n';\n\t\t\t\t\t\tcontinue; // comment line\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( match = line.match( gamma_re ) ) {\n\n\t\t\t\t\t\theader.gamma = parseFloat( match[ 1 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( match = line.match( exposure_re ) ) {\n\n\t\t\t\t\t\theader.exposure = parseFloat( match[ 1 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( match = line.match( format_re ) ) {\n\n\t\t\t\t\t\theader.valid |= RGBE_VALID_FORMAT;\n\t\t\t\t\t\theader.format = match[ 1 ];//'32-bit_rle_rgbe';\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( match = line.match( dimensions_re ) ) {\n\n\t\t\t\t\t\theader.valid |= RGBE_VALID_DIMENSIONS;\n\t\t\t\t\t\theader.height = parseInt( match[ 1 ], 10 );\n\t\t\t\t\t\theader.width = parseInt( match[ 2 ], 10 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ( header.valid & RGBE_VALID_FORMAT ) && ( header.valid & RGBE_VALID_DIMENSIONS ) ) break;\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! ( header.valid & RGBE_VALID_FORMAT ) ) {\n\n\t\t\t\t\trgbe_error( rgbe_format_error, 'missing format specifier' );\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! ( header.valid & RGBE_VALID_DIMENSIONS ) ) {\n\n\t\t\t\t\trgbe_error( rgbe_format_error, 'missing image size specifier' );\n\n\t\t\t\t}\n\n\t\t\t\treturn header;\n\n\t\t\t},\n\n\t\t\tRGBE_ReadPixels_RLE = function ( buffer, w, h ) {\n\n\t\t\t\tconst scanline_width = w;\n\n\t\t\t\tif (\n\t\t\t\t\t// run length encoding is not allowed so read flat\n\t\t\t\t\t( ( scanline_width < 8 ) || ( scanline_width > 0x7fff ) ) ||\n\t\t\t\t\t// this file is not run length encoded\n\t\t\t\t\t( ( 2 !== buffer[ 0 ] ) || ( 2 !== buffer[ 1 ] ) || ( buffer[ 2 ] & 0x80 ) )\n\t\t\t\t) {\n\n\t\t\t\t\t// return the flat buffer\n\t\t\t\t\treturn new Uint8Array( buffer );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scanline_width !== ( ( buffer[ 2 ] << 8 ) | buffer[ 3 ] ) ) {\n\n\t\t\t\t\trgbe_error( rgbe_format_error, 'wrong scanline width' );\n\n\t\t\t\t}\n\n\t\t\t\tconst data_rgba = new Uint8Array( 4 * w * h );\n\n\t\t\t\tif ( ! data_rgba.length ) {\n\n\t\t\t\t\trgbe_error( rgbe_memory_error, 'unable to allocate buffer space' );\n\n\t\t\t\t}\n\n\t\t\t\tlet offset = 0, pos = 0;\n\n\t\t\t\tconst ptr_end = 4 * scanline_width;\n\t\t\t\tconst rgbeStart = new Uint8Array( 4 );\n\t\t\t\tconst scanline_buffer = new Uint8Array( ptr_end );\n\t\t\t\tlet num_scanlines = h;\n\n\t\t\t\t// read in each successive scanline\n\t\t\t\twhile ( ( num_scanlines > 0 ) && ( pos < buffer.byteLength ) ) {\n\n\t\t\t\t\tif ( pos + 4 > buffer.byteLength ) {\n\n\t\t\t\t\t\trgbe_error( rgbe_read_error );\n\n\t\t\t\t\t}\n\n\t\t\t\t\trgbeStart[ 0 ] = buffer[ pos ++ ];\n\t\t\t\t\trgbeStart[ 1 ] = buffer[ pos ++ ];\n\t\t\t\t\trgbeStart[ 2 ] = buffer[ pos ++ ];\n\t\t\t\t\trgbeStart[ 3 ] = buffer[ pos ++ ];\n\n\t\t\t\t\tif ( ( 2 != rgbeStart[ 0 ] ) || ( 2 != rgbeStart[ 1 ] ) || ( ( ( rgbeStart[ 2 ] << 8 ) | rgbeStart[ 3 ] ) != scanline_width ) ) {\n\n\t\t\t\t\t\trgbe_error( rgbe_format_error, 'bad rgbe scanline format' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// read each of the four channels for the scanline into the buffer\n\t\t\t\t\t// first red, then green, then blue, then exponent\n\t\t\t\t\tlet ptr = 0, count;\n\n\t\t\t\t\twhile ( ( ptr < ptr_end ) && ( pos < buffer.byteLength ) ) {\n\n\t\t\t\t\t\tcount = buffer[ pos ++ ];\n\t\t\t\t\t\tconst isEncodedRun = count > 128;\n\t\t\t\t\t\tif ( isEncodedRun ) count -= 128;\n\n\t\t\t\t\t\tif ( ( 0 === count ) || ( ptr + count > ptr_end ) ) {\n\n\t\t\t\t\t\t\trgbe_error( rgbe_format_error, 'bad scanline data' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( isEncodedRun ) {\n\n\t\t\t\t\t\t\t// a (encoded) run of the same value\n\t\t\t\t\t\t\tconst byteValue = buffer[ pos ++ ];\n\t\t\t\t\t\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\t\t\t\t\t\tscanline_buffer[ ptr ++ ] = byteValue;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//ptr += count;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// a literal-run\n\t\t\t\t\t\t\tscanline_buffer.set( buffer.subarray( pos, pos + count ), ptr );\n\t\t\t\t\t\t\tptr += count; pos += count;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\n\t\t\t\t\t// now convert data from buffer into rgba\n\t\t\t\t\t// first red, then green, then blue, then exponent (alpha)\n\t\t\t\t\tconst l = scanline_width; //scanline_buffer.byteLength;\n\t\t\t\t\tfor ( let i = 0; i < l; i ++ ) {\n\n\t\t\t\t\t\tlet off = 0;\n\t\t\t\t\t\tdata_rgba[ offset ] = scanline_buffer[ i + off ];\n\t\t\t\t\t\toff += scanline_width; //1;\n\t\t\t\t\t\tdata_rgba[ offset + 1 ] = scanline_buffer[ i + off ];\n\t\t\t\t\t\toff += scanline_width; //1;\n\t\t\t\t\t\tdata_rgba[ offset + 2 ] = scanline_buffer[ i + off ];\n\t\t\t\t\t\toff += scanline_width; //1;\n\t\t\t\t\t\tdata_rgba[ offset + 3 ] = scanline_buffer[ i + off ];\n\t\t\t\t\t\toffset += 4;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tnum_scanlines --;\n\n\t\t\t\t}\n\n\t\t\t\treturn data_rgba;\n\n\t\t\t};\n\n\t\tconst RGBEByteToRGBFloat = function ( sourceArray, sourceOffset, destArray, destOffset ) {\n\n\t\t\tconst e = sourceArray[ sourceOffset + 3 ];\n\t\t\tconst scale = Math.pow( 2.0, e - 128.0 ) / 255.0;\n\n\t\t\tdestArray[ destOffset + 0 ] = sourceArray[ sourceOffset + 0 ] * scale;\n\t\t\tdestArray[ destOffset + 1 ] = sourceArray[ sourceOffset + 1 ] * scale;\n\t\t\tdestArray[ destOffset + 2 ] = sourceArray[ sourceOffset + 2 ] * scale;\n\t\t\tdestArray[ destOffset + 3 ] = 1;\n\n\t\t};\n\n\t\tconst RGBEByteToRGBHalf = function ( sourceArray, sourceOffset, destArray, destOffset ) {\n\n\t\t\tconst e = sourceArray[ sourceOffset + 3 ];\n\t\t\tconst scale = Math.pow( 2.0, e - 128.0 ) / 255.0;\n\n\t\t\t// clamping to 65504, the maximum representable value in float16\n\t\t\tdestArray[ destOffset + 0 ] = DataUtils.toHalfFloat( Math.min( sourceArray[ sourceOffset + 0 ] * scale, 65504 ) );\n\t\t\tdestArray[ destOffset + 1 ] = DataUtils.toHalfFloat( Math.min( sourceArray[ sourceOffset + 1 ] * scale, 65504 ) );\n\t\t\tdestArray[ destOffset + 2 ] = DataUtils.toHalfFloat( Math.min( sourceArray[ sourceOffset + 2 ] * scale, 65504 ) );\n\t\t\tdestArray[ destOffset + 3 ] = DataUtils.toHalfFloat( 1 );\n\n\t\t};\n\n\t\tconst byteArray = new Uint8Array( buffer );\n\t\tbyteArray.pos = 0;\n\t\tconst rgbe_header_info = RGBE_ReadHeader( byteArray );\n\n\t\tconst w = rgbe_header_info.width,\n\t\t\th = rgbe_header_info.height,\n\t\t\timage_rgba_data = RGBE_ReadPixels_RLE( byteArray.subarray( byteArray.pos ), w, h );\n\n\n\t\tlet data, type;\n\t\tlet numElements;\n\n\t\tswitch ( this.type ) {\n\n\t\t\tcase FloatType:\n\n\t\t\t\tnumElements = image_rgba_data.length / 4;\n\t\t\t\tconst floatArray = new Float32Array( numElements * 4 );\n\n\t\t\t\tfor ( let j = 0; j < numElements; j ++ ) {\n\n\t\t\t\t\tRGBEByteToRGBFloat( image_rgba_data, j * 4, floatArray, j * 4 );\n\n\t\t\t\t}\n\n\t\t\t\tdata = floatArray;\n\t\t\t\ttype = FloatType;\n\t\t\t\tbreak;\n\n\t\t\tcase HalfFloatType:\n\n\t\t\t\tnumElements = image_rgba_data.length / 4;\n\t\t\t\tconst halfArray = new Uint16Array( numElements * 4 );\n\n\t\t\t\tfor ( let j = 0; j < numElements; j ++ ) {\n\n\t\t\t\t\tRGBEByteToRGBHalf( image_rgba_data, j * 4, halfArray, j * 4 );\n\n\t\t\t\t}\n\n\t\t\t\tdata = halfArray;\n\t\t\t\ttype = HalfFloatType;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tthrow new Error( 'THREE.RGBELoader: Unsupported type: ' + this.type );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\treturn {\n\t\t\twidth: w, height: h,\n\t\t\tdata: data,\n\t\t\theader: rgbe_header_info.string,\n\t\t\tgamma: rgbe_header_info.gamma,\n\t\t\texposure: rgbe_header_info.exposure,\n\t\t\ttype: type\n\t\t};\n\n\t}\n\n\tsetDataType( value ) {\n\n\t\tthis.type = value;\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tfunction onLoadCallback( texture, texData ) {\n\n\t\t\tswitch ( texture.type ) {\n\n\t\t\t\tcase FloatType:\n\t\t\t\tcase HalfFloatType:\n\n\t\t\t\t\ttexture.colorSpace = LinearSRGBColorSpace;\n\t\t\t\t\ttexture.minFilter = LinearFilter;\n\t\t\t\t\ttexture.magFilter = LinearFilter;\n\t\t\t\t\ttexture.generateMipmaps = false;\n\t\t\t\t\ttexture.flipY = true;\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( onLoad ) onLoad( texture, texData );\n\n\t\t}\n\n\t\treturn super.load( url, onLoadCallback, onProgress, onError );\n\n\t}\n\n}\n\nexport { RGBELoader };\n","/**\n * @author mrdoob / http://mrdoob.com/\n * @license MIT\n * https://github.com/mrdoob/eventdispatcher.js/tree/f31179e964ce6cd76818fd25f4152d4bcc82040c/src\n * with `event.target = this` commented, target is set before calling dispatchEvent.\n * This code is used in FakeEntity.\n */\n\nclass EventDispatcher {\n  addEventListener(type, listener) {\n    if (this._listeners === undefined) this._listeners = {};\n\n    const listeners = this._listeners;\n\n    if (listeners[type] === undefined) {\n      listeners[type] = [];\n    }\n\n    if (listeners[type].indexOf(listener) === -1) {\n      listeners[type].push(listener);\n    }\n  }\n\n  hasEventListener(type, listener) {\n    if (this._listeners === undefined) return false;\n\n    const listeners = this._listeners;\n\n    return listeners[type] !== undefined && listeners[type].indexOf(listener) !== -1;\n  }\n\n  removeEventListener(type, listener) {\n    if (this._listeners === undefined) return;\n\n    const listeners = this._listeners;\n    const listenerArray = listeners[type];\n\n    if (listenerArray !== undefined) {\n      const index = listenerArray.indexOf(listener);\n\n      if (index !== -1) {\n        listenerArray.splice(index, 1);\n      }\n    }\n  }\n\n  dispatchEvent(event) {\n    if (this._listeners === undefined) return;\n\n    const listeners = this._listeners;\n    const listenerArray = listeners[event.type];\n\n    if (listenerArray !== undefined) {\n      // event.target = this;\n\n      // Make a copy, in case listeners are removed while iterating.\n      const array = listenerArray.slice(0);\n\n      for (let i = 0, l = array.length; i < l; i++) {\n        array[i].call(this, event);\n      }\n    }\n  }\n}\n\nexport { EventDispatcher };\n","/* global AFRAME, THREE */\nimport { addComponent } from \"../inflators/utils\";\nimport { EventDispatcher } from \"./EventDispatcher\";\n\nconst MULTIPLE_COMPONENT_DELIMITER = \"__\";\n\n// Reusable object for performance\nconst eventData = {};\nconst singlePropUpdate = {};\nconst FAKE_NODE = { removeChild: () => {} }; // eslint-disable-line\n\nfunction getRotation(entityEl) {\n  const radToDeg = THREE.MathUtils.radToDeg;\n  const rotation = entityEl.object3D.rotation;\n  const rotationObj = entityEl.rotationObj;\n  rotationObj.x = radToDeg(rotation.x);\n  rotationObj.y = radToDeg(rotation.y);\n  rotationObj.z = radToDeg(rotation.z);\n  return rotationObj;\n}\n\n/**\n * FakeEntity has a similar API than a-entity but doesn't extend HTMLElement.\n * It allows to use existing aframe components on a THREE node (Group or Object3D) without adding extra DOM element or THREE.Group.\n * This object is created automatically via the addComponent function used in gltf-model-plus component.\n * Differences from a-entity:\n * - Doesn't support component dependencies or mixins logic\n * - Support only simple setAttribute(componentName, object), only one component of the same type, mainly used if a component is using this api.\n * - getAttribute/removeAttribute is not supported, so we're not handling special case of getAttribute for position rotation scale,\n *   use object3D.position directly.\n * - el.object3D is the node.\n *   The fake entity is there only to have a compatible API to use some existing aframe components.\n * - Be careful, node.el may not be the FakeEntity until the FakeEntity is created by adding a first component to the node,\n *   before that it will be the closest a-entity node, you may use node.fakeEl if you need to access the fake entity.\n * - In a component associated to a FakeEntity, this.el.children and this.el.parentNode won't be supported. The THREE node is the primary element here,\n *   so you probably want to modify the component to use this.el.object3D.children for example.\n * - FakeEntity remove is not implemented because we don't have children/parentNode set. (We actually have a weird hack for parentNode, see below.)\n *   Properly removing all components are done externarly by calling node.fakeEl.destroy() in gltf-model-plus remove function.\n * - Because FakeEntity is not a DOM element, you can't use this.el.querySelector API.\n * - You can't use document.querySelectorAll('[waypoint]')) to find all waypoint component set on a FakeEntity either.\n *\n * This implementation has been tested with the following components: gltf-model uv-scroll reflection-probe waypoint/networked\n * but we currently don't use it for waypoint/networked because of compatibility with raycaster and querySelector\n */\nexport class FakeEntity extends EventDispatcher {\n  constructor(node) {\n    super();\n    this.components = {};\n    // To avoid double initializations and infinite loops.\n    this.initializingComponents = {};\n    this.object3D = node;\n    this.sceneEl = node.el.sceneEl; // node.el at this point is a a-entity where we loaded the glb\n    this.object3D.el = this; // override node.el with this FakeEntity instance\n    this.isEntity = true; // used for raycaster refreshObjects\n    this.isPlaying = true; // true by default, we don't implement the play/pause logic on this FakeEntity implementation\n    this.object3DMap = {};\n    this.rotationObj = {};\n    this.states = [];\n    // networked component needs parentElement and getAttribute('networked') to set\n    // syncData.parent = this.getParentId();\n    // we don't really support networked parent here, so setting them to sceneEl\n    this.parentElement = this.sceneEl;\n    // networked and networked-audio-source components verify if the entity wasn't removed by checking this.el.parentNode\n    // NAF also have this code\n    // entity.parentNode.removeChild(entity)\n    // that is executed via NAF.connection.disconnect() that calls this.entities.removeRemoteEntities()\n    // so setting a dummy object with removeChild to make them happy.\n    this.parentNode = FAKE_NODE;\n\n    // variables defined by a-node api that are used by the component api\n    this.hasLoaded = true;\n    this.mixinEls = [];\n    this.tagName = \"FAKE_ENTITY\";\n    this.isFakeEntity = true;\n  }\n\n  get children() {\n    throw Error(\"FakeEntity el.children not implemented, try another way, maybe el.object3D.children\");\n  }\n\n  // get parentNode() {\n  //   throw Error(\"FakeEntity el.parentNode not implemented, try another way, maybe el.object3D.parent\");\n  // }\n\n  addState(state) {\n    if (this.is(state)) {\n      return;\n    }\n    this.states.push(state);\n    this.emit(\"stateadded\", state);\n  }\n\n  removeState(state) {\n    const stateIndex = this.states.indexOf(state);\n    if (stateIndex === -1) {\n      return;\n    }\n    this.states.splice(stateIndex, 1);\n    this.emit(\"stateremoved\", state);\n  }\n\n  /**\n   * Checks if the element is in a given state. e.g. el.is('alive');\n   * @type {string} state - Name of the state we want to check\n   */\n  is(state) {\n    return this.states.indexOf(state) !== -1;\n  }\n\n  getAttribute(attr) {\n    if (attr === \"position\") {\n      return this.object3D.position;\n    }\n    if (attr === \"rotation\") {\n      return getRotation(this);\n    }\n    if (attr === \"scale\") {\n      return this.object3D.scale;\n    }\n    if (attr === \"visible\") {\n      return this.object3D.visible;\n    }\n    if (attr === \"class\" || attr === \"mixin\") {\n      console.warn(`FakeEntity el.getAttribute('${attr}') called`, this.object3D);\n      return \"\";\n    }\n    // If component, return component data.\n    const component = this.components[attr];\n    if (component) {\n      return component.data;\n    }\n    throw Error(`FakeEntity el.getAttribute('${attr}') not implemented`);\n  }\n\n  getDOMAttribute(attr) {\n    console.warn(`FakeEntity el.getDOMAttribute('${attr}') called`, this.object3D);\n    return \"\";\n  }\n\n  flushToDOM() {\n    // do nothing\n  }\n\n  removeAttribute() {\n    throw Error(\"FakeEntity el.removeAttribute not implemented\");\n  }\n\n  /**\n   * setAttribute can:\n   *\n   * 1. Set a single property of a multi-property component.\n   * 2. Set multiple properties of a multi-property component.\n   * 3. Replace properties of a multi-property component.\n   * 4. Set a value for a single-property component, ~~mixin, or normal HTML attribute~~.\n   *\n   * @param {string} attrName - Component ~~or attribute~~ name.\n   * @param {*} arg1 - Can be a value, property name, CSS-style property string, or\n   *   object of properties.\n   * @param {*|bool} arg2 - If arg1 is a property name, this should be a value. Otherwise,\n   *   it is a boolean indicating whether to clobber previous values (defaults to false).\n   */\n  setAttribute(componentName, arg1, arg2) {\n    if (componentName.indexOf(MULTIPLE_COMPONENT_DELIMITER) > -1) {\n      throw Error(\n        `FakeEntity setAttribute(\"${componentName}\", ...) using multiple components of the same type is not supported`\n      );\n    }\n    if (!AFRAME.components[componentName]) {\n      if (componentName === \"id\") {\n        // networked component is setting the id to be the same as networkId\n        this.id = arg1;\n        return;\n      }\n      throw Error(`FakeEntity setAttribute(\"${componentName}\", ...) not supported, this is not a registered component`);\n    }\n\n    let newAttrValue, clobber;\n    // Determine new attributes from the arguments\n    if (\n      typeof arg2 !== \"undefined\" &&\n      typeof arg1 === \"string\" &&\n      arg1.length > 0 &&\n      typeof AFRAME.utils.styleParser.parse(arg1) === \"string\"\n    ) {\n      // Update a single property of a multi-property component\n      for (const key in singlePropUpdate) {\n        delete singlePropUpdate[key];\n      }\n      newAttrValue = singlePropUpdate;\n      newAttrValue[arg1] = arg2;\n      clobber = false;\n    } else {\n      // Update with a value, object, or CSS-style property string, with the possiblity\n      // of clobbering previous values.\n      newAttrValue = arg1;\n      clobber = arg2 === true;\n    }\n\n    this.updateComponent(componentName, newAttrValue, clobber);\n  }\n\n  updateComponent(attr, attrValue, clobber) {\n    const component = this.components[attr];\n\n    if (component) {\n      // Remove component.\n      // if (attrValue === null && !checkComponentDefined(this, attr)) {\n      if (attrValue === null) {\n        this.removeComponent(attr, true);\n        return;\n      }\n      // Component already initialized. Update component.\n      component.updateProperties(attrValue, clobber);\n      return;\n    }\n\n    // Component not yet initialized. Initialize component.\n    this.initComponent(attr, attrValue, false);\n  }\n\n  /**\n   * Initialize component.\n   *\n   * @param {string} attrName - Attribute name associated to the component.\n   * @param {object} data - Component data\n   * @param {boolean} isDependency - True if the component is a dependency.\n   */\n  // eslint-disable-next-line\n  initComponent(attrName, data, isDependency) {\n    addComponent(this.object3D, attrName, data);\n  }\n\n  removeComponent(name, destroy) {\n    const component = this.components[name];\n    if (!component) {\n      return;\n    }\n\n    // Wait for component to initialize.\n    if (!component.initialized) {\n      this.addEventListener(\"componentinitialized\", function tryRemoveLater(evt) {\n        if (evt.detail.name !== name) {\n          return;\n        }\n        this.removeComponent(name, destroy);\n        this.removeEventListener(\"componentinitialized\", tryRemoveLater);\n      });\n      return;\n    }\n\n    component.pause();\n    component.remove();\n\n    // Keep component attached to entity in case of just full entity detach.\n    if (destroy) {\n      component.destroy();\n      delete this.components[name];\n    }\n\n    this.emit(\"componentremoved\", component.evtDetail, false);\n  }\n\n  getObject3D(type) {\n    return this.object3DMap[type];\n  }\n\n  /**\n   * Set a THREE.Object3D into the map.\n   *\n   * @param {string} type - Developer-set name of the type of object, will be unique per type.\n   * @param {object} obj - A THREE.Object3D.\n   */\n  setObject3D(type, obj) {\n    // Remove existing object of the type.\n    const oldObj = this.getObject3D(type);\n    if (oldObj) {\n      this.object3D.remove(oldObj);\n    }\n\n    // Set references to this fake entity.\n    obj.el = this;\n    const self = this;\n    if (obj.children.length) {\n      obj.traverse(function bindEl(child) {\n        child.el = self;\n      });\n    }\n\n    // Add.\n    if (obj !== this.object3D) {\n      this.object3D.add(obj);\n    }\n    this.object3DMap[type] = obj;\n    this.emit(\"object3dset\", { object: obj, type: type });\n  }\n\n  /**\n   * Remove object from scene and entity object3D map.\n   */\n  removeObject3D(type) {\n    const obj = this.getObject3D(type);\n    if (!obj) {\n      console.warn(\"Tried to remove `Object3D` of type:\", type, \"which was not defined.\");\n      return;\n    }\n    this.object3D.remove(obj);\n    delete this.object3DMap[type];\n    this.emit(\"object3dremove\", { type: type });\n  }\n\n  emit(name, detail, bubbles, extraData) {\n    if (bubbles === undefined) {\n      bubbles = true;\n    }\n    let data = eventData;\n    data.bubbles = !!bubbles;\n    data.detail = detail;\n\n    // If extra data is present, we need to create a new object.\n    if (extraData) {\n      data = AFRAME.utils.extend({}, extraData, data);\n    }\n\n    // In the default EventDispatcher implementation, dispatchEvent was setting target attribute on the event\n    // but we got an error with CustomEvent instance being readonly. So we're setting it in data first\n    // before creating the CustomEvent.\n    data.target = this;\n    this.dispatchEvent(new CustomEvent(name, data));\n    // And we reset target to null to be sure to not keep a reference to `this` for the garbage collector to work properly.\n    data.target = null;\n  }\n\n  destroy() {\n    for (const name in this.components) {\n      this.removeComponent(name, true);\n    }\n    this.object3D.el = null;\n    this.object3D = null;\n    this.sceneEl = null;\n    this.parentElement = null;\n    this.parentNode = null;\n  }\n}\n","/* global AFRAME */\nimport { FakeEntity } from \"../components/FakeEntity\";\n\nexport const addComponent = (node, componentName, data) => {\n  if (!AFRAME.components[componentName]) {\n    console.error(`Component ${componentName} not registered`);\n    return;\n  }\n\n  if (!node.fakeEl) {\n    node.fakeEl = new FakeEntity(node);\n  }\n  const componentId = undefined; // supporting only one component of the same type on a FakeEntity\n  const component = new AFRAME.components[componentName].Component(node.fakeEl, data, componentId);\n  component.play();\n  return component;\n};\n\nexport const createEntityAndReparent = (node, klass = undefined) => {\n  const sceneEl = node.el.sceneEl;\n  const entity = document.createElement(\"a-entity\");\n  if (klass) {\n    entity.classList.add(klass);\n  }\n  sceneEl.appendChild(entity);\n  entity.object3D.removeFromParent();\n  entity.object3D = node;\n  entity.object3D.el = entity;\n  // We assume here that node local position/quaternion is the same as world position/quaternion\n  sceneEl.object3D.attach(node);\n  return entity;\n};\n\n/**\n * Check if the window.absoluteURLForAsset function is defined, and use it to\n * convert the asset URLs to local URLs where the files are actually stored\n * to avoid CORS issues.\n * If the function is not defined, return the asset URL as is.\n * @param {string} asset The asset URL to convert.\n */\nexport const absoluteURLForAsset =\n  window.absoluteURLForAsset ||\n  ((asset) => {\n    return asset;\n  });\n","// https://wwwimages2.adobe.com/content/dam/acom/en/products/speedgrade/cc/pdfs/cube-lut-specification-1.0.pdf\n\nimport {\n\tClampToEdgeWrapping,\n\tData3DTexture,\n\tFileLoader,\n\tFloatType,\n\tLinearFilter,\n\tLoader,\n\tUnsignedByteType,\n\tVector3,\n} from 'three';\n\nexport class LUTCubeLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.type = UnsignedByteType;\n\n\t}\n\n\tsetType( type ) {\n\n\t\tif ( type !== UnsignedByteType && type !== FloatType ) {\n\n\t\t\tthrow new Error( 'LUTCubeLoader: Unsupported type' );\n\n\t\t}\n\n\t\tthis.type = type;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'text' );\n\t\tloader.load( url, text => {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( this.parse( text ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tthis.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( input ) {\n\n\t\tconst regExpTitle = /TITLE +\"([^\"]*)\"/;\n\t\tconst regExpSize = /LUT_3D_SIZE +(\\d+)/;\n\t\tconst regExpDomainMin = /DOMAIN_MIN +([\\d.]+) +([\\d.]+) +([\\d.]+)/;\n\t\tconst regExpDomainMax = /DOMAIN_MAX +([\\d.]+) +([\\d.]+) +([\\d.]+)/;\n\t\tconst regExpDataPoints = /^([\\d.e+-]+) +([\\d.e+-]+) +([\\d.e+-]+) *$/gm;\n\n\t\tlet result = regExpTitle.exec( input );\n\t\tconst title = ( result !== null ) ? result[ 1 ] : null;\n\n\t\tresult = regExpSize.exec( input );\n\n\t\tif ( result === null ) {\n\n\t\t\tthrow new Error( 'LUTCubeLoader: Missing LUT_3D_SIZE information' );\n\n\t\t}\n\n\t\tconst size = Number( result[ 1 ] );\n\t\tconst length = size ** 3 * 4;\n\t\tconst data = this.type === UnsignedByteType ? new Uint8Array( length ) : new Float32Array( length );\n\n\t\tconst domainMin = new Vector3( 0, 0, 0 );\n\t\tconst domainMax = new Vector3( 1, 1, 1 );\n\n\t\tresult = regExpDomainMin.exec( input );\n\n\t\tif ( result !== null ) {\n\n\t\t\tdomainMin.set( Number( result[ 1 ] ), Number( result[ 2 ] ), Number( result[ 3 ] ) );\n\n\t\t}\n\n\t\tresult = regExpDomainMax.exec( input );\n\n\t\tif ( result !== null ) {\n\n\t\t\tdomainMax.set( Number( result[ 1 ] ), Number( result[ 2 ] ), Number( result[ 3 ] ) );\n\n\t\t}\n\n\t\tif ( domainMin.x > domainMax.x || domainMin.y > domainMax.y || domainMin.z > domainMax.z ) {\n\n\t\t\tthrow new Error( 'LUTCubeLoader: Invalid input domain' );\n\n\t\t}\n\n\t\tconst scale = this.type === UnsignedByteType ? 255 : 1;\n\t\tlet i = 0;\n\n\t\twhile ( ( result = regExpDataPoints.exec( input ) ) !== null ) {\n\n\t\t\tdata[ i ++ ] = Number( result[ 1 ] ) * scale;\n\t\t\tdata[ i ++ ] = Number( result[ 2 ] ) * scale;\n\t\t\tdata[ i ++ ] = Number( result[ 3 ] ) * scale;\n\t\t\tdata[ i ++ ] = scale;\n\n\t\t}\n\n\t\tconst texture3D = new Data3DTexture();\n\t\ttexture3D.image.data = data;\n\t\ttexture3D.image.width = size;\n\t\ttexture3D.image.height = size;\n\t\ttexture3D.image.depth = size;\n\t\ttexture3D.type = this.type;\n\t\ttexture3D.magFilter = LinearFilter;\n\t\ttexture3D.minFilter = LinearFilter;\n\t\ttexture3D.wrapS = ClampToEdgeWrapping;\n\t\ttexture3D.wrapT = ClampToEdgeWrapping;\n\t\ttexture3D.wrapR = ClampToEdgeWrapping;\n\t\ttexture3D.generateMipmaps = false;\n\t\ttexture3D.needsUpdate = true;\n\n\t\treturn {\n\t\t\ttitle,\n\t\t\tsize,\n\t\t\tdomainMin,\n\t\t\tdomainMax,\n\t\t\ttexture3D,\n\t\t};\n\n\t}\n\n}\n","/* global THREE */\nimport { LUTCubeLoader } from \"three/addons/loaders/LUTCubeLoader.js\";\nimport blenderLutPath from \"../assets/blender-lut.cube\";\n\nconst WITH_LUTTONEMAPPING = !!THREE.LUTToneMapping;\n\nexport const defaultEnvironmentSettings = {\n  toneMapping: WITH_LUTTONEMAPPING ? \"LUTToneMapping\" : \"NoToneMapping\",\n  toneMappingExposure: 1,\n  backgroundColor: \"skyblue\",\n  backgroundTexture: null,\n  envMapTexture: null,\n};\n\n// const toneMappingOptions = {\n//   None: \"NoToneMapping\",\n//   Linear: \"LinearToneMapping\",\n//   Reinhard: \"ReinhardToneMapping\",\n//   Cineon: \"CineonToneMapping\",\n//   ACESFilmic: \"ACESFilmicToneMapping\",\n//   CustomToneMapping: \"CustomToneMapping\",\n//   LUTToneMapping: \"LUTToneMapping\",\n// };\n\nlet blenderLUTPromise; // lazy loaded\n\nconst updateMaterials = (scene) => {\n  scene.traverse((o) => {\n    if (o.material) o.material.needsUpdate = true;\n  });\n};\n\n// settings example without GLTFHubsComponentsExtension plugin:\n// {\n//   \"toneMapping\": \"LUTToneMapping\",\n//   \"toneMappingExposure\": 1,\n//   \"backgroundColor\": \"#ffffff\",\n//   \"backgroundTexture\": {\n//       \"__mhc_link_type\": \"texture\",\n//       \"index\": 0\n//   },\n//   \"envMapTexture\": {\n//       \"__mhc_link_type\": \"texture\",\n//       \"index\": 1\n//   }\n// }\n// With GLTFHubsComponentsExtension plugin, backgroundTexture and envMapTexture are Texture objects.\nexport function inflateEnvironmentSettings(sceneEl, settings) {\n  const scene = sceneEl.object3D;\n  const renderer = sceneEl.renderer;\n  let materialsNeedUpdate = false;\n  let newToneMapping = THREE[settings.toneMapping];\n  if (typeof newToneMapping === \"undefined\") {\n    console.warn(\n      \"You need an aframe build with the tonemappingLUT patch to make LUTToneMapping work. Falling back to NoToneMapping\"\n    );\n    newToneMapping = THREE.NoToneMapping;\n  }\n  if (renderer.toneMapping !== newToneMapping) {\n    renderer.toneMapping = newToneMapping;\n    if (newToneMapping === THREE.LUTToneMapping) {\n      if (!blenderLUTPromise) {\n        blenderLUTPromise = new Promise(function (resolve, reject) {\n          new LUTCubeLoader().load(blenderLutPath, ({ texture3D }) => resolve(texture3D), null, reject);\n        });\n      }\n\n      blenderLUTPromise\n        .then((t) => {\n          renderer.tonemappingLUT = t;\n          updateMaterials(scene);\n        })\n        .catch(function (e) {\n          console.error(\"Error loading Blender LUT\", e);\n          blenderLUTPromise = null;\n        });\n    } else {\n      renderer.tonemappingLUT = null;\n      materialsNeedUpdate = true;\n    }\n  }\n\n  renderer.toneMappingExposure = settings.toneMappingExposure;\n\n  if (settings.backgroundTexture) {\n    // Assume texture is always an equirect for now\n    settings.backgroundTexture.mapping = THREE.EquirectangularReflectionMapping;\n    // When backgroundTexture is loaded via the aframe component, flipY is true\n    // for hdr and ldr (loaded with TextureLoader that creates an img) and all is okay.\n    // When the texture is loaded from the glb, for hdr and ldr (png/jpg/webp)\n    // textures loaded with ImageBitmapLoader from GLTFLoader,\n    // flipY is false, and we need the threejs patch\n    // https://github.com/Hubs-Foundation/three.js/commit/928eb3cf7030f55eadb44d74ffd16451eda40781\n    // to flip it for ldr, but we don't want to flip it for hdr so we set it to true.\n    if (settings.backgroundTexture.userData.mimeType === \"image/vnd.radiance\") {\n      settings.backgroundTexture.flipY = true;\n    }\n    scene.background = settings.backgroundTexture;\n  } else {\n    scene.background = new THREE.Color(settings.backgroundColor);\n  }\n  if (settings.envMapTexture) {\n    // if (this.prevEnvMapTextureUUID !== settings.envMapTexture.uuid) {\n    // this.prevEnvMapTextureUUID = settings.envMapTexture.uuid;\n    // TODO PMREMGenerator should be fixed to not assume this\n    settings.envMapTexture.flipY = true;\n    // Assume texture is always an equirect for now\n    settings.envMapTexture.mapping = THREE.EquirectangularReflectionMapping;\n    scene.environment = settings.envMapTexture;\n    // }\n    // } else if (settings.skybox) {\n    //   if (this.prevEnvMapTextureUUID !== settings.skybox.uuid) {\n    //     this.prevEnvMapTextureUUID = settings.skybox.uuid;\n    //     this.scene.environment = settings.skybox.sky.generateEnvironmentMap(this.renderer);\n    //   }\n  } else {\n    scene.environment = null;\n    // this.prevEnvMapTextureUUID = null;\n  }\n\n  if (materialsNeedUpdate) {\n    updateMaterials(scene);\n  }\n}\n","import { absoluteURLForAsset, createEntityAndReparent } from \"./utils\";\n\nexport function inflateMediaImage(node, componentProps, otherComponents) {\n  componentProps.src = absoluteURLForAsset(componentProps.src);\n  const el = createEntityAndReparent(node);\n  el.classList.add(\"mediaimage\");\n  el.classList.add(node.name); // to view it in the editor\n\n  // Set networked component first, media-image is getting the networkId from networked component\n  el.setAttribute(\"networked\", {\n    template: \"#media-template\",\n    attachTemplateToLocal: false,\n    networkId: otherComponents.networked.id,\n    persistent: true,\n    owner: \"scene\",\n  });\n  el.setAttribute(\"media-image\", componentProps);\n\n  return el;\n}\n","import { absoluteURLForAsset, createEntityAndReparent } from \"./utils\";\n\nexport function inflateMediaVideo(node, componentProps, otherComponents) {\n  componentProps.src = absoluteURLForAsset(componentProps.src);\n  const el = createEntityAndReparent(node);\n  el.classList.add(\"mediavideo\");\n  el.classList.add(node.name); // to view it in the editor\n\n  // Set networked component first, media-video is getting the networkId from networked component\n  el.setAttribute(\"networked\", {\n    template: \"#media-template\",\n    attachTemplateToLocal: false,\n    networkId: otherComponents.networked.id,\n    persistent: true,\n    owner: \"scene\",\n  });\n  el.setAttribute(\"media-video\", componentProps);\n\n  return el;\n}\n","import { inflateMediaImage } from \"./media-image\";\nimport { inflateMediaVideo } from \"./media-video\";\n\n// Example in `objects.gltf`:\n\n// ```json\n//   {\n//     \"translation\": [\n//       -6.264312744140625,\n//       -0.7287607192993164,\n//       28.872106552124023\n//     ],\n//     \"scale\": [\n//       5.6425134124436225,\n//       5.642513440854807,\n//       5.642513439416321\n//     ],\n//     \"rotation\": [\n//       -0.06519320126696304,\n//       0.7125317521233958,\n//       0.6954044762629629,\n//       0.06679043852278975\n//     ],\n//     \"name\": \"e6uyuow\",\n//     \"extensions\": {\n//       \"HUBS_components\": {\n//         \"pinnable\": {\n//           \"pinned\": true\n//         },\n//         \"media\": {\n//           \"version\": 1,\n//           \"src\": \"https://uploads-prod.reticulum.io/files/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.jpg?token=536c829011e6cdd6d6cd8a0ff6439f0f\",\n//           \"id\": \"e6uyuow\",\n//           \"contentSubtype\": null\n//         }\n//       }\n//     }\n//   }\n// ```\n\nconst images = [\"png\", \"jpg\", \"jpeg\", \"gif\", \"webp\", \"avif\", \"ktx2\"];\nconst videos = [\"mp4\", \"webm\"];\n\nexport function inflateMedia(node, componentProps, otherComponents) {\n  const ext = componentProps.src.split(\".\").pop().toLowerCase().split(\"?\")[0];\n  if (ext === \"glb\") {\n    console.warn(\"GLB files are not supported yet\");\n    return null;\n    // return inflateMediaGLB(node, componentProps, {networked: {id: componentProps.id}});\n  } else if (videos.includes(ext)) {\n    return inflateMediaVideo(node, componentProps, { networked: { id: componentProps.id } });\n  } else if (images.includes(ext)) {\n    return inflateMediaImage(node, componentProps, { networked: { id: componentProps.id } });\n  }\n  return null;\n}\n","import { createEntityAndReparent } from \"./utils\";\n\nexport function inflateWaypoint(node, componentProps, otherComponents) {\n  const el = createEntityAndReparent(node);\n  el.id = node.name;\n  inflateWaypointFromJSON(el, componentProps, otherComponents);\n  return el;\n}\n\nexport function inflateWaypointFromJSON(el, componentProps, otherComponents) {\n  const networkId = otherComponents?.networked?.id ?? el.id ?? \"\";\n  if (componentProps.canBeOccupied) {\n    el.setAttribute(\"networked\", {\n      template: \"#waypoint-template\",\n      attachTemplateToLocal: false,\n      networkId: networkId,\n      persistent: true,\n      owner: \"scene\",\n    });\n  }\n\n  el.setAttribute(\"waypoint\", componentProps);\n}\n","import { inflateAudio } from \"./audio\";\nimport { inflateAudioParams } from \"./audio-params\";\nimport { inflateBillboard } from \"./billboard\";\nimport { inflateEnvironmentSettings } from \"./environment-settings\";\nimport { inflateLink } from \"./link\";\nimport { inflateMediaFrame } from \"./media-frame\";\nimport { inflateMedia } from \"./media\";\nimport { inflateMediaImage } from \"./media-image\";\nimport { inflateMediaVideo } from \"./media-video\";\nimport { inflateNavMesh } from \"./nav-mesh\";\nimport { inflateParticleEmitter } from \"./particle-emitter\";\nimport { inflateReflectionProbe } from \"./reflection-probe\";\nimport { inflateSimpleWater } from \"./simple-water\";\nimport { inflateSpawnPoint } from \"./spawn-point\";\nimport { inflateText } from \"./text\";\nimport { inflateUVScroll } from \"./uv-scroll\";\nimport { inflateWaypoint, inflateWaypointFromJSON } from \"./waypoint\";\n\nexport const gltfInflators = new Map();\ngltfInflators.set(\"audio\", inflateAudio);\ngltfInflators.set(\"audio-params\", inflateAudioParams);\ngltfInflators.set(\"billboard\", inflateBillboard);\ngltfInflators.set(\"environment-settings\", inflateEnvironmentSettings);\ngltfInflators.set(\"link\", inflateLink);\ngltfInflators.set(\"media-frame\", inflateMediaFrame);\ngltfInflators.set(\"media\", inflateMedia);\ngltfInflators.set(\"image\", inflateMediaImage);\ngltfInflators.set(\"video\", inflateMediaVideo);\ngltfInflators.set(\"nav-mesh\", inflateNavMesh);\ngltfInflators.set(\"particle-emitter\", inflateParticleEmitter);\ngltfInflators.set(\"reflection-probe\", inflateReflectionProbe);\ngltfInflators.set(\"spawn-point\", inflateSpawnPoint);\ngltfInflators.set(\"simple-water\", inflateSimpleWater);\ngltfInflators.set(\"text\", inflateText);\ngltfInflators.set(\"uv-scroll\", inflateUVScroll);\ngltfInflators.set(\"waypoint\", inflateWaypoint);\n\nexport const jsonInflators = new Map();\njsonInflators.set(\"waypoint\", inflateWaypointFromJSON);\n","import { absoluteURLForAsset, addComponent } from \"./utils\";\n\nexport function inflateAudio(node, componentProps, otherComponents) {\n  // In some cases in Hubs GLBs, the audio-params component is not present,\n  // and the audio component has the audio parameters directly.\n  // In audio-params component, volume is called gain.\n  const hasAudioParams = typeof otherComponents[\"audio-params\"] !== \"undefined\";\n  const audioParams = otherComponents[\"audio-params\"] || componentProps;\n\n  // Set properties.\n  const audioProps = {\n    autoplay: componentProps.autoPlay,\n    distanceModel: audioParams.distanceModel,\n    loop: componentProps.loop,\n    maxDistance: audioParams.maxDistance,\n    positional: audioParams.audioType !== \"stereo\",\n    refDistance: audioParams.refDistance,\n    rolloffFactor: audioParams.rolloffFactor,\n    src: absoluteURLForAsset(componentProps.src),\n    volume: hasAudioParams ? audioParams.gain : audioParams.volume * 3,\n  };\n\n  addComponent(node, \"sound\", audioProps);\n}\n","export function inflateAudioParams(node, componentProps, otherComponents) {\n  // Do nothing, audio-params are handled in the audio inflator.\n}\n","import { addComponent } from \"./utils\";\n\nexport function inflateBillboard(node, componentProps, otherComponents) {\n  addComponent(node, \"billboard\", componentProps);\n}\n","export function inflateLink(node, componentProps, otherComponents) {\n  const sceneEl = node.el.sceneEl;\n  // We need the node closest mesh to be a real entity with class clickable for raycaster to work\n  let parent = node;\n  while (!parent.isMesh) {\n    parent = node.parent;\n  }\n\n  const el = document.createElement(\"a-entity\");\n  sceneEl.appendChild(el);\n  el.setObject3D(\"mesh\", parent);\n  el.classList.add(parent.name);\n  el.classList.add(\"clickable\");\n  el.setAttribute(\"open-link\", componentProps);\n  return el;\n}\n","import { createEntityAndReparent } from \"./utils\";\n\nexport function inflateMediaFrame(node, componentProps, otherComponents) {\n  const el = createEntityAndReparent(node);\n  el.classList.add(\"mediaframe\");\n  el.classList.add(node.name); // to view it in the editor\n\n  // Set networked component first, media-frame is getting the networkId from networked component\n  el.setAttribute(\"networked\", {\n    template: \"#media-template\",\n    attachTemplateToLocal: false,\n    networkId: otherComponents.networked.id,\n    persistent: true,\n    owner: \"scene\",\n  });\n  el.setAttribute(\"video-texture-target\", {});\n  el.setAttribute(\"media-frame\", componentProps);\n\n  return el;\n}\n","export function inflateNavMesh(node, componentProps, otherComponents) {\n  const sceneEl = node.el.sceneEl;\n\n  const el = document.createElement(\"a-entity\");\n  // Very important, add the class before appendChild.\n  // The blink-controls component is using the child-attached event and will do a\n  // evt.detail.el.matches(data.collisionEntities)) check,\n  // so el.matches('.navmesh') before adding the element to collisionEntities array.\n  el.classList.add(\"navmesh\");\n  el.setAttribute(\"nav-mesh\", \"\");\n  sceneEl.appendChild(el);\n  el.setObject3D(\"mesh\", node);\n\n  return el;\n}\n","import { absoluteURLForAsset, addComponent } from \"./utils\";\n\nexport function inflateParticleEmitter(node, componentProps, otherComponents) {\n  componentProps.src = absoluteURLForAsset(componentProps.src);\n\n  addComponent(node, \"particle-emitter\", componentProps);\n}\n","/* global THREE */\nimport { addComponent } from \"./utils\";\n\nexport function inflateReflectionProbe(node, componentProps, otherComponents) {\n  if (typeof THREE.ReflectionProbe === \"undefined\") {\n    console.error(\"You need an aframe build with the ReflectionProbe patch to make reflection probes work.\");\n    return;\n  }\n  // TODO PMREMGenerator should be fixed to not assume this\n  componentProps.envMapTexture.flipY = true;\n  // Assume texture is always an equirect for now\n  componentProps.envMapTexture.mapping = THREE.EquirectangularReflectionMapping;\n  addComponent(node, \"reflection-probe\", componentProps);\n}\n","// For very old scenes having a spawn-point component\nimport { createEntityAndReparent } from \"./utils\";\n\nexport function inflateSpawnPoint(node, componentProps, otherComponents) {\n  const el = createEntityAndReparent(node);\n  el.setAttribute(\"waypoint\", {\n    canBeSpawnPoint: true,\n  });\n  return el;\n}\n","export function inflateSimpleWater(node, componentProps, otherComponents) {\n  const sceneEl = node.el.sceneEl;\n  const el = document.createElement(\"a-entity\");\n  el.classList.add(node.name); // to view it in the editor\n  el.setAttribute(\"simple-water\", componentProps);\n  el.object3D.position.copy(node.position);\n  el.object3D.quaternion.copy(node.quaternion);\n  el.object3D.scale.copy(node.scale);\n  sceneEl.appendChild(el);\n  if (node.isMesh) {\n    node.geometry.dispose();\n    node.material.dispose();\n  }\n  node.removeFromParent();\n  return el;\n}\n","/* global AFRAME */\nimport { createEntityAndReparent } from \"./utils\";\n\nexport function inflateText(node, componentProps, otherComponents) {\n  const componentName = \"troika-text\";\n  if (!AFRAME.components[componentName]) {\n    console.error(`Component ${componentName} not registered`);\n    return;\n  }\n\n  const el = createEntityAndReparent(node);\n  el.classList.add(node.name);\n\n  // Rename the Hubs properties for the baseline settings.\n  switch (componentProps.anchorY) {\n    case \"middle\":\n      componentProps.anchorY = \"center\";\n      break;\n\n    case \"bottom\":\n    case \"bottom-baseline\":\n      componentProps.anchorY = \"bottom\";\n      break;\n\n    case \"top\":\n    case \"top-baseline\":\n      componentProps.anchorY = \"top\";\n      break;\n  }\n\n  // Set different property names.\n  const textProps = {\n    align: componentProps.textAlign,\n    anchor: componentProps.anchorX,\n    baseline: componentProps.anchorY,\n    ...componentProps,\n  };\n\n  // Remove properties not handled or different in A-Frame troika-text.\n  delete textProps.textAlign;\n  delete textProps.anchorX;\n  delete textProps.anchorY;\n  delete textProps.anchorY;\n  delete textProps.opacity;\n  delete textProps.side;\n\n  el.setAttribute(\"troika-text\", textProps);\n\n  // Set opacity if the value is not \"1.0\".\n  // The \"troika-text-material\" setAttribute only works\n  // when the attribute is a string. The object creates an error.\n  let opacityProp = \"\";\n  if (componentProps.opacity !== 1.0) {\n    opacityProp = \"opacity: \" + componentProps.opacity + \"; transparent: true;\";\n  }\n\n  el.setAttribute(\"troika-text-material\", \"side: \" + componentProps.side + \"; \" + opacityProp);\n\n  // This code throws an error.\n  // const materialProps = {side: componentProps.side};\n  // if (componentProps.opacity !== 1.0) {\n  //   materialProps.opacity = componentProps.opacity\n  //   materialProps.transparent = true\n  // }\n\n  // el.setAttribute(\"troika-text-material\", materialProps);\n  // el.setAttribute(\"material\", materialProps);\n\n  return el;\n}\n","import { addComponent } from \"./utils\";\nimport { FakeEntity } from \"../components/FakeEntity\";\n\nexport function inflateUVScroll(node, componentProps, otherComponents) {\n  // set the node (plane geometry) as the 'mesh' first\n  node.fakeEl = new FakeEntity(node);\n  node.fakeEl.setObject3D(\"mesh\", node);\n  // then add uv-scroll that uses getObject3D(\"mesh\")\n  addComponent(node, \"uv-scroll\", componentProps);\n}\n","/* global AFRAME, THREE */\nimport { RGBELoader } from \"three/addons/loaders/RGBELoader.js\";\nimport { gltfInflators } from \"../inflators\";\nimport { absoluteURLForAsset } from \"../inflators/utils\";\n\nconst HDR_FILE_RE = /\\.hdr$/;\n\n// same defaults as the defaultEnvironmentSettings function\nAFRAME.registerComponent(\"environment-settings\", {\n  schema: {\n    toneMapping: {\n      type: \"string\",\n      default: \"LUTToneMapping\",\n      oneOf: [\n        \"NoToneMapping\",\n        \"LinearToneMapping\",\n        \"ReinhardToneMapping\",\n        \"CineonToneMapping\",\n        \"ACESFilmicToneMapping\",\n        \"CustomToneMapping\",\n        \"AgXToneMapping\",\n        \"NeutralToneMapping\",\n        \"LUTToneMapping\",\n      ],\n    },\n    toneMappingExposure: {\n      type: \"number\",\n      default: 1,\n    },\n    backgroundTexture: {\n      type: \"string\",\n      default: \"\",\n    },\n    backgroundColor: {\n      type: \"color\",\n      default: \"skyblue\",\n    },\n    envMapTexture: {\n      type: \"string\",\n      default: \"\",\n    },\n  },\n  init() {\n    (async () => {\n      let backgroundTexture = null;\n      if (this.data.backgroundTexture) {\n        const backgroundTextureUrl = absoluteURLForAsset(this.data.backgroundTexture);\n        const isHDR = HDR_FILE_RE.test(backgroundTextureUrl);\n        let loader;\n        if (isHDR) {\n          loader = new RGBELoader().setDataType(THREE.HalfFloatType);\n        } else {\n          loader = new THREE.TextureLoader();\n        }\n\n        loader.setWithCredentials(false);\n        backgroundTexture = await new Promise((resolve, reject) =>\n          loader.load(backgroundTextureUrl, resolve, undefined, reject)\n        );\n        if (\n          backgroundTexture.minFilter === THREE.NearestMipmapNearestFilter ||\n          backgroundTexture.minFilter === THREE.NearestMipmapLinearFilter\n        ) {\n          backgroundTexture.minFilter = THREE.NearestFilter;\n        } else if (\n          backgroundTexture.minFilter === THREE.LinearMipmapNearestFilter ||\n          backgroundTexture.minFilter === THREE.LinearMipmapLinearFilter\n        ) {\n          backgroundTexture.minFilter = THREE.LinearFilter;\n        }\n\n        if (!isHDR) {\n          backgroundTexture.colorSpace = THREE.SRGBColorSpace;\n        }\n      }\n\n      let envMapTexture = null;\n      if (this.data.envMapTexture) {\n        const envMapTextureUrl = absoluteURLForAsset(this.data.envMapTexture);\n        const isHDR = HDR_FILE_RE.test(envMapTextureUrl);\n        let loader;\n        if (isHDR) {\n          loader = new RGBELoader().setDataType(THREE.HalfFloatType);\n        } else {\n          loader = new THREE.TextureLoader();\n        }\n\n        loader.setWithCredentials(false);\n        envMapTexture = await new Promise((resolve, reject) =>\n          loader.load(envMapTextureUrl, resolve, undefined, reject)\n        );\n        if (\n          envMapTexture.minFilter === THREE.NearestMipmapNearestFilter ||\n          envMapTexture.minFilter === THREE.NearestMipmapLinearFilter\n        ) {\n          envMapTexture.minFilter = THREE.NearestFilter;\n        } else if (\n          envMapTexture.minFilter === THREE.LinearMipmapNearestFilter ||\n          envMapTexture.minFilter === THREE.LinearMipmapLinearFilter\n        ) {\n          envMapTexture.minFilter = THREE.LinearFilter;\n        }\n\n        if (!isHDR) {\n          envMapTexture.colorSpace = THREE.SRGBColorSpace;\n        }\n      }\n\n      const settings = {\n        toneMapping: this.data.toneMapping,\n        toneMappingExposure: this.data.toneMappingExposure,\n        backgroundTexture: backgroundTexture,\n        backgroundColor: this.data.backgroundColor,\n        envMapTexture: envMapTexture,\n      };\n      gltfInflators.get(\"environment-settings\")(this.el.sceneEl, settings);\n    })();\n  },\n});\n","/* global AFRAME, THREE */\nimport { RGBELoader } from \"three/addons/loaders/RGBELoader.js\";\nimport { defaultEnvironmentSettings } from \"../inflators/environment-settings\";\nimport { gltfInflators } from \"../inflators\";\n\nclass GLTFMozTextureRGBE {\n  constructor(parser, loader) {\n    this.parser = parser;\n    this.loader = loader;\n    this.name = \"MOZ_texture_rgbe\";\n  }\n\n  loadTexture(textureIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const textureDef = json.textures[textureIndex];\n\n    if (!textureDef.extensions || !textureDef.extensions[this.name]) {\n      return null;\n    }\n\n    const extensionDef = textureDef.extensions[this.name];\n    const source = extensionDef.source;\n\n    return parser\n      .loadTextureImage(textureIndex, source, this.loader)\n      .then((t) => {\n        // TODO pretty severe artifacting when using mipmaps, disable for now\n        if (t.minFilter === THREE.NearestMipmapNearestFilter || t.minFilter === THREE.NearestMipmapLinearFilter) {\n          t.minFilter = THREE.NearestFilter;\n        } else if (t.minFilter === THREE.LinearMipmapNearestFilter || t.minFilter === THREE.LinearMipmapLinearFilter) {\n          t.minFilter = THREE.LinearFilter;\n        }\n        return t;\n      })\n      .catch((error) => {\n        console.error(\"issue while loading hdr texture\", error);\n      });\n  }\n}\n\nexport function mapMaterials(object3D, fn) {\n  if (!object3D.material) return [];\n\n  if (Array.isArray(object3D.material)) {\n    return object3D.material.map(fn);\n  } else {\n    return [fn(object3D.material)];\n  }\n}\n\nclass GLTFHubsComponentsExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_hubs_components\";\n  }\n\n  afterRoot({ scenes, parser }) {\n    const deps = [];\n\n    const resolveComponents = (gltfRootType, obj) => {\n      const idx = parser.associations.get(obj)?.[gltfRootType];\n      // parser.associations.get(obj) will be undefined if you have two scenes in the gltf because of\n      // parser.associations = reduceAssociations( scene );\n      // line causing parser.associations to be cleaned when loading the second scene.\n      // https://github.com/mrdoob/three.js/blob/c965d3b5dcab2575d6a73aec583c29fa44c0c60d/examples/jsm/loaders/GLTFLoader.js#L4373\n      // console.log(obj.name, parser.associations.get(obj), gltfRootType, idx, parser.json[gltfRootType][idx]);\n      // Empty undefined nodes undefined undefined\n      // Be sure to export with \"Include / Active Scene\" checked in blender to have only one scene in the gltf\n      if (idx === undefined) return;\n      const ext = parser.json[gltfRootType][idx].extensions?.[this.name];\n\n      if (!ext) return;\n      // console.log(obj.name, { ext });\n\n      // TODO putting this into userData is a bit silly, we should just inflate here, but entities need to be inflated first...\n      obj.userData.gltfExtensions = Object.assign(obj.userData.gltfExtensions || {}, {\n        MOZ_hubs_components: ext,\n      });\n\n      for (const componentName in ext) {\n        const props = ext[componentName];\n        for (const propName in props) {\n          const value = props[propName];\n          const type = value?.__mhc_link_type;\n          if (type && value.index !== undefined) {\n            deps.push(\n              parser.getDependency(type, value.index).then((loadedDep) => {\n                // TODO similar to above, this logic being spread out in multiple places is not great...\n                // Node refences are assumed to always be in the scene graph. These referneces are late-resolved in inflateComponents\n                // otherwise they will need to be updated when cloning (which happens as part of caching).\n                if (type === \"node\") return;\n\n                if (type === \"texture\" && !parser.json.textures[value.index].extensions?.MOZ_texture_rgbe) {\n                  // For now assume all non HDR textures linked in hubs components are sRGB.\n                  // We can allow this to be overriden later if needed\n                  loadedDep.colorSpace = THREE.SRGBColorSpace;\n                }\n\n                props[propName] = loadedDep;\n\n                return loadedDep;\n              })\n            );\n          }\n        }\n      }\n    };\n\n    // object.userData.gltfExtensions.MOZ_hubs_components is not set because we have a plugin registered for MOZ_hubs_components\n    // https://github.com/mrdoob/three.js/blob/c965d3b5dcab2575d6a73aec583c29fa44c0c60d/examples/jsm/loaders/GLTFLoader.js#L2330-L2335\n    // called here\n    // https://github.com/mrdoob/three.js/blob/c965d3b5dcab2575d6a73aec583c29fa44c0c60d/examples/jsm/loaders/GLTFLoader.js#L4264\n    // that's why we traverse all scenes, nodes, materials to set MOZ_hubs_components\n    // Actually we're only interested by transforming envMapTexture and backgroundTexture for scene MOZ_hubs_components.environment-settings\n    // and reflection probes textures\n    for (let i = 0; i < scenes.length; i++) {\n      // TODO this should be done by GLTLoader\n      parser.associations.set(scenes[i], { scenes: i });\n      scenes[i].traverse((obj) => {\n        resolveComponents(\"scenes\", obj);\n        resolveComponents(\"nodes\", obj);\n        mapMaterials(obj, resolveComponents.bind(this, \"materials\"));\n      });\n    }\n\n    return Promise.all(deps);\n  }\n}\n\nclass GLTFHubsLightMapExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_lightmap\";\n  }\n\n  // @TODO: Ideally we should use extendMaterialParams hook.\n  //        But the current official glTF loader doesn't fire extendMaterialParams\n  //        hook for unlit and specular-glossiness materials.\n  //        So using loadMaterial hook as workaround so far.\n  //        Cons is loadMaterial hook is fired as _invokeOne so\n  //        if other plugins defining loadMaterial is registered\n  //        there is a chance that this light map extension handler isn't called.\n  //        The glTF loader should be updated to remove the limitation.\n  loadMaterial(materialIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const materialDef = json.materials[materialIndex];\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return null;\n    }\n\n    const extensionDef = materialDef.extensions[this.name];\n\n    const pending = [];\n    pending.push(parser.loadMaterial(materialIndex));\n    pending.push(parser.getDependency(\"texture\", extensionDef.index));\n\n    return Promise.all(pending)\n      .then((results) => {\n        const material = results[0];\n        const lightMap = results[1];\n        // Lightmap channel used to be hardcoded in threejs. We now\n        // need to specify it. Hubs models always use channel 1.\n        lightMap.channel = 1;\n        material.lightMap = lightMap;\n        material.lightMapIntensity = extensionDef.intensity !== undefined ? extensionDef.intensity : 1;\n        if (material.isMeshBasicMaterial) {\n          material.lightMapIntensity *= Math.PI;\n        }\n        return material;\n      })\n      .catch((error) => {\n        console.error(\"issue while loading MOZ_lightmap material\", error);\n      });\n  }\n}\n\nfunction disposeTextures(material) {\n  // Explicitly dispose any textures assigned to this material\n  for (const propertyName in material) {\n    const texture = material[propertyName];\n    if (texture instanceof THREE.Texture) {\n      const image = texture.source.data;\n      if (image instanceof ImageBitmap) {\n        image.close && image.close();\n      }\n      texture.dispose();\n    }\n  }\n}\n\nexport function disposeNode(node) {\n  if (node.fakeEl) {\n    node.fakeEl.destroy();\n  }\n  if (node instanceof THREE.Mesh) {\n    const geometry = node.geometry;\n    if (geometry) {\n      geometry.dispose();\n    }\n\n    const material = node.material;\n    if (material) {\n      if (Array.isArray(material)) {\n        for (let i = 0, l = material.length; i < l; i++) {\n          const m = material[i];\n          disposeTextures(m);\n          m.dispose();\n        }\n      } else {\n        disposeTextures(material);\n        material.dispose(); // disposes any programs associated with the material\n      }\n    }\n  }\n}\nexport const gltfModelPlus = {\n  schema: { type: \"model\" },\n\n  init: function () {\n    const self = this;\n    const dracoLoader = this.el.sceneEl.systems[\"gltf-model\"].getDRACOLoader();\n    const meshoptDecoder = this.el.sceneEl.systems[\"gltf-model\"].getMeshoptDecoder();\n    const ktxLoader = this.el.sceneEl.systems[\"gltf-model\"].getKTX2Loader();\n    this.model = null;\n    this.removers = [];\n    this.loader = new THREE.GLTFLoader();\n    this.mixer = null;\n    this.loader\n      .register((parser) => new GLTFHubsComponentsExtension(parser))\n      .register((parser) => new GLTFHubsLightMapExtension(parser))\n      .register((parser) => new GLTFMozTextureRGBE(parser, new RGBELoader().setDataType(THREE.HalfFloatType)));\n    if (dracoLoader) {\n      this.loader.setDRACOLoader(dracoLoader);\n    }\n    if (meshoptDecoder) {\n      this.ready = meshoptDecoder.then(function (meshoptDecoder) {\n        self.loader.setMeshoptDecoder(meshoptDecoder);\n      });\n    } else {\n      this.ready = Promise.resolve();\n    }\n    if (ktxLoader) {\n      this.loader.setKTX2Loader(ktxLoader);\n    }\n  },\n\n  update: function () {\n    const self = this;\n    const el = this.el;\n    const src = this.data;\n\n    this.remove();\n\n    if (!src) {\n      return;\n    }\n\n    el.sceneEl.systems.waypoint.glbLoading += 1;\n    console.log(\"[wp] increment glbLoading\", el.sceneEl.systems.waypoint.glbLoading);\n    this.ready.then(function () {\n      self.el.emit(\"model-loading\", { src });\n      self.loader.load(\n        src,\n        function gltfLoaded(gltfModel) {\n          el.emit(\"model-downloaded\");\n          self.model = gltfModel.scene || gltfModel.scenes[0];\n          self.model.animations = gltfModel.animations;\n          el.setObject3D(\"mesh\", self.model);\n\n          // Handle Hubs components\n          const animations = gltfModel.animations;\n          const finalizers = [];\n          let environmentSettings = null;\n          gltfModel.scene.traverse((node) => {\n            if (node.isMesh) {\n              node.reflectionProbeMode = \"static\";\n            }\n\n            // In objects.gltf, it's HUBS_components\n            const hubsComponents =\n              node.userData.gltfExtensions?.MOZ_hubs_components ?? node.userData.gltfExtensions?.HUBS_components;\n            if (hubsComponents) {\n              const srcForLogging = src.startsWith(\"data:\") ? \"data:application/octet-stream;base64,...\" : src;\n              console.log(srcForLogging, hubsComponents, node.name);\n              Object.entries(hubsComponents).forEach(([componentName, componentProps]) => {\n                if (componentName === \"environment-settings\") {\n                  environmentSettings = componentProps;\n                } else if (componentName === \"visible\") {\n                  node.visible = componentProps.visible;\n                } else if (componentName === \"networked\") {\n                  // ignore, handled in other inflators\n                } else if (componentName === \"loop-animation\") {\n                  if (!self.mixer) {\n                    self.mixer = new THREE.AnimationMixer(gltfModel.scene);\n                    // add tick\n                    self.tick = function (t, dt) {\n                      if (self.mixer && !isNaN(dt)) self.mixer.update(dt / 1000);\n                    };\n                    self.el.sceneEl.addBehavior(self);\n                  }\n                  const activeClipIndices = componentProps.activeClipIndices;\n                  let clips = [];\n                  if (activeClipIndices && activeClipIndices.length > 0) {\n                    // Support for Spoke->Hubs activeClipIndices struct\n                    clips = activeClipIndices.map((index) => animations[index]);\n                  } else {\n                    // Support for Blender imports with { clip: 'train', paused: false} struct.\n                    const clipName = componentProps.clip;\n                    if (clipName !== \"\") {\n                      const clipNames = clipName.split(\",\");\n                      for (let i = 0; i < clipNames.length; i++) {\n                        const n = clipNames[i];\n                        const a = animations.find(({ name }) => name === n);\n                        if (a) {\n                          // Add the Hubs defined componentProps, we need them later.\n                          a.componentProps = componentProps;\n                          clips.push(a);\n                        } else {\n                          console.warn(`Could not find animation named '${n}'`);\n                        }\n                      }\n                    }\n                  }\n\n                  for (const clip of clips) {\n                    const action = self.mixer.clipAction(clip, node);\n                    action.enabled = true;\n                    // If timeScale is set, use it.\n                    if (typeof clip.componentProps?.timeScale !== \"undefined\" && clip.componentProps?.timeScale !== 1) {\n                      action.timeScale = clip.componentProps.timeScale;\n                    }\n                    // If startOffset is set, use it.\n                    if (\n                      typeof clip.componentProps?.startOffset !== \"undefined\" &&\n                      clip.componentProps?.startOffset !== 0\n                    ) {\n                      action.time = clip.componentProps.startOffset;\n                    }\n                    action.setLoop(THREE.LoopRepeat, Infinity).play();\n                  }\n                } else {\n                  const inflator = gltfInflators.get(componentName);\n                  if (inflator) {\n                    // Create entity and move node to a different parent when we're done traversing the scene\n                    finalizers.push(() => {\n                      const entity = inflator(node, componentProps, hubsComponents);\n                      if (entity) {\n                        self.removers.push(() => {\n                          entity.object3D.traverse(disposeNode);\n                          if (entity.parentNode) entity.parentNode.removeChild(entity);\n                        });\n                      }\n                    });\n                  } else {\n                    if (componentName !== \"pinnable\") {\n                      console.warn(`Unknown Hubs component '${componentName}'`);\n                    }\n                  }\n                }\n              });\n            }\n          });\n\n          // Need to be decremented before executing finalizers that create waypoints\n          el.sceneEl.systems.waypoint.glbLoading -= 1;\n          console.log(\"[wp] decrement glbLoading\", el.sceneEl.systems.waypoint.glbLoading);\n          // We still need to call scheduleEmitWaypointsReady() in case there is no waypoints\n          // in the glb but we defined waypoints with a-waypoint primitive.\n          el.sceneEl.systems.waypoint.scheduleEmitWaypointsReady();\n\n          for (let i = 0; i < finalizers.length; i++) {\n            finalizers[i]();\n          }\n          finalizers.length = 0;\n\n          if (!environmentSettings) {\n            environmentSettings = defaultEnvironmentSettings;\n          }\n\n          el.emit(\"model-loaded\", { format: \"gltf\", model: self.model, environmentSettings });\n\n          // el could be a FakeEntity if we aliased gtlf-model to gtlf-model-plus, so we check classList is not undefined\n          if (el.classList?.contains(\"environment-settings\")) {\n            gltfInflators.get(\"environment-settings\")(el.sceneEl, environmentSettings);\n            // Clear the cache after successfully loaded the glb to free some memory\n            THREE.Cache.clear();\n          }\n\n          setTimeout(() => {\n            el.sceneEl.renderer.shadowMap.needsUpdate = true;\n          }, 2000);\n        },\n        function onProgress(evt) {\n          el.emit(\"progress\", { originalEvent: evt });\n        },\n        function gltfFailed(error) {\n          el.emit(\"model-downloaded\");\n          console.error(error, src);\n          const message = error && error.message ? error.message : \"Failed to load glTF model\";\n          console.warn(message);\n          el.emit(\"model-error\", { format: \"gltf\", src: src });\n        }\n      );\n    });\n  },\n\n  remove: function () {\n    if (!this.model) {\n      return;\n    }\n\n    if (this.mixer) {\n      this.mixer.stopAllAction();\n      this.mixer = null;\n      // remove tick\n      this.el.sceneEl.removeBehavior(this);\n      this.tick = undefined;\n    }\n\n    for (let i = 0; i < this.removers.length; i++) {\n      this.removers[i]();\n    }\n    this.removers.length = 0;\n\n    this.el.removeObject3D(\"mesh\");\n    this.model.traverse(disposeNode);\n    this.model = null;\n  },\n};\n\nAFRAME.registerComponent(\"gltf-model-plus\", gltfModelPlus);\n","/* global AFRAME, NAF */\nfunction addMediaFrameTemplate() {\n  const templateOuter = document.createElement(\"template\");\n  const templateInner = document.createElement(\"a-entity\");\n  templateOuter.id = `media-template`;\n  templateOuter.appendChild(templateInner);\n  const refTemplateId = `#${templateOuter.id}`;\n  NAF.schemas.schemaDict[refTemplateId] = {\n    template: refTemplateId,\n    components: [\"position\", \"rotation\", \"scale\", \"video-texture-target\"],\n  };\n  NAF.schemas.templateCache[refTemplateId] = templateOuter;\n}\n\nconst WITH_NAF = !!window.NAF;\nif (WITH_NAF) {\n  addMediaFrameTemplate();\n}\n\nconst registeredMediaframes = [];\nconst mediaFramesById = new Map();\n\nAFRAME.registerSystem(\"media-frame\", {\n  getClosestMediaFrame: function (filterByMediaType) {\n    let mediaFrames = registeredMediaframes;\n    if (filterByMediaType && filterByMediaType !== \"all\") {\n      if (filterByMediaType === \"all-2d\") {\n        mediaFrames = mediaFrames.filter((mediaFrame) => {\n          const mediaType = mediaFrame.component.data.mediaType;\n          return mediaType !== \"model\";\n        });\n      } else {\n        if (filterByMediaType === \"model\") {\n          mediaFrames = mediaFrames.filter((mediaFrame) => {\n            const mediaType = mediaFrame.component.data.mediaType;\n            return mediaType === filterByMediaType || mediaType === \"all\";\n          });\n        } else {\n          mediaFrames = mediaFrames.filter((mediaFrame) => {\n            const mediaType = mediaFrame.component.data.mediaType;\n            return mediaType === filterByMediaType || mediaType === \"all\" || mediaType === \"all-2d\";\n          });\n        }\n      }\n    }\n    const cameraRigPosition = document.querySelector(\"#rig,#cameraRig\").object3D.position;\n    // Note: assumption that object3D.position is global world coordinate here\n    mediaFrames.sort((a, b) => {\n      if (a.el.object3D.position.distanceTo(cameraRigPosition) < b.el.object3D.position.distanceTo(cameraRigPosition)) {\n        return -1;\n      }\n      return 1;\n    });\n    if (mediaFrames.length > 0) {\n      return mediaFrames[0];\n    }\n    return document.getElementById(\"screenshare\"); // TODO remove this hard coded value\n  },\n  getMediaFrameById(id) {\n    const mediaFrame = mediaFramesById.get(id);\n    if (!mediaFrame) return document.getElementById(\"screenshare\"); // TODO remove this hard coded value\n    return mediaFrame.el;\n  },\n});\n\n/**\n * Define a location where you can put 2d or 3d elements\n * @component media-frame\n */\nexport const mediaFrameComponent = AFRAME.registerComponent(\"media-frame\", {\n  schema: {\n    bounds: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    mediaType: { type: \"string\", oneOf: [\"all\", \"all-2d\", \"model\", \"image\", \"video\", \"pdf\"], default: \"all-2d\" },\n    snapToCenter: { type: \"boolean\", default: true },\n  },\n  play() {\n    const id = WITH_NAF ? this.el.components.networked.data.networkId : this.el.id;\n    const instance = { component: this, el: this.el, id };\n    this.instance = instance;\n    mediaFramesById.set(id, instance);\n    registeredMediaframes.push(instance);\n  },\n\n  pause() {\n    mediaFramesById.delete(this.instance.id);\n    registeredMediaframes.splice(registeredMediaframes.indexOf(this.instance), 1);\n  },\n});\n","/* global AFRAME, THREE */\nimport errorImageSrc from \"../assets/media-error.png\";\n\nexport function scaleToAspectRatio(el, ratio) {\n  const width = Math.min(1.0, 1.0 / ratio);\n  const height = Math.min(1.0, ratio);\n  el.object3DMap.mesh.scale.set(width, height, 1);\n  el.object3DMap.mesh.matrixNeedsUpdate = true;\n}\n\nlet errorTexture;\nexport function getErrorTexture() {\n  if (errorTexture) {\n    return errorTexture;\n  }\n  const errorImage = new Image();\n  errorImage.src = errorImageSrc;\n  errorTexture = new THREE.Texture(errorImage);\n  errorImage.onload = () => {\n    errorTexture.needsUpdate = true;\n  };\n  return errorTexture;\n}\n\nexport const mediaImageComponent = AFRAME.registerComponent(\"media-image\", {\n  schema: {\n    src: { type: \"string\" },\n    projection: { type: \"string\", default: \"flat\", oneOf: [\"flat\", \"360-equirectangular\"] },\n    alphaMode: { type: \"string\", default: \"blend\", oneOf: [\"opaque\", \"blend\", \"mask\"] },\n    alphaCutoff: { type: \"number\", default: 0.5 },\n  },\n\n  update(oldData) {\n    const { src, projection } = this.data;\n    if (!src) return;\n\n    // A-Frame loadTexture uses ImageLoader and handles a cache of sources for us to avoid loading the same image twice.\n    let loadTextureFunction = this.el.sceneEl.systems.material.loadTexture.bind(this.el.sceneEl.systems.material);\n    if (src.endsWith(\"ktx2\")) {\n      loadTextureFunction = (src, textureProperties = {}, cb) => {\n        const ktxLoader = this.el.sceneEl.systems[\"gltf-model\"].getKTX2Loader();\n        ktxLoader.load(\n          src,\n          (texture) => {\n            AFRAME.utils.material.setTextureProperties(texture, textureProperties);\n            cb(texture);\n          },\n          undefined,\n          function () {\n            console.error(`Error loading ${src}`);\n            cb(null);\n          }\n        );\n      };\n    }\n\n    // Note that the error texture is 1200x1200 so a ratio 1,\n    // that's why we don't update the scale below in case the image is not found.\n    let ratio = 1;\n    this.el.emit(\"image-loading\");\n\n    if (this.mesh && this.mesh.material.map && src !== oldData.src) {\n      this.mesh.material.map.dispose();\n      this.mesh.material.map = null;\n      this.mesh.material.needsUpdate = true;\n    }\n\n    loadTextureFunction(src, { npot: true }, (texture) => {\n      let imageNotFound = false;\n      // A-Frame doesn't provide an error callback and return a VideoTexture in case the image is not found...\n      if (texture === null || texture.image.tagName === \"VIDEO\") {\n        imageNotFound = true;\n        texture = getErrorTexture();\n      }\n      texture.colorSpace = THREE.SRGBColorSpace;\n      texture.needsUpdate = true;\n\n      const material = new THREE.MeshBasicMaterial();\n      material.toneMapped = false;\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n      } else {\n        geometry = new THREE.PlaneGeometry(1, 1, 1, 1);\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n\n      if (imageNotFound) {\n        this.mesh.material.transparent = true;\n      } else {\n        // if transparency setting isn't explicitly defined, default to on for all gifs, and ktx2 textures with alpha\n        switch (this.data.alphaMode) {\n          case \"opaque\":\n            this.mesh.material.transparent = false;\n            break;\n          case \"mask\":\n            this.mesh.material.transparent = false;\n            this.mesh.material.alphaTest = this.data.alphaCutoff;\n            break;\n          case \"blend\":\n          default:\n            this.mesh.material.transparent = true;\n            this.mesh.material.alphaTest = 0;\n        }\n      }\n\n      this.mesh.material.map = texture;\n      this.mesh.material.needsUpdate = true;\n\n      if (projection === \"flat\" && !imageNotFound) {\n        ratio = texture.image.height / texture.image.width;\n        scaleToAspectRatio(this.el, ratio);\n      }\n\n      this.el.emit(\"image-loaded\", { src: this.data.src, projection: projection });\n    });\n  },\n\n  remove() {\n    if (this.mesh) {\n      this.mesh.material.map.dispose();\n      this.mesh.material.dispose();\n      this.mesh.geometry.dispose();\n      this.el.removeObject3D(\"mesh\");\n      this.mesh.el = null;\n      this.mesh = null;\n    }\n  },\n});\n","// Extracted from Tween.js\n// https://github.com/tweenjs/tween.js/blob/master/src/Tween.js#L473\n// https://github.com/tweenjs/tween.js/blob/master/LICENSE\n// Originally based on Robert Penner's Easing Functions\n// http://robertpenner.com/easing/\n// http://robertpenner.com/easing_terms_of_use.html\nexport function linear(k) {\n    return k;\n}\nexport function quadraticIn(k) {\n    return k * k;\n}\nexport function quadraticOut(k) {\n    return k * (2 - k);\n}\nexport function quadraticInOut(k) {\n    if ((k *= 2) < 1) {\n        return 0.5 * k * k;\n    }\n    return -0.5 * (--k * (k - 2) - 1);\n}\nexport function cubicIn(k) {\n    return k * k * k;\n}\nexport function cubicOut(k) {\n    return --k * k * k + 1;\n}\nexport function cubicInOut(k) {\n    if ((k *= 2) < 1) {\n        return 0.5 * k * k * k;\n    }\n    return 0.5 * ((k -= 2) * k * k + 2);\n}\nexport function quarticIn(k) {\n    return k * k * k * k;\n}\nexport function quarticOut(k) {\n    return 1 - --k * k * k * k;\n}\nexport function quarticInOut(k) {\n    if ((k *= 2) < 1) {\n        return 0.5 * k * k * k * k;\n    }\n    return -0.5 * ((k -= 2) * k * k * k - 2);\n}\nexport function quinticIn(k) {\n    return k * k * k * k * k;\n}\nexport function quinticOut(k) {\n    return --k * k * k * k * k + 1;\n}\nexport function quinticInOut(k) {\n    if ((k *= 2) < 1) {\n        return 0.5 * k * k * k * k * k;\n    }\n    return 0.5 * ((k -= 2) * k * k * k * k + 2);\n}\nexport function sinusoidalIn(k) {\n    return 1 - Math.cos((k * Math.PI) / 2);\n}\nexport function sinusoidalOut(k) {\n    return Math.sin((k * Math.PI) / 2);\n}\nexport function sinusoidalInOut(k) {\n    return 0.5 * (1 - Math.cos(Math.PI * k));\n}\nexport function exponentialIn(k) {\n    return k === 0 ? 0 : Math.pow(1024, k - 1);\n}\nexport function exponentialOut(k) {\n    return k === 1 ? 1 : 1 - Math.pow(2, -10 * k);\n}\nexport function exponentialInOut(k) {\n    if (k === 0) {\n        return 0;\n    }\n    if (k === 1) {\n        return 1;\n    }\n    if ((k *= 2) < 1) {\n        return 0.5 * Math.pow(1024, k - 1);\n    }\n    return 0.5 * (-Math.pow(2, -10 * (k - 1)) + 2);\n}\nexport function circularIn(k) {\n    return 1 - Math.sqrt(1 - k * k);\n}\nexport function circularOut(k) {\n    return Math.sqrt(1 - --k * k);\n}\nexport function circularInOut(k) {\n    if ((k *= 2) < 1) {\n        return -0.5 * (Math.sqrt(1 - k * k) - 1);\n    }\n    return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\n}\nexport function elasticIn(k) {\n    if (k === 0) {\n        return 0;\n    }\n    if (k === 1) {\n        return 1;\n    }\n    return -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\n}\nexport function elasticOut(k) {\n    if (k === 0) {\n        return 0;\n    }\n    if (k === 1) {\n        return 1;\n    }\n    return Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;\n}\nexport function elasticInOut(k) {\n    if (k === 0) {\n        return 0;\n    }\n    if (k === 1) {\n        return 1;\n    }\n    k *= 2;\n    if (k < 1) {\n        return -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\n    }\n    return 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;\n}\nexport function backIn(k) {\n    const s = 1.70158;\n    return k * k * ((s + 1) * k - s);\n}\nexport function backOut(k) {\n    const s = 1.70158;\n    return --k * k * ((s + 1) * k + s) + 1;\n}\nexport function backInOut(k) {\n    const s = 1.70158 * 1.525;\n    if ((k *= 2) < 1) {\n        return 0.5 * (k * k * ((s + 1) * k - s));\n    }\n    return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\n}\nexport function bounceIn(k) {\n    return 1 - bounceOut(1 - k);\n}\nexport function bounceOut(k) {\n    if (k < 1 / 2.75) {\n        return 7.5625 * k * k;\n    }\n    else if (k < 2 / 2.75) {\n        return 7.5625 * (k -= 1.5 / 2.75) * k + 0.75;\n    }\n    else if (k < 2.5 / 2.75) {\n        return 7.5625 * (k -= 2.25 / 2.75) * k + 0.9375;\n    }\n    else {\n        return 7.5625 * (k -= 2.625 / 2.75) * k + 0.984375;\n    }\n}\nexport function bounceInOut(k) {\n    if (k < 0.5) {\n        return bounceIn(k * 2) * 0.5;\n    }\n    return bounceOut(k * 2 - 1) * 0.5 + 0.5;\n}\n","import { Mesh, InstancedBufferGeometry, PlaneGeometry, ShaderMaterial, Vector3, Color, InstancedBufferAttribute, MathUtils, AddEquation, Matrix4, UniformsUtils, UniformsLib, DynamicDrawUsage } from \"three\";\nimport * as EasingFunctions from \"@mozillareality/easing-functions\";\nexport function lerp(start, end, value) {\n    return (end - start) * value + start;\n}\nexport function clamp(min, max, value) {\n    if (value < min) {\n        value = min;\n    }\n    if (value > max) {\n        value = max;\n    }\n    return value;\n}\nfunction flipV(geometry) {\n    // Three.js seems to assume texture flipY is true for all its built in geometry\n    // but we turn this off on our texture loader since createImageBitmap in Firefox\n    // does not support flipping. Then we flip the v of uv for flipY = false texture.\n    // @TODO: There is a similar function in Hubs client core. Should we reuse it?\n    const uv = geometry.getAttribute(\"uv\");\n    for (let i = 0; i < uv.count; i++) {\n        uv.setY(i, 1.0 - uv.getY(i));\n    }\n    return geometry;\n}\nconst vertexShader = `\n  #include <common>\n\n  attribute vec4 particlePosition;\n  attribute vec4 particleColor;\n  attribute float particleAngle;\n\n  varying vec4 vColor;\n  varying vec2 vUV;\n\n  uniform mat4 emitterMatrix;\n\n  #include <fog_pars_vertex>\n\n  void main() {\n    vUV = uv;\n    vColor = particleColor;\n\n    float particleScale = particlePosition.w;\n    vec4 mvPosition = viewMatrix * emitterMatrix * vec4(particlePosition.xyz, 1.0);\n    \n    vec3 rotatedPosition = position;\n    rotatedPosition.x = cos( particleAngle ) * position.x - sin( particleAngle ) * position.y;\n    rotatedPosition.y = sin( particleAngle ) * position.x + cos( particleAngle ) * position.y;\n\n    mvPosition.xyz += rotatedPosition * particleScale;\n\n    gl_Position = projectionMatrix * mvPosition;\n\n    #include <fog_vertex>\n  }\n`;\nconst fragmentShader = `\n  #include <common>\n  #include <fog_pars_fragment>\n\n  uniform sampler2D map;\n\n  varying vec2 vUV;\n  varying vec4 vColor;\n\n  void main() {\n    gl_FragColor = texture2D(map,  vUV) * vColor;\n    #include <fog_fragment>\n  }\n`;\nexport class ParticleEmitter extends Mesh {\n    constructor(texture) {\n        const planeGeometry = new PlaneGeometry(1, 1, 1, 1);\n        if (texture && !texture.flipY) {\n            flipV(planeGeometry);\n        }\n        const geometry = new InstancedBufferGeometry();\n        geometry.index = planeGeometry.index;\n        geometry.attributes = planeGeometry.attributes;\n        const material = new ShaderMaterial({\n            uniforms: UniformsUtils.merge([{\n                    map: { value: texture },\n                    emitterMatrix: { value: new Matrix4() }\n                }, UniformsLib.fog]),\n            vertexShader,\n            fragmentShader,\n            transparent: true,\n            depthWrite: false,\n            // TODO: Resolve the root issue. fog property seems to have\n            // been removed from Three.js ShaderMaterial at some point.\n            // @ts-ignore\n            fog: true,\n            blendEquation: AddEquation\n        });\n        super(geometry, material);\n        this.frustumCulled = false;\n        this.initialPositions = [];\n        this.startSize = 0.25;\n        this.endSize = 0.25;\n        this.sizeRandomness = 0;\n        this.startVelocity = new Vector3(0, 0, 0.5);\n        this.endVelocity = new Vector3(0, 0, 0.5);\n        this.angularVelocity = 0;\n        this.particleCount = 100;\n        this.lifetime = 5;\n        this.lifetimes = [];\n        this.lifetimeRandomness = 5;\n        this.particleSizeRandomness = [];\n        this.ageRandomness = 10;\n        this.initialAges = [];\n        this.ages = [];\n        this.colors = [];\n        this.endColor = new Color();\n        this.middleColor = new Color();\n        this.startColor = new Color();\n        this.startOpacity = 1;\n        this.middleOpacity = 1;\n        this.endOpacity = 1;\n        this.colorCurve = \"linear\";\n        this.velocityCurve = \"linear\";\n        this.sizeCurve = \"linear\";\n        this.worldScale = new Vector3();\n        this.inverseWorldScale = new Vector3();\n        this.updateParticles();\n    }\n    updateParticles() {\n        const texture = this.material.uniforms.map.value;\n        const planeGeometry = new PlaneGeometry(1, 1, 1, 1);\n        if (texture && !texture.flipY) {\n            flipV(planeGeometry);\n        }\n        const tempGeo = new InstancedBufferGeometry();\n        tempGeo.index = planeGeometry.index;\n        tempGeo.attributes = planeGeometry.attributes;\n        const positions = [];\n        const colors = [];\n        const lifetimes = [];\n        const ages = [];\n        const initialAges = [];\n        const initialPositions = [];\n        const particleSizeRandomness = [];\n        const angles = [];\n        this.getWorldScale(this.worldScale);\n        for (let i = 0; i < this.particleCount; i++) {\n            initialAges[i] = Math.random() * this.ageRandomness - this.ageRandomness;\n            lifetimes[i] = this.lifetime + Math.random() * 2 * this.lifetimeRandomness;\n            ages[i] = initialAges[i];\n            initialPositions[i * 3] = Math.random() * 2 - 1; // X\n            initialPositions[i * 3 + 1] = Math.random() * 2 - 1; // Y\n            initialPositions[i * 3 + 2] = 0; // Z\n            particleSizeRandomness[i] = Math.random() * this.sizeRandomness;\n            positions.push(initialPositions[i * 3] * this.worldScale.x);\n            positions.push(initialPositions[i * 3 + 1] * this.worldScale.y);\n            positions.push(initialPositions[i * 3 + 2]);\n            positions.push(this.startSize + particleSizeRandomness[i]);\n            angles.push(0);\n            colors.push(this.startColor.r, this.startColor.g, this.startColor.b, 0);\n        }\n        tempGeo.setAttribute(\"particlePosition\", new InstancedBufferAttribute(new Float32Array(positions), 4).setUsage(DynamicDrawUsage));\n        tempGeo.setAttribute(\"particleColor\", new InstancedBufferAttribute(new Float32Array(colors), 4).setUsage(DynamicDrawUsage));\n        tempGeo.setAttribute(\"particleAngle\", new InstancedBufferAttribute(new Float32Array(angles), 1).setUsage(DynamicDrawUsage));\n        this.geometry = tempGeo;\n        this.initialPositions = initialPositions;\n        this.particleSizeRandomness = particleSizeRandomness;\n        this.ages = ages;\n        this.initialAges = initialAges;\n        this.lifetimes = lifetimes;\n        this.colors = colors;\n    }\n    update(dt) {\n        const geometry = this.geometry;\n        const particlePosition = geometry.attributes.particlePosition.array;\n        const particleColor = geometry.attributes.particleColor.array;\n        const particleAngle = geometry.attributes.particleAngle.array;\n        this.getWorldScale(this.worldScale);\n        this.inverseWorldScale.set(1 / this.worldScale.x, 1 / this.worldScale.y, 1 / this.worldScale.z);\n        const material = this.material;\n        const emitterMatrix = material.uniforms.emitterMatrix.value;\n        emitterMatrix.copy(this.matrixWorld);\n        emitterMatrix.scale(this.inverseWorldScale);\n        for (let i = 0; i < this.particleCount; i++) {\n            const prevAge = this.ages[i];\n            const curAge = (this.ages[i] += dt);\n            // Particle is dead\n            if (curAge < 0) {\n                continue;\n            }\n            // // Particle became alive\n            if (curAge > 0 && prevAge <= 0) {\n                particleColor[i * 4 + 3] = this.startOpacity;\n                particlePosition[i * 4] = this.initialPositions[i * 3] * this.worldScale.x;\n                particlePosition[i * 4 + 1] = this.initialPositions[i * 3 + 1] * this.worldScale.y;\n                particlePosition[i * 4 + 2] = 0;\n                particlePosition[i * 4 + 3] = this.startSize + this.particleSizeRandomness[i];\n                particleColor[i * 4] = this.startColor.r;\n                particleColor[i * 4 + 1] = this.startColor.g;\n                particleColor[i * 4 + 2] = this.startColor.b;\n                continue;\n            }\n            // Particle died\n            if (curAge > this.lifetimes[i]) {\n                this.ages[i] = this.initialAges[i];\n                particleColor[i * 4 + 3] = 0; // Set opacity to zero\n                continue;\n            }\n            const normalizedAge = clamp(0, 1, this.ages[i] / this.lifetimes[i]);\n            const _EasingFunctions = EasingFunctions;\n            if (!_EasingFunctions[this.velocityCurve]) {\n                console.warn(`Unknown velocity curve type ${this.velocityCurve} in particle emitter. Falling back to linear.`);\n                this.velocityCurve = \"linear\";\n            }\n            if (!_EasingFunctions[this.sizeCurve]) {\n                console.warn(`Unknown size curve type ${this.sizeCurve} in particle emitter. Falling back to linear.`);\n                this.sizeCurve = \"linear\";\n            }\n            if (!_EasingFunctions[this.colorCurve]) {\n                console.warn(`Unknown color curve type ${this.colorCurve} in particle emitter. Falling back to linear.`);\n                this.colorCurve = \"linear\";\n            }\n            const velFactor = _EasingFunctions[this.velocityCurve](normalizedAge);\n            const sizeFactor = _EasingFunctions[this.sizeCurve](normalizedAge);\n            const colorFactor = _EasingFunctions[this.colorCurve](normalizedAge);\n            particlePosition[i * 4] += lerp(this.startVelocity.x, this.endVelocity.x, velFactor) * dt;\n            particlePosition[i * 4 + 1] += lerp(this.startVelocity.y, this.endVelocity.y, velFactor) * dt;\n            particlePosition[i * 4 + 2] += lerp(this.startVelocity.z, this.endVelocity.z, velFactor) * dt;\n            particlePosition[i * 4 + 3] = lerp(this.startSize + this.particleSizeRandomness[i], this.endSize + this.particleSizeRandomness[i], sizeFactor);\n            particleAngle[i] += this.angularVelocity * MathUtils.DEG2RAD * dt;\n            if (colorFactor <= 0.5) {\n                const colorFactor1 = colorFactor / 0.5;\n                particleColor[i * 4] = lerp(this.startColor.r, this.middleColor.r, colorFactor1);\n                particleColor[i * 4 + 1] = lerp(this.startColor.g, this.middleColor.g, colorFactor1);\n                particleColor[i * 4 + 2] = lerp(this.startColor.b, this.middleColor.b, colorFactor1);\n                particleColor[i * 4 + 3] = lerp(this.startOpacity, this.middleOpacity, colorFactor1);\n            }\n            else if (colorFactor > 0.5) {\n                const colorFactor2 = (colorFactor - 0.5) / 0.5;\n                particleColor[i * 4] = lerp(this.middleColor.r, this.endColor.r, colorFactor2);\n                particleColor[i * 4 + 1] = lerp(this.middleColor.g, this.endColor.g, colorFactor2);\n                particleColor[i * 4 + 2] = lerp(this.middleColor.b, this.endColor.b, colorFactor2);\n                particleColor[i * 4 + 3] = lerp(this.middleOpacity, this.endOpacity, colorFactor2);\n            }\n        }\n        geometry.attributes.particlePosition.needsUpdate = true;\n        geometry.attributes.particleColor.needsUpdate = true;\n        geometry.attributes.particleAngle.needsUpdate = true;\n    }\n    copy(source, recursive = true) {\n        super.copy(source, recursive);\n        const material = this.material;\n        const sourceMaterial = source.material;\n        material.uniforms.map.value = sourceMaterial.uniforms.map.value;\n        this.startColor.copy(source.startColor);\n        this.middleColor.copy(source.middleColor);\n        this.endColor.copy(source.endColor);\n        this.startOpacity = source.startOpacity;\n        this.middleOpacity = source.middleOpacity;\n        this.endOpacity = source.endOpacity;\n        this.colorCurve = source.colorCurve;\n        this.sizeCurve = source.sizeCurve;\n        this.startSize = source.startSize;\n        this.endSize = source.endSize;\n        this.sizeRandomness = source.sizeRandomness;\n        this.ageRandomness = source.ageRandomness;\n        this.lifetime = source.lifetime;\n        this.lifetimeRandomness = source.lifetimeRandomness;\n        this.particleCount = source.particleCount;\n        this.startVelocity.copy(source.startVelocity);\n        this.endVelocity.copy(source.endVelocity);\n        this.velocityCurve = source.velocityCurve;\n        this.angularVelocity = source.angularVelocity;\n        return this;\n    }\n}\n","import { getErrorTexture, scaleToAspectRatio } from \"./media-image\";\n\n/* global AFRAME, THREE */\nexport const mediaImageComponent = AFRAME.registerComponent(\"media-video\", {\n  schema: {\n    src: { type: \"string\" },\n    projection: { type: \"string\", default: \"flat\", oneOf: [\"flat\", \"360-equirectangular\"] },\n    autoPlay: { type: \"boolean\", default: true },\n    controls: { type: \"boolean\", default: false },\n    loop: { type: \"boolean\", default: true },\n  },\n\n  events: {\n    click() {\n      const videoEl = this.mesh.material.map.source.data;\n      if (videoEl.paused) {\n        videoEl.play();\n      } else {\n        videoEl.pause();\n      }\n    },\n  },\n\n  update(oldData) {\n    if (this.data.controls) {\n      this.el.classList.add(\"clickable\");\n    } else {\n      this.el.classList.remove(\"clickable\");\n    }\n    const { src, projection } = this.data;\n    if (!src) return;\n\n    // Note that the error texture is 1200x1200 so a ratio 1,\n    // that's why we don't update the scale below in case the image is not found.\n    let ratio = 1;\n    this.el.emit(\"video-loading\");\n\n    if (this.mesh && this.mesh.material.map && src !== oldData.src) {\n      this.mesh.material.map.dispose();\n      this.mesh.material.map = null;\n      this.mesh.material.needsUpdate = true;\n    }\n\n    this.el.sceneEl.systems.material.loadTexture(src, { npot: true }, (texture) => {\n      const videoEl = texture.source.data;\n      videoEl.autoplay = this.data.autoPlay;\n      videoEl.loop = this.data.loop;\n      videoEl.muted = this.data.autoPlay;\n      let playPromise;\n      if (this.data.autoPlay) {\n        playPromise = videoEl.play();\n      }\n      let videoNotFound = false;\n      // A-Frame doesn't provide an error callback in case the video is not found, currently this check does nothing\n      if (texture === null) {\n        videoNotFound = true;\n        texture = getErrorTexture();\n      }\n\n      texture.colorSpace = THREE.SRGBColorSpace;\n      texture.needsUpdate = true;\n\n      const material = new THREE.MeshBasicMaterial();\n      material.toneMapped = false;\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n      } else {\n        geometry = new THREE.PlaneGeometry(1, 1, 1, 1);\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n\n      if (videoNotFound) {\n        this.mesh.material.transparent = true;\n      }\n\n      this.mesh.material.map = texture;\n      this.mesh.material.needsUpdate = true;\n\n      if (projection === \"flat\" && !videoNotFound) {\n        const loadedmetadataListener = () => {\n          ratio = videoEl.videoHeight / videoEl.videoWidth;\n          scaleToAspectRatio(this.el, ratio);\n        };\n        videoEl.addEventListener(\"loadedmetadata\", loadedmetadataListener);\n        texture.addEventListener(\n          \"dispose\",\n          () => {\n            videoEl.removeEventListener(\"loadedmetadata\", loadedmetadataListener);\n          },\n          { once: true }\n        );\n        if (playPromise !== undefined) {\n          playPromise\n            .then(() => {})\n            .catch(() => {\n              // Auto-play was prevented, it shouldn't happen with muted true, probably the video was not found\n              texture = getErrorTexture();\n              texture.colorSpace = THREE.SRGBColorSpace;\n              texture.needsUpdate = true;\n              this.mesh.material.transparent = true;\n              this.mesh.material.map = texture;\n              this.mesh.material.needsUpdate = true;\n            });\n        }\n      }\n\n      this.el.emit(\"video-loaded\", { src: this.data.src, projection: projection });\n    });\n  },\n\n  remove() {\n    if (this.mesh) {\n      this.mesh.material.map.dispose();\n      this.mesh.material.dispose();\n      this.mesh.geometry.dispose();\n      this.el.removeObject3D(\"mesh\");\n      this.mesh.el = null;\n      this.mesh = null;\n    }\n  },\n});\n","/* global AFRAME */\nimport { ParticleEmitter } from \"lib-hubs/packages/three-particle-emitter/lib/esm/index\";\nimport { TextureLoader } from \"three\";\nimport { disposeNode } from \"../components/gltf-model-plus\";\n\nAFRAME.registerComponent(\"particle-emitter\", {\n  schema: {\n    src: { type: \"string\", default: \"\" },\n    startColor: { type: \"color\", default: \"#ffffff\" },\n    middleColor: { type: \"color\", default: \"#ffffff\" },\n    endColor: { type: \"color\", default: \"#ffffff\" },\n    startOpacity: { type: \"number\", default: 1 },\n    middleOpacity: { type: \"number\", default: 1 },\n    endOpacity: { type: \"number\", default: 1 },\n    colorCurve: { type: \"string\", default: \"linear\" },\n    sizeCurve: { type: \"string\", default: \"linear\" },\n    startSize: { type: \"number\", default: 0.25 },\n    endSize: { type: \"number\", default: 0.25 },\n    sizeRandomness: { type: \"number\", default: 0 },\n    ageRandomness: { type: \"number\", default: 10 },\n    lifetime: { type: \"number\", default: 5 },\n    lifetimeRandomness: { type: \"number\", default: 10 },\n    particleCount: { type: \"number\", default: 100 },\n    startVelocity: { type: \"vec3\", default: { x: 0, y: 0, z: 0.5 } },\n    endVelocity: { type: \"vec3\", default: { x: 0, y: 0, z: 0.5 } },\n    velocityCurve: { type: \"string\", default: \"linear\" },\n    angularVelocity: { type: \"number\", default: 0 },\n  },\n\n  init() {\n    this.particleEmitter = new ParticleEmitter(null);\n    this.particleEmitter.visible = false;\n    this.el.setObject3D(\"particle-emitter\", this.particleEmitter);\n    this.updateParticles = false;\n  },\n\n  remove() {\n    disposeNode(this.particleEmitter);\n  },\n\n  async setTexture(src) {\n    const textureLoader = new TextureLoader().setCrossOrigin(\"anonymous\");\n    const texture = await textureLoader.loadAsync(src);\n\n    // Guard against src changing while request was in flight\n    if (this.data.src !== src) {\n      return;\n    }\n\n    this.particleEmitter.material.uniforms.map.value = texture;\n    this.particleEmitter.visible = true;\n    this.updateParticles = true;\n  },\n\n  update(prevData) {\n    const data = this.data;\n    const particleEmitter = this.particleEmitter;\n\n    if (prevData.src !== data.src) {\n      this.setTexture(data.src).catch(console.error);\n    }\n\n    if (\n      prevData.startColor !== data.startColor ||\n      prevData.startSize !== data.startSize ||\n      prevData.sizeRandomness !== data.sizeRandomness ||\n      prevData.ageRandomness !== data.ageRandomness ||\n      prevData.lifetime !== data.lifetime ||\n      prevData.lifetimeRandomness !== data.lifetimeRandomness ||\n      prevData.particleCount !== data.particleCount\n    ) {\n      this.updateParticles = true;\n    }\n\n    particleEmitter.startColor.set(data.startColor);\n    particleEmitter.middleColor.set(data.middleColor);\n    particleEmitter.endColor.set(data.endColor);\n    particleEmitter.startOpacity = data.startOpacity;\n    particleEmitter.middleOpacity = data.middleOpacity;\n    particleEmitter.endOpacity = data.endOpacity;\n    particleEmitter.colorCurve = data.colorCurve;\n    particleEmitter.sizeCurve = data.sizeCurve;\n    particleEmitter.startSize = data.startSize;\n    particleEmitter.endSize = data.endSize;\n    particleEmitter.sizeRandomness = data.sizeRandomness;\n    particleEmitter.ageRandomness = data.ageRandomness;\n    particleEmitter.lifetime = data.lifetime;\n    particleEmitter.lifetimeRandomness = data.lifetimeRandomness;\n    particleEmitter.particleCount = data.particleCount;\n    particleEmitter.startVelocity.copy(data.startVelocity);\n    particleEmitter.endVelocity.copy(data.endVelocity);\n    particleEmitter.velocityCurve = data.velocityCurve;\n    particleEmitter.angularVelocity = data.angularVelocity;\n  },\n\n  tick(time, dt) {\n    if (this.updateParticles) {\n      this.particleEmitter.updateParticles();\n      this.updateParticles = false;\n    }\n\n    if (this.particleEmitter.visible) {\n      this.particleEmitter.update(dt / 1000);\n    }\n  },\n});\n","// Ported from Stefan Gustavson's java implementation\n// http://staffwww.itn.liu.se/~stegu/simplexnoise/simplexnoise.pdf\n// Read Stefan's excellent paper for details on how this code works.\n//\n// Sean McCullough banksean@gmail.com\n//\n// Added 4D noise\n\n/**\n * You can pass in a random number generator object if you like.\n * It is assumed to have a random() method.\n */\nclass SimplexNoise {\n\n\tconstructor( r = Math ) {\n\n\t\tthis.grad3 = [[ 1, 1, 0 ], [ - 1, 1, 0 ], [ 1, - 1, 0 ], [ - 1, - 1, 0 ],\n\t\t\t[ 1, 0, 1 ], [ - 1, 0, 1 ], [ 1, 0, - 1 ], [ - 1, 0, - 1 ],\n\t\t\t[ 0, 1, 1 ], [ 0, - 1, 1 ], [ 0, 1, - 1 ], [ 0, - 1, - 1 ]];\n\n\t\tthis.grad4 = [[ 0, 1, 1, 1 ], [ 0, 1, 1, - 1 ], [ 0, 1, - 1, 1 ], [ 0, 1, - 1, - 1 ],\n\t\t\t[ 0, - 1, 1, 1 ], [ 0, - 1, 1, - 1 ], [ 0, - 1, - 1, 1 ], [ 0, - 1, - 1, - 1 ],\n\t\t\t[ 1, 0, 1, 1 ], [ 1, 0, 1, - 1 ], [ 1, 0, - 1, 1 ], [ 1, 0, - 1, - 1 ],\n\t\t\t[ - 1, 0, 1, 1 ], [ - 1, 0, 1, - 1 ], [ - 1, 0, - 1, 1 ], [ - 1, 0, - 1, - 1 ],\n\t\t\t[ 1, 1, 0, 1 ], [ 1, 1, 0, - 1 ], [ 1, - 1, 0, 1 ], [ 1, - 1, 0, - 1 ],\n\t\t\t[ - 1, 1, 0, 1 ], [ - 1, 1, 0, - 1 ], [ - 1, - 1, 0, 1 ], [ - 1, - 1, 0, - 1 ],\n\t\t\t[ 1, 1, 1, 0 ], [ 1, 1, - 1, 0 ], [ 1, - 1, 1, 0 ], [ 1, - 1, - 1, 0 ],\n\t\t\t[ - 1, 1, 1, 0 ], [ - 1, 1, - 1, 0 ], [ - 1, - 1, 1, 0 ], [ - 1, - 1, - 1, 0 ]];\n\n\t\tthis.p = [];\n\n\t\tfor ( let i = 0; i < 256; i ++ ) {\n\n\t\t\tthis.p[ i ] = Math.floor( r.random() * 256 );\n\n\t\t}\n\n\t\t// To remove the need for index wrapping, double the permutation table length\n\t\tthis.perm = [];\n\n\t\tfor ( let i = 0; i < 512; i ++ ) {\n\n\t\t\tthis.perm[ i ] = this.p[ i & 255 ];\n\n\t\t}\n\n\t\t// A lookup table to traverse the simplex around a given point in 4D.\n\t\t// Details can be found where this table is used, in the 4D noise method.\n\t\tthis.simplex = [\n\t\t\t[ 0, 1, 2, 3 ], [ 0, 1, 3, 2 ], [ 0, 0, 0, 0 ], [ 0, 2, 3, 1 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 1, 2, 3, 0 ],\n\t\t\t[ 0, 2, 1, 3 ], [ 0, 0, 0, 0 ], [ 0, 3, 1, 2 ], [ 0, 3, 2, 1 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 1, 3, 2, 0 ],\n\t\t\t[ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ],\n\t\t\t[ 1, 2, 0, 3 ], [ 0, 0, 0, 0 ], [ 1, 3, 0, 2 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 2, 3, 0, 1 ], [ 2, 3, 1, 0 ],\n\t\t\t[ 1, 0, 2, 3 ], [ 1, 0, 3, 2 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 2, 0, 3, 1 ], [ 0, 0, 0, 0 ], [ 2, 1, 3, 0 ],\n\t\t\t[ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ],\n\t\t\t[ 2, 0, 1, 3 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 3, 0, 1, 2 ], [ 3, 0, 2, 1 ], [ 0, 0, 0, 0 ], [ 3, 1, 2, 0 ],\n\t\t\t[ 2, 1, 0, 3 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 3, 1, 0, 2 ], [ 0, 0, 0, 0 ], [ 3, 2, 0, 1 ], [ 3, 2, 1, 0 ]];\n\n\t}\n\n\tdot( g, x, y ) {\n\n\t\treturn g[ 0 ] * x + g[ 1 ] * y;\n\n\t}\n\n\tdot3( g, x, y, z ) {\n\n\t\treturn g[ 0 ] * x + g[ 1 ] * y + g[ 2 ] * z;\n\n\t}\n\n\tdot4( g, x, y, z, w ) {\n\n\t\treturn g[ 0 ] * x + g[ 1 ] * y + g[ 2 ] * z + g[ 3 ] * w;\n\n\t}\n\n\tnoise( xin, yin ) {\n\n\t\tlet n0; // Noise contributions from the three corners\n\t\tlet n1;\n\t\tlet n2;\n\t\t// Skew the input space to determine which simplex cell we're in\n\t\tconst F2 = 0.5 * ( Math.sqrt( 3.0 ) - 1.0 );\n\t\tconst s = ( xin + yin ) * F2; // Hairy factor for 2D\n\t\tconst i = Math.floor( xin + s );\n\t\tconst j = Math.floor( yin + s );\n\t\tconst G2 = ( 3.0 - Math.sqrt( 3.0 ) ) / 6.0;\n\t\tconst t = ( i + j ) * G2;\n\t\tconst X0 = i - t; // Unskew the cell origin back to (x,y) space\n\t\tconst Y0 = j - t;\n\t\tconst x0 = xin - X0; // The x,y distances from the cell origin\n\t\tconst y0 = yin - Y0;\n\n\t\t// For the 2D case, the simplex shape is an equilateral triangle.\n\t\t// Determine which simplex we are in.\n\t\tlet i1; // Offsets for second (middle) corner of simplex in (i,j) coords\n\n\t\tlet j1;\n\t\tif ( x0 > y0 ) {\n\n\t\t\ti1 = 1; j1 = 0;\n\n\t\t\t// lower triangle, XY order: (0,0)->(1,0)->(1,1)\n\n\t\t}\telse {\n\n\t\t\ti1 = 0; j1 = 1;\n\n\t\t} // upper triangle, YX order: (0,0)->(0,1)->(1,1)\n\n\t\t// A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\n\t\t// a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\n\t\t// c = (3-sqrt(3))/6\n\t\tconst x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\n\t\tconst y1 = y0 - j1 + G2;\n\t\tconst x2 = x0 - 1.0 + 2.0 * G2; // Offsets for last corner in (x,y) unskewed coords\n\t\tconst y2 = y0 - 1.0 + 2.0 * G2;\n\t\t// Work out the hashed gradient indices of the three simplex corners\n\t\tconst ii = i & 255;\n\t\tconst jj = j & 255;\n\t\tconst gi0 = this.perm[ ii + this.perm[ jj ] ] % 12;\n\t\tconst gi1 = this.perm[ ii + i1 + this.perm[ jj + j1 ] ] % 12;\n\t\tconst gi2 = this.perm[ ii + 1 + this.perm[ jj + 1 ] ] % 12;\n\t\t// Calculate the contribution from the three corners\n\t\tlet t0 = 0.5 - x0 * x0 - y0 * y0;\n\t\tif ( t0 < 0 ) n0 = 0.0;\n\t\telse {\n\n\t\t\tt0 *= t0;\n\t\t\tn0 = t0 * t0 * this.dot( this.grad3[ gi0 ], x0, y0 ); // (x,y) of grad3 used for 2D gradient\n\n\t\t}\n\n\t\tlet t1 = 0.5 - x1 * x1 - y1 * y1;\n\t\tif ( t1 < 0 ) n1 = 0.0;\n\t\telse {\n\n\t\t\tt1 *= t1;\n\t\t\tn1 = t1 * t1 * this.dot( this.grad3[ gi1 ], x1, y1 );\n\n\t\t}\n\n\t\tlet t2 = 0.5 - x2 * x2 - y2 * y2;\n\t\tif ( t2 < 0 ) n2 = 0.0;\n\t\telse {\n\n\t\t\tt2 *= t2;\n\t\t\tn2 = t2 * t2 * this.dot( this.grad3[ gi2 ], x2, y2 );\n\n\t\t}\n\n\t\t// Add contributions from each corner to get the final noise value.\n\t\t// The result is scaled to return values in the interval [-1,1].\n\t\treturn 70.0 * ( n0 + n1 + n2 );\n\n\t}\n\n\t// 3D simplex noise\n\tnoise3d( xin, yin, zin ) {\n\n\t\tlet n0; // Noise contributions from the four corners\n\t\tlet n1;\n\t\tlet n2;\n\t\tlet n3;\n\t\t// Skew the input space to determine which simplex cell we're in\n\t\tconst F3 = 1.0 / 3.0;\n\t\tconst s = ( xin + yin + zin ) * F3; // Very nice and simple skew factor for 3D\n\t\tconst i = Math.floor( xin + s );\n\t\tconst j = Math.floor( yin + s );\n\t\tconst k = Math.floor( zin + s );\n\t\tconst G3 = 1.0 / 6.0; // Very nice and simple unskew factor, too\n\t\tconst t = ( i + j + k ) * G3;\n\t\tconst X0 = i - t; // Unskew the cell origin back to (x,y,z) space\n\t\tconst Y0 = j - t;\n\t\tconst Z0 = k - t;\n\t\tconst x0 = xin - X0; // The x,y,z distances from the cell origin\n\t\tconst y0 = yin - Y0;\n\t\tconst z0 = zin - Z0;\n\n\t\t// For the 3D case, the simplex shape is a slightly irregular tetrahedron.\n\t\t// Determine which simplex we are in.\n\t\tlet i1; // Offsets for second corner of simplex in (i,j,k) coords\n\n\t\tlet j1;\n\t\tlet k1;\n\t\tlet i2; // Offsets for third corner of simplex in (i,j,k) coords\n\t\tlet j2;\n\t\tlet k2;\n\t\tif ( x0 >= y0 ) {\n\n\t\t\tif ( y0 >= z0 ) {\n\n\t\t\t\ti1 = 1; j1 = 0; k1 = 0; i2 = 1; j2 = 1; k2 = 0;\n\n\t\t\t\t// X Y Z order\n\n\t\t\t} else if ( x0 >= z0 ) {\n\n\t\t\t\ti1 = 1; j1 = 0; k1 = 0; i2 = 1; j2 = 0; k2 = 1;\n\n\t\t\t\t// X Z Y order\n\n\t\t\t} else {\n\n\t\t\t\ti1 = 0; j1 = 0; k1 = 1; i2 = 1; j2 = 0; k2 = 1;\n\n\t\t\t} // Z X Y order\n\n\t\t} else { // x0<y0\n\n\t\t\tif ( y0 < z0 ) {\n\n\t\t\t\ti1 = 0; j1 = 0; k1 = 1; i2 = 0; j2 = 1; k2 = 1;\n\n\t\t\t\t// Z Y X order\n\n\t\t\t} else if ( x0 < z0 ) {\n\n\t\t\t\ti1 = 0; j1 = 1; k1 = 0; i2 = 0; j2 = 1; k2 = 1;\n\n\t\t\t\t// Y Z X order\n\n\t\t\t} else {\n\n\t\t\t\ti1 = 0; j1 = 1; k1 = 0; i2 = 1; j2 = 1; k2 = 0;\n\n\t\t\t} // Y X Z order\n\n\t\t}\n\n\t\t// A step of (1,0,0) in (i,j,k) means a step of (1-c,-c,-c) in (x,y,z),\n\t\t// a step of (0,1,0) in (i,j,k) means a step of (-c,1-c,-c) in (x,y,z), and\n\t\t// a step of (0,0,1) in (i,j,k) means a step of (-c,-c,1-c) in (x,y,z), where\n\t\t// c = 1/6.\n\t\tconst x1 = x0 - i1 + G3; // Offsets for second corner in (x,y,z) coords\n\t\tconst y1 = y0 - j1 + G3;\n\t\tconst z1 = z0 - k1 + G3;\n\t\tconst x2 = x0 - i2 + 2.0 * G3; // Offsets for third corner in (x,y,z) coords\n\t\tconst y2 = y0 - j2 + 2.0 * G3;\n\t\tconst z2 = z0 - k2 + 2.0 * G3;\n\t\tconst x3 = x0 - 1.0 + 3.0 * G3; // Offsets for last corner in (x,y,z) coords\n\t\tconst y3 = y0 - 1.0 + 3.0 * G3;\n\t\tconst z3 = z0 - 1.0 + 3.0 * G3;\n\t\t// Work out the hashed gradient indices of the four simplex corners\n\t\tconst ii = i & 255;\n\t\tconst jj = j & 255;\n\t\tconst kk = k & 255;\n\t\tconst gi0 = this.perm[ ii + this.perm[ jj + this.perm[ kk ] ] ] % 12;\n\t\tconst gi1 = this.perm[ ii + i1 + this.perm[ jj + j1 + this.perm[ kk + k1 ] ] ] % 12;\n\t\tconst gi2 = this.perm[ ii + i2 + this.perm[ jj + j2 + this.perm[ kk + k2 ] ] ] % 12;\n\t\tconst gi3 = this.perm[ ii + 1 + this.perm[ jj + 1 + this.perm[ kk + 1 ] ] ] % 12;\n\t\t// Calculate the contribution from the four corners\n\t\tlet t0 = 0.6 - x0 * x0 - y0 * y0 - z0 * z0;\n\t\tif ( t0 < 0 ) n0 = 0.0;\n\t\telse {\n\n\t\t\tt0 *= t0;\n\t\t\tn0 = t0 * t0 * this.dot3( this.grad3[ gi0 ], x0, y0, z0 );\n\n\t\t}\n\n\t\tlet t1 = 0.6 - x1 * x1 - y1 * y1 - z1 * z1;\n\t\tif ( t1 < 0 ) n1 = 0.0;\n\t\telse {\n\n\t\t\tt1 *= t1;\n\t\t\tn1 = t1 * t1 * this.dot3( this.grad3[ gi1 ], x1, y1, z1 );\n\n\t\t}\n\n\t\tlet t2 = 0.6 - x2 * x2 - y2 * y2 - z2 * z2;\n\t\tif ( t2 < 0 ) n2 = 0.0;\n\t\telse {\n\n\t\t\tt2 *= t2;\n\t\t\tn2 = t2 * t2 * this.dot3( this.grad3[ gi2 ], x2, y2, z2 );\n\n\t\t}\n\n\t\tlet t3 = 0.6 - x3 * x3 - y3 * y3 - z3 * z3;\n\t\tif ( t3 < 0 ) n3 = 0.0;\n\t\telse {\n\n\t\t\tt3 *= t3;\n\t\t\tn3 = t3 * t3 * this.dot3( this.grad3[ gi3 ], x3, y3, z3 );\n\n\t\t}\n\n\t\t// Add contributions from each corner to get the final noise value.\n\t\t// The result is scaled to stay just inside [-1,1]\n\t\treturn 32.0 * ( n0 + n1 + n2 + n3 );\n\n\t}\n\n\t// 4D simplex noise\n\tnoise4d( x, y, z, w ) {\n\n\t\t// For faster and easier lookups\n\t\tconst grad4 = this.grad4;\n\t\tconst simplex = this.simplex;\n\t\tconst perm = this.perm;\n\n\t\t// The skewing and unskewing factors are hairy again for the 4D case\n\t\tconst F4 = ( Math.sqrt( 5.0 ) - 1.0 ) / 4.0;\n\t\tconst G4 = ( 5.0 - Math.sqrt( 5.0 ) ) / 20.0;\n\t\tlet n0; // Noise contributions from the five corners\n\t\tlet n1;\n\t\tlet n2;\n\t\tlet n3;\n\t\tlet n4;\n\t\t// Skew the (x,y,z,w) space to determine which cell of 24 simplices we're in\n\t\tconst s = ( x + y + z + w ) * F4; // Factor for 4D skewing\n\t\tconst i = Math.floor( x + s );\n\t\tconst j = Math.floor( y + s );\n\t\tconst k = Math.floor( z + s );\n\t\tconst l = Math.floor( w + s );\n\t\tconst t = ( i + j + k + l ) * G4; // Factor for 4D unskewing\n\t\tconst X0 = i - t; // Unskew the cell origin back to (x,y,z,w) space\n\t\tconst Y0 = j - t;\n\t\tconst Z0 = k - t;\n\t\tconst W0 = l - t;\n\t\tconst x0 = x - X0; // The x,y,z,w distances from the cell origin\n\t\tconst y0 = y - Y0;\n\t\tconst z0 = z - Z0;\n\t\tconst w0 = w - W0;\n\n\t\t// For the 4D case, the simplex is a 4D shape I won't even try to describe.\n\t\t// To find out which of the 24 possible simplices we're in, we need to\n\t\t// determine the magnitude ordering of x0, y0, z0 and w0.\n\t\t// The method below is a good way of finding the ordering of x,y,z,w and\n\t\t// then find the correct traversal order for the simplex were in.\n\t\t// First, six pair-wise comparisons are performed between each possible pair\n\t\t// of the four coordinates, and the results are used to add up binary bits\n\t\t// for an integer index.\n\t\tconst c1 = ( x0 > y0 ) ? 32 : 0;\n\t\tconst c2 = ( x0 > z0 ) ? 16 : 0;\n\t\tconst c3 = ( y0 > z0 ) ? 8 : 0;\n\t\tconst c4 = ( x0 > w0 ) ? 4 : 0;\n\t\tconst c5 = ( y0 > w0 ) ? 2 : 0;\n\t\tconst c6 = ( z0 > w0 ) ? 1 : 0;\n\t\tconst c = c1 + c2 + c3 + c4 + c5 + c6;\n\n\t\t// simplex[c] is a 4-vector with the numbers 0, 1, 2 and 3 in some order.\n\t\t// Many values of c will never occur, since e.g. x>y>z>w makes x<z, y<w and x<w\n\t\t// impossible. Only the 24 indices which have non-zero entries make any sense.\n\t\t// We use a thresholding to set the coordinates in turn from the largest magnitude.\n\t\t// The number 3 in the \"simplex\" array is at the position of the largest coordinate.\n\t\tconst i1 = simplex[ c ][ 0 ] >= 3 ? 1 : 0;\n\t\tconst j1 = simplex[ c ][ 1 ] >= 3 ? 1 : 0;\n\t\tconst k1 = simplex[ c ][ 2 ] >= 3 ? 1 : 0;\n\t\tconst l1 = simplex[ c ][ 3 ] >= 3 ? 1 : 0;\n\t\t// The number 2 in the \"simplex\" array is at the second largest coordinate.\n\t\tconst i2 = simplex[ c ][ 0 ] >= 2 ? 1 : 0;\n\t\tconst j2 = simplex[ c ][ 1 ] >= 2 ? 1 : 0;\n\t\tconst k2 = simplex[ c ][ 2 ] >= 2 ? 1 : 0;\n\t\tconst l2 = simplex[ c ][ 3 ] >= 2 ? 1 : 0;\n\t\t// The number 1 in the \"simplex\" array is at the second smallest coordinate.\n\t\tconst i3 = simplex[ c ][ 0 ] >= 1 ? 1 : 0;\n\t\tconst j3 = simplex[ c ][ 1 ] >= 1 ? 1 : 0;\n\t\tconst k3 = simplex[ c ][ 2 ] >= 1 ? 1 : 0;\n\t\tconst l3 = simplex[ c ][ 3 ] >= 1 ? 1 : 0;\n\t\t// The fifth corner has all coordinate offsets = 1, so no need to look that up.\n\t\tconst x1 = x0 - i1 + G4; // Offsets for second corner in (x,y,z,w) coords\n\t\tconst y1 = y0 - j1 + G4;\n\t\tconst z1 = z0 - k1 + G4;\n\t\tconst w1 = w0 - l1 + G4;\n\t\tconst x2 = x0 - i2 + 2.0 * G4; // Offsets for third corner in (x,y,z,w) coords\n\t\tconst y2 = y0 - j2 + 2.0 * G4;\n\t\tconst z2 = z0 - k2 + 2.0 * G4;\n\t\tconst w2 = w0 - l2 + 2.0 * G4;\n\t\tconst x3 = x0 - i3 + 3.0 * G4; // Offsets for fourth corner in (x,y,z,w) coords\n\t\tconst y3 = y0 - j3 + 3.0 * G4;\n\t\tconst z3 = z0 - k3 + 3.0 * G4;\n\t\tconst w3 = w0 - l3 + 3.0 * G4;\n\t\tconst x4 = x0 - 1.0 + 4.0 * G4; // Offsets for last corner in (x,y,z,w) coords\n\t\tconst y4 = y0 - 1.0 + 4.0 * G4;\n\t\tconst z4 = z0 - 1.0 + 4.0 * G4;\n\t\tconst w4 = w0 - 1.0 + 4.0 * G4;\n\t\t// Work out the hashed gradient indices of the five simplex corners\n\t\tconst ii = i & 255;\n\t\tconst jj = j & 255;\n\t\tconst kk = k & 255;\n\t\tconst ll = l & 255;\n\t\tconst gi0 = perm[ ii + perm[ jj + perm[ kk + perm[ ll ] ] ] ] % 32;\n\t\tconst gi1 = perm[ ii + i1 + perm[ jj + j1 + perm[ kk + k1 + perm[ ll + l1 ] ] ] ] % 32;\n\t\tconst gi2 = perm[ ii + i2 + perm[ jj + j2 + perm[ kk + k2 + perm[ ll + l2 ] ] ] ] % 32;\n\t\tconst gi3 = perm[ ii + i3 + perm[ jj + j3 + perm[ kk + k3 + perm[ ll + l3 ] ] ] ] % 32;\n\t\tconst gi4 = perm[ ii + 1 + perm[ jj + 1 + perm[ kk + 1 + perm[ ll + 1 ] ] ] ] % 32;\n\t\t// Calculate the contribution from the five corners\n\t\tlet t0 = 0.6 - x0 * x0 - y0 * y0 - z0 * z0 - w0 * w0;\n\t\tif ( t0 < 0 ) n0 = 0.0;\n\t\telse {\n\n\t\t\tt0 *= t0;\n\t\t\tn0 = t0 * t0 * this.dot4( grad4[ gi0 ], x0, y0, z0, w0 );\n\n\t\t}\n\n\t\tlet t1 = 0.6 - x1 * x1 - y1 * y1 - z1 * z1 - w1 * w1;\n\t\tif ( t1 < 0 ) n1 = 0.0;\n\t\telse {\n\n\t\t\tt1 *= t1;\n\t\t\tn1 = t1 * t1 * this.dot4( grad4[ gi1 ], x1, y1, z1, w1 );\n\n\t\t}\n\n\t\tlet t2 = 0.6 - x2 * x2 - y2 * y2 - z2 * z2 - w2 * w2;\n\t\tif ( t2 < 0 ) n2 = 0.0;\n\t\telse {\n\n\t\t\tt2 *= t2;\n\t\t\tn2 = t2 * t2 * this.dot4( grad4[ gi2 ], x2, y2, z2, w2 );\n\n\t\t}\n\n\t\tlet t3 = 0.6 - x3 * x3 - y3 * y3 - z3 * z3 - w3 * w3;\n\t\tif ( t3 < 0 ) n3 = 0.0;\n\t\telse {\n\n\t\t\tt3 *= t3;\n\t\t\tn3 = t3 * t3 * this.dot4( grad4[ gi3 ], x3, y3, z3, w3 );\n\n\t\t}\n\n\t\tlet t4 = 0.6 - x4 * x4 - y4 * y4 - z4 * z4 - w4 * w4;\n\t\tif ( t4 < 0 ) n4 = 0.0;\n\t\telse {\n\n\t\t\tt4 *= t4;\n\t\t\tn4 = t4 * t4 * this.dot4( grad4[ gi4 ], x4, y4, z4, w4 );\n\n\t\t}\n\n\t\t// Sum up and scale the result to cover the range [-1,1]\n\t\treturn 27.0 * ( n0 + n1 + n2 + n3 + n4 );\n\n\t}\n\n}\n\nexport { SimplexNoise };\n","/* global AFRAME */\n// This is a modified copy of https://github.com/mozilla/hubs/blob/b466e6901cb2a0310b5219e2dac41731d7fa0916/src/components/simple-water.js\n// and https://github.com/mozilla/hubs/blob/f099ec6cb9a15c8f7554ffdbec592f9abf6c7267/src/objects/SimpleWaterMesh.ts\n// and https://github.com/mozilla/hubs/blob/c734c4d8c09a4969ea7793de9e500f3b39cc9a8e/src/assets/waternormals.jpg\n// Changes required was removing typescript annotations, removing APP.store.state.preferences.materialQualitySetting usage and replacing HubsTextureLoader by TextureLoader.\n// @license MPL 2.0 https://github.com/mozilla/hubs/blob/master/LICENSE\n\nimport {\n  Mesh,\n  PlaneGeometry,\n  MeshStandardMaterial,\n  MeshPhongMaterial,\n  Vector2,\n  RepeatWrapping,\n  TextureLoader,\n} from \"three\";\nimport { SimplexNoise } from \"three/addons/math/SimplexNoise.js\";\nimport waterNormalsUrl from \"../assets/waternormals.jpg\";\n\n/**\n * SimpleWater\n */\n\n/**\n * Adapted dynamic geometry code from: https://github.com/ditzel/UnityOceanWavesAndShip\n */\n\nclass Octave {\n  constructor(speed = new Vector2(1, 1), scale = new Vector2(1, 1), height = 0.0025, alternate = true) {\n    this.speed = speed;\n    this.scale = scale;\n    this.height = height;\n    this.alternate = alternate;\n  }\n}\nexport default class SimpleWater extends Mesh {\n  constructor(normalMap, resolution = 24, lowQuality = false) {\n    const geometry = new PlaneGeometry(10, 10, resolution, resolution);\n    geometry.rotateX(-Math.PI / 2);\n\n    const waterUniforms = {\n      ripplesSpeed: { value: 0.25 },\n      ripplesScale: { value: 1 },\n      time: { value: 0 },\n    };\n\n    const MaterialClass = lowQuality ? MeshPhongMaterial : MeshStandardMaterial;\n\n    normalMap.wrapS = normalMap.wrapT = RepeatWrapping;\n\n    const material = new MaterialClass({\n      color: 0x0054df,\n      normalMap,\n      roughness: 0.5,\n      metalness: 0.5,\n      defines: {\n        USE_UV: \"\", // This will define USE_UV, enabling vUv without needing a texture map\n      },\n    });\n    material.name = \"SimpleWaterMaterial\";\n\n    material.onBeforeCompile = (shader) => {\n      Object.assign(shader.uniforms, waterUniforms);\n\n      shader.vertexShader = shader.vertexShader.replace(\n        \"#include <fog_pars_vertex>\",\n        `\n        #include <fog_pars_vertex>\n        varying vec3 vWPosition;\n      `\n      );\n\n      shader.vertexShader = shader.vertexShader.replace(\n        \"#include <fog_vertex>\",\n        `\n        #include <fog_vertex>\n        vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;\n      `\n      );\n\n      // getNoise function from https://github.com/mrdoob/three.js/blob/dev/examples/jsm/objects/Water.js\n      shader.fragmentShader = shader.fragmentShader.replace(\n        \"#include <normalmap_pars_fragment>\",\n        `\n        #include <normalmap_pars_fragment>\n\n        uniform float time;\n        uniform float ripplesSpeed;\n        uniform float ripplesScale;\n      \n        varying vec3 vWPosition;\n      \n        vec4 getNoise(vec2 uv){\n          float timeOffset = time * ripplesSpeed;\n          uv = (uv - 0.5) * (1.0 / ripplesScale);\n          vec2 uv0 = (uv/103.0)+vec2(timeOffset/17.0, timeOffset/29.0);\n          vec2 uv1 = uv/107.0-vec2(timeOffset/-19.0, timeOffset/31.0);\n          vec2 uv2 = uv/vec2(897.0, 983.0)+vec2(timeOffset/101.0, timeOffset/97.0);\n          vec2 uv3 = uv/vec2(991.0, 877.0)-vec2(timeOffset/109.0, timeOffset/-113.0);\n          vec4 noise = (texture2D(normalMap, uv0)) +\n                       (texture2D(normalMap, uv1)) +\n                       (texture2D(normalMap, uv2)) +\n                       (texture2D(normalMap, uv3));\n          return noise / 4.0;\n        }\n      `\n      );\n\n      // https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl.js#L20\n      shader.fragmentShader = shader.fragmentShader.replace(\n        \"#include <normal_fragment_maps>\",\n        `\n          // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n          vec3 eye_pos = -vViewPosition;\n          vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n          vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n          vec2 st0 = dFdx( vUv.st );\n          vec2 st1 = dFdy( vUv.st );\n\n          float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n          vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n          vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n          vec3 N = normalize( normal );\n          mat3 tsn = mat3( S, T, N );\n\n          vec3 mapN = getNoise(vWPosition.xz).xyz * 2.0 - 1.0;\n\n          mapN.xy *= normalScale;\n          mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n          normal = normalize( tsn * mapN );\n        `\n      );\n    };\n\n    super(geometry, material);\n\n    this.lowQuality = lowQuality;\n    this.waterUniforms = waterUniforms;\n\n    if (lowQuality) {\n      this.material.specular.set(0xffffff);\n    } else {\n      this.receiveShadow = true;\n    }\n\n    this.geometry.attributes.position.dynamic = true;\n\n    this.resolution = resolution;\n    this.octaves = [\n      new Octave(new Vector2(0.5, 0.5), new Vector2(1, 1), 0.01, true),\n      new Octave(new Vector2(0.05, 6), new Vector2(1, 20), 0.1, false),\n    ];\n\n    this.simplex = new SimplexNoise();\n  }\n\n  get opacity() {\n    return this.material.opacity;\n  }\n\n  set opacity(value) {\n    this.material.opacity = value;\n    this.material.transparent = value !== 1;\n  }\n\n  get color() {\n    return this.material.color;\n  }\n\n  get tideHeight() {\n    return this.octaves[0].height;\n  }\n\n  set tideHeight(value) {\n    this.octaves[0].height = value;\n  }\n\n  get tideScale() {\n    return this.octaves[0].scale;\n  }\n\n  get tideSpeed() {\n    return this.octaves[0].speed;\n  }\n\n  get waveHeight() {\n    return this.octaves[1].height;\n  }\n\n  set waveHeight(value) {\n    this.octaves[1].height = value;\n  }\n\n  get waveScale() {\n    return this.octaves[1].scale;\n  }\n\n  get waveSpeed() {\n    return this.octaves[1].speed;\n  }\n\n  set ripplesSpeed(value) {\n    this.waterUniforms.ripplesSpeed.value = value;\n  }\n\n  get ripplesSpeed() {\n    return this.waterUniforms.ripplesSpeed.value;\n  }\n\n  set ripplesScale(value) {\n    this.waterUniforms.ripplesScale.value = value;\n  }\n\n  get ripplesScale() {\n    return this.waterUniforms.ripplesScale.value;\n  }\n\n  update(time) {\n    const positionAttribute = this.geometry.attributes.position;\n\n    for (let x = 0; x <= this.resolution; x++) {\n      for (let z = 0; z <= this.resolution; z++) {\n        let y = 0;\n\n        for (let o = 0; o < this.octaves.length; o++) {\n          const octave = this.octaves[o];\n\n          if (octave.alternate) {\n            const noise = this.simplex.noise(\n              (x * octave.scale.x) / this.resolution,\n              (z * octave.scale.y) / this.resolution\n            );\n            y += Math.cos(noise + octave.speed.length() * time) * octave.height;\n          } else {\n            const noise =\n              this.simplex.noise(\n                (x * octave.scale.x + time * octave.speed.x) / this.resolution,\n                (z * octave.scale.y + time * octave.speed.y) / this.resolution\n              ) - 0.5;\n            y += noise * octave.height;\n          }\n        }\n\n        positionAttribute.setY(x * (this.resolution + 1) + z, y);\n      }\n    }\n\n    this.geometry.computeVertexNormals();\n    positionAttribute.needsUpdate = true;\n    this.waterUniforms.time.value = time;\n  }\n\n  clone(recursive) {\n    return new SimpleWater(this.material.normalMap, this.resolution, this.lowQuality).copy(this, recursive);\n  }\n\n  copy(source, recursive = true) {\n    super.copy(source, recursive);\n\n    this.opacity = source.opacity;\n    this.color.copy(source.color);\n    this.tideHeight = source.tideHeight;\n    this.tideScale.copy(source.tideScale);\n    this.tideSpeed.copy(source.tideSpeed);\n    this.waveHeight = source.waveHeight;\n    this.waveScale.copy(source.waveScale);\n    this.waveSpeed.copy(source.waveSpeed);\n    this.ripplesSpeed = source.ripplesSpeed;\n    this.ripplesScale = source.ripplesScale;\n\n    return this;\n  }\n}\n\nfunction vec2Equals(a, b) {\n  return a && b && a.x === b.x && a.y === b.y;\n}\n\nlet waterNormalMap = null;\n\nAFRAME.registerComponent(\"simple-water\", {\n  schema: {\n    opacity: { type: \"number\", default: 1 },\n    color: { type: \"color\" },\n    tideHeight: { type: \"number\", default: 0.01 },\n    tideScale: { type: \"vec2\", default: { x: 1, y: 1 } },\n    tideSpeed: { type: \"vec2\", default: { x: 0.5, y: 0.5 } },\n    waveHeight: { type: \"number\", default: 0.1 },\n    waveScale: { type: \"vec2\", default: { x: 1, y: 20 } },\n    waveSpeed: { type: \"vec2\", default: { x: 0.05, y: 6 } },\n    ripplesScale: { type: \"number\", default: 1 },\n    ripplesSpeed: { type: \"number\", default: 0.25 },\n  },\n\n  init() {\n    if (!waterNormalMap) {\n      waterNormalMap = new TextureLoader().load(waterNormalsUrl);\n    }\n\n    const usePhongShader = false; // window.APP.store.state.preferences.materialQualitySetting !== \"high\";\n    this.water = new SimpleWater(waterNormalMap, undefined, usePhongShader);\n    this.el.setObject3D(\"mesh\", this.water);\n  },\n\n  update(oldData) {\n    if (this.data.opacity !== oldData.opacity) {\n      this.water.opacity = this.data.opacity;\n    }\n\n    if (this.data.color !== oldData.color) {\n      this.water.color.set(this.data.color);\n    }\n\n    if (this.data.tideHeight !== oldData.tideHeight) {\n      this.water.tideHeight = this.data.tideHeight;\n    }\n\n    if (!vec2Equals(this.data.tideScale, oldData.tideScale)) {\n      this.water.tideScale.copy(this.data.tideScale);\n    }\n\n    if (!vec2Equals(this.data.tideSpeed, oldData.tideSpeed)) {\n      this.water.tideSpeed.copy(this.data.tideSpeed);\n    }\n\n    if (this.data.waveHeight !== oldData.waveHeight) {\n      this.water.waveHeight = this.data.waveHeight;\n    }\n\n    if (!vec2Equals(this.data.waveScale, oldData.waveScale)) {\n      this.water.waveScale.copy(this.data.waveScale);\n    }\n\n    if (!vec2Equals(this.data.waveSpeed, oldData.waveSpeed)) {\n      this.water.waveSpeed.copy(this.data.waveSpeed);\n    }\n\n    if (this.data.ripplesScale !== oldData.ripplesScale) {\n      this.water.ripplesScale = this.data.ripplesScale;\n    }\n\n    if (this.data.ripplesSpeed !== oldData.ripplesSpeed) {\n      this.water.ripplesSpeed = this.data.ripplesSpeed;\n    }\n  },\n\n  tick(time) {\n    this.water.update(time / 1000);\n  },\n\n  remove() {\n    const mesh = this.el.getObject3D(\"mesh\");\n    mesh.geometry.dispose();\n    // mesh.material.normalMap.dispose(); // the texture may be used by another component\n    mesh.material.dispose();\n    this.el.removeObject3D(\"mesh\");\n  },\n});\n"],"names":["root","factory","exports","module","require","define","amd","a","i","self","__WEBPACK_EXTERNAL_MODULE__612__","AFRAME","registerComponent","schema","onlyY","type","default","init","this","targetPos","THREE","Vector3","worldPos","tick","object3D","el","visible","camera","sceneEl","systems","activeCameraEl","setFromMatrixPosition","matrixWorld","data","getWorldPosition","y","lookAt","textureToData","Map","registeredTextures","registerSystem","t","dt","length","map","offset","instances","get","component","addScaledVector","speed","x","increment","play","mesh","getObject3D","material","instance","emissiveMap","has","set","Vector2","push","console","warn","components","addEventListener","pause","splice","indexOf","delete","WITH_NAF","window","NAF","templateOuter","document","createElement","templateInner","id","appendChild","refTemplateId","schemas","schemaDict","template","property","templateCache","addWaypointTemplate","clientId","String","crypto","getRandomValues","Uint32Array","getClientId","hideWaypointsAfterClick","occupyWaypoint","showClickableWaypoints","registeredWaypoints","glbLoading","pendingEmitWaypointsReady","scheduleEmitWaypointsReady","log","setTimeout","emit","toggleClickableWaypoints","waypoint","waypointComponent","isOccupied","teleportTo","position","rotation","withTransition","quaternion","Quaternion","setFromEuler","Euler","MathUtils","degToRad","cameraRig","querySelector","cursorTeleport","is","navMeshConstraint","setAttribute","enabled","camForRotation","destQuaternion","invert","multiply","copy","pitchObject","DEG2RAD","unoccupyWaypoint","occupiedBy","networked","connection","adapter","utils","takeOwnership","canBeClicked","canBeOccupied","canBeSpawnPoint","snapToNavMesh","willDisableMotion","willDisableTeleporting","willMaintainInitialOrientation","events","evt","classList","add","rootNode","getObjectByName","children","originalColor","color","clone","system","side","FrontSide","mouseenter","mouseleave","activeDataChannels","isMine","click","spawnPoint","avatarPose","playerInfo","avatarSitOffset","getWorldQuaternion","setFromQuaternion","RAD2DEG","z","seatRotation","registerWaypoint","unregisterWaypoint","idx","URL","href","hasAttribute","removeAttribute","remove","update","oldData","find","move","bind","locationHashChanged","hash","location","removeEventListener","waypointSystem","spawnPoints","filter","firstSpawnPoint","on","delay","filterRegExp","listenerTrigger","listenerWaypointsReady","waypointsReady","triggered","moved","body","RegExp","waypoints","include","match","firstUnoccupiedWaypoint","registerPrimitive","defaultComponents","attachTemplateToLocal","persistent","owner","mappings","startsWith","exitVR","open","size","envMapTexture","updateWorldMatrix","box","Box3","setFromCenterAndSize","setScalar","applyMatrix4","setObject3D","ReflectionProbe","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","g","globalThis","Function","e","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","scriptUrl","importScripts","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","test","Error","replace","p","b","baseURI","RGBELoader","DataTextureLoader","constructor","manager","super","HalfFloatType","parse","buffer","rgbe_error","rgbe_error_code","msg","fgets","lineLimit","consume","pos","len","s","chunk","fromCharCode","apply","Uint16Array","subarray","byteLength","slice","RGBEByteToRGBFloat","sourceArray","sourceOffset","destArray","destOffset","scale","Math","pow","RGBEByteToRGBHalf","DataUtils","toHalfFloat","min","byteArray","Uint8Array","rgbe_header_info","gamma_re","exposure_re","format_re","dimensions_re","header","valid","string","comments","programtype","format","gamma","exposure","width","height","line","charAt","parseFloat","parseInt","RGBE_ReadHeader","w","h","image_rgba_data","scanline_width","data_rgba","ptr_end","rgbeStart","scanline_buffer","num_scanlines","count","ptr","isEncodedRun","byteValue","l","off","RGBE_ReadPixels_RLE","numElements","FloatType","floatArray","Float32Array","j","halfArray","setDataType","load","url","onLoad","onProgress","onError","texture","texData","colorSpace","LinearSRGBColorSpace","minFilter","LinearFilter","magFilter","generateMipmaps","flipY","EventDispatcher","listener","_listeners","listeners","hasEventListener","listenerArray","index","dispatchEvent","event","array","eventData","singlePropUpdate","FAKE_NODE","removeChild","FakeEntity","node","initializingComponents","isEntity","isPlaying","object3DMap","rotationObj","states","parentElement","parentNode","hasLoaded","mixinEls","isFakeEntity","addState","state","removeState","stateIndex","getAttribute","attr","entityEl","radToDeg","getRotation","getDOMAttribute","flushToDOM","componentName","arg1","arg2","newAttrValue","clobber","styleParser","updateComponent","attrValue","removeComponent","updateProperties","initComponent","attrName","isDependency","addComponent","name","destroy","initialized","evtDetail","tryRemoveLater","detail","oldObj","traverse","child","object","removeObject3D","bubbles","extraData","extend","target","CustomEvent","error","fakeEl","Component","createEntityAndReparent","klass","entity","removeFromParent","attach","absoluteURLForAsset","asset","LUTCubeLoader","Loader","UnsignedByteType","setType","loader","FileLoader","setPath","path","setResponseType","text","itemError","input","regExpDataPoints","result","exec","title","Number","domainMin","domainMax","texture3D","Data3DTexture","image","depth","wrapS","ClampToEdgeWrapping","wrapT","wrapR","needsUpdate","defaultEnvironmentSettings","toneMapping","LUTToneMapping","toneMappingExposure","backgroundColor","backgroundTexture","blenderLUTPromise","updateMaterials","scene","inflateMediaImage","componentProps","otherComponents","networkId","inflateMediaVideo","videos","inflateWaypointFromJSON","gltfInflators","hasAudioParams","audioParams","audioProps","autoplay","autoPlay","distanceModel","loop","maxDistance","positional","audioType","refDistance","rolloffFactor","volume","gain","settings","renderer","materialsNeedUpdate","newToneMapping","NoToneMapping","Promise","resolve","reject","then","tonemappingLUT","catch","mapping","EquirectangularReflectionMapping","userData","mimeType","background","Color","environment","parent","isMesh","ext","split","pop","toLowerCase","includes","geometry","dispose","anchorY","textProps","align","textAlign","anchor","anchorX","baseline","opacity","opacityProp","HDR_FILE_RE","oneOf","backgroundTextureUrl","isHDR","TextureLoader","setWithCredentials","NearestMipmapNearestFilter","NearestMipmapLinearFilter","NearestFilter","LinearMipmapNearestFilter","LinearMipmapLinearFilter","SRGBColorSpace","envMapTextureUrl","GLTFMozTextureRGBE","parser","loadTexture","textureIndex","textureDef","json","textures","extensions","source","loadTextureImage","GLTFHubsComponentsExtension","afterRoot","scenes","deps","resolveComponents","gltfRootType","associations","gltfExtensions","assign","MOZ_hubs_components","props","propName","__mhc_link_type","getDependency","loadedDep","MOZ_texture_rgbe","fn","Array","isArray","all","GLTFHubsLightMapExtension","loadMaterial","materialIndex","materialDef","materials","extensionDef","pending","results","lightMap","channel","lightMapIntensity","intensity","isMeshBasicMaterial","PI","disposeTextures","propertyName","Texture","ImageBitmap","close","disposeNode","Mesh","gltfModelPlus","dracoLoader","getDRACOLoader","meshoptDecoder","getMeshoptDecoder","ktxLoader","getKTX2Loader","model","removers","GLTFLoader","mixer","register","setDRACOLoader","ready","setMeshoptDecoder","setKTX2Loader","gltfModel","animations","finalizers","environmentSettings","reflectionProbeMode","hubsComponents","HUBS_components","srcForLogging","entries","forEach","AnimationMixer","isNaN","addBehavior","activeClipIndices","clips","clipName","clip","clipNames","n","action","clipAction","timeScale","startOffset","time","setLoop","LoopRepeat","Infinity","inflator","contains","Cache","clear","shadowMap","originalEvent","message","stopAllAction","removeBehavior","addMediaFrameTemplate","registeredMediaframes","mediaFramesById","getClosestMediaFrame","filterByMediaType","mediaFrames","mediaFrame","mediaType","cameraRigPosition","sort","distanceTo","getElementById","getMediaFrameById","bounds","snapToCenter","scaleToAspectRatio","ratio","matrixNeedsUpdate","errorTexture","getErrorTexture","errorImage","Image","onload","linear","k","quadraticIn","quadraticOut","quadraticInOut","cubicIn","cubicOut","cubicInOut","quarticIn","quarticOut","quarticInOut","quinticIn","quinticOut","quinticInOut","sinusoidalIn","cos","sinusoidalOut","sin","sinusoidalInOut","exponentialIn","exponentialOut","exponentialInOut","circularIn","sqrt","circularOut","circularInOut","elasticIn","elasticOut","elasticInOut","backIn","backOut","backInOut","bounceIn","bounceOut","bounceInOut","lerp","start","end","flipV","uv","setY","getY","projection","alphaMode","alphaCutoff","loadTextureFunction","endsWith","textureProperties","cb","setTextureProperties","npot","imageNotFound","MeshBasicMaterial","toneMapped","SphereGeometry","PlaneGeometry","DoubleSide","transparent","alphaTest","controls","videoEl","paused","playPromise","muted","videoNotFound","loadedmetadataListener","videoHeight","videoWidth","once","ParticleEmitter","planeGeometry","InstancedBufferGeometry","attributes","ShaderMaterial","uniforms","UniformsUtils","merge","emitterMatrix","Matrix4","UniformsLib","fog","vertexShader","fragmentShader","depthWrite","blendEquation","AddEquation","frustumCulled","initialPositions","startSize","endSize","sizeRandomness","startVelocity","endVelocity","angularVelocity","particleCount","lifetime","lifetimes","lifetimeRandomness","particleSizeRandomness","ageRandomness","initialAges","ages","colors","endColor","middleColor","startColor","startOpacity","middleOpacity","endOpacity","colorCurve","velocityCurve","sizeCurve","worldScale","inverseWorldScale","updateParticles","tempGeo","positions","angles","getWorldScale","random","InstancedBufferAttribute","setUsage","DynamicDrawUsage","particlePosition","particleColor","particleAngle","prevAge","curAge","normalizedAge","_EasingFunctions","velFactor","sizeFactor","colorFactor","colorFactor1","colorFactor2","recursive","sourceMaterial","particleEmitter","setTexture","textureLoader","setCrossOrigin","loadAsync","prevData","SimplexNoise","grad3","grad4","floor","perm","simplex","dot","dot3","dot4","noise","xin","yin","n0","n1","n2","G2","x0","y0","i1","j1","x1","y1","x2","y2","ii","jj","gi0","gi1","gi2","t0","t1","t2","noise3d","zin","n3","G3","z0","k1","i2","j2","k2","z1","z2","x3","y3","z3","kk","gi3","t3","noise4d","F4","G4","n4","w0","c","l1","l2","i3","j3","k3","l3","w1","w2","w3","x4","y4","z4","w4","ll","gi4","t4","Octave","alternate","SimpleWater","normalMap","resolution","lowQuality","rotateX","waterUniforms","ripplesSpeed","ripplesScale","MaterialClass","MeshPhongMaterial","MeshStandardMaterial","RepeatWrapping","roughness","metalness","defines","USE_UV","onBeforeCompile","shader","specular","receiveShadow","dynamic","octaves","tideHeight","tideScale","tideSpeed","waveHeight","waveScale","waveSpeed","positionAttribute","octave","computeVertexNormals","vec2Equals","waterNormalMap","water"],"sourceRoot":""}